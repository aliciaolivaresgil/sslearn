<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>sslearn.wrapper API documentation</title>
            <link rel="icon" href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMzEwLjgxMzY5IgogICBoZWlnaHQ9IjE5NC4zNDc0OSIKICAgdmlld0JveD0iMCAwIDgyLjIzNjEyMSA1MS40MjExMDYiCiAgIHZlcnNpb249IjEuMSIKICAgaWQ9InN2ZzEiCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMy4yICgwOTFlMjBlZjBmLCAyMDIzLTExLTI1LCBjdXN0b20pIgogICBzb2RpcG9kaTpkb2NuYW1lPSJzc2xlYXJuX21pbmkuc3ZnIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0ibmFtZWR2aWV3MSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnNob3dwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCIKICAgICBpbmtzY2FwZTpkZXNrY29sb3I9IiNkMWQxZDEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIgogICAgIGlua3NjYXBlOnpvb209IjAuMjA0NDUwNzYiCiAgICAgaW5rc2NhcGU6Y3g9IjcwLjkyMTcyMyIKICAgICBpbmtzY2FwZTpjeT0iNTEzLjU3MTEiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSI5NTAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTE2NiIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iOTY0IgogICAgIGlua3NjYXBlOndpbmRvdy15PSIyOCIKICAgICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMyIgLz4KICA8ZGVmcwogICAgIGlkPSJkZWZzMSIgLz4KICA8ZwogICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiCiAgICAgaWQ9ImxheWVyMyIKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMyIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtOTQuNjk5NDI1LC05Ni4yNDMzNTcpIj4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6NTAuOHB4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICB4PSIxMTYuMTY3MjYiCiAgICAgICB5PSIxMzEuNTY1MjMiCiAgICAgICBpZD0idGV4dDUtOSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjUtNCIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo1MC44cHg7Zm9udC1mYW1pbHk6UDA1MjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidQMDUyIEJvbGQnO2ZpbGw6IzAwN2YwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgICAgeD0iMTE2LjE2NzI2IgogICAgICAgICB5PSIxMzEuNTY1MjMiPio8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6NTAuOHB4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICB4PSIxNDEuNjU4MjkiCiAgICAgICB5PSIxMzEuNTY1MjMiCiAgICAgICBpZD0idGV4dDUtOC0xIj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuNS05LTUiCiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NTAuOHB4O2ZvbnQtZmFtaWx5OlAwNTI7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonUDA1MiBCb2xkJztmaWxsOiMwMDdmMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICAgIHg9IjE0MS42NTgyOSIKICAgICAgICAgeT0iMTMxLjU2NTIzIj4qPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zaXplOjUwLjhweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxLjA4NTA2IgogICAgICAgeD0iOTIuNDY3MDAzIgogICAgICAgeT0iMTMxLjU2NTIzIgogICAgICAgaWQ9InRleHQ1LTgtNy00Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuNS05LTktMSIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo1MC44cHg7Zm9udC1mYW1pbHk6UDA1MjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidQMDUyIEJvbGQnO2ZpbGw6IzAwN2YwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgICAgeD0iOTIuNDY3MDAzIgogICAgICAgICB5PSIxMzEuNTY1MjMiPio8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6NjkuNDQzOXB4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICB4PSI5NC43MDgyNzUiCiAgICAgICB5PSIxNDYuNDc3NjgiCiAgICAgICBpZD0idGV4dDEtNyI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjEtMCIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo2OS40NDM5cHg7Zm9udC1mYW1pbHk6UDA1MjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidQMDUyIEJvbGQnO2ZpbGw6IzAwN2YwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgICAgeD0iOTQuNzA4Mjc1IgogICAgICAgICB5PSIxNDYuNDc3NjgiPjx0c3BhbgogICAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDczYzA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICAgICAgaWQ9InRzcGFuNi02Ij48dHNwYW4KICAgc3R5bGU9ImZpbGw6Izk5MDAwMDtmaWxsLW9wYWNpdHk6MSIKICAgaWQ9InRzcGFuNy0wIj5zczwvdHNwYW4+bDwvdHNwYW4+PC90c3Bhbj48L3RleHQ+CiAgPC9nPgogIDxnCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIyIgogICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAyIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC05NC42OTk0MjUsLTk2LjI0MzM1NykiIC8+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk0LjY5OTQyNSwtOTYuMjQzMzU3KSIgLz4KPC9zdmc+Cg=="/>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../sslearn.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;sslearn</a>

<a href="/sslearn">            <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iODY3LjI1MTM0IgogICBoZWlnaHQ9IjMzNS4yOTIyNCIKICAgdmlld0JveD0iMCAwIDIyOS40NjAyNSA4OC43MTI3MzYiCiAgIHZlcnNpb249IjEuMSIKICAgaWQ9InN2ZzEiCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMy4yICgwOTFlMjBlZjBmLCAyMDIzLTExLTI1LCBjdXN0b20pIgogICBzb2RpcG9kaTpkb2NuYW1lPSJzc2xlYXJuLnN2ZyIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9Im5hbWVkdmlldzEiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpzaG93cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VjaGVja2VyYm9hcmQ9IjAiCiAgICAgaW5rc2NhcGU6ZGVza2NvbG9yPSIjZDFkMWQxIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJtbSIKICAgICBpbmtzY2FwZTp6b29tPSIwLjgxNzgwMzA0IgogICAgIGlua3NjYXBlOmN4PSIzNDcuODgzMjgiCiAgICAgaW5rc2NhcGU6Y3k9IjEyNS45NDcyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTc3MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMTc2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIyNCIKICAgICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMiIgLz4KICA8ZGVmcwogICAgIGlkPSJkZWZzMSIgLz4KICA8ZwogICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiCiAgICAgaWQ9ImxheWVyMyIKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMyIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTYuMjk4Nzg0LC0xNzIuMzgzMDIpIiAvPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNi4yOTg3ODQsLTE3Mi4zODMwMikiPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc2l6ZTo2OS40NDM5cHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpzYW5zLXNlcmlmO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgIHg9IjE5LjM0NDM4NyIKICAgICAgIHk9IjI1OS45MDg5NyIKICAgICAgIGlkPSJ0ZXh0MSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjEiCiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NjkuNDQzOXB4O2ZvbnQtZmFtaWx5OlAwNTI7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonUDA1MiBCb2xkJztmaWxsOiMwMDdmMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICAgIHg9IjE5LjM0NDM4NyIKICAgICAgICAgeT0iMjU5LjkwODk3Ij48dHNwYW4KICAgc3R5bGU9ImZpbGw6IzAwNzNjMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgaWQ9InRzcGFuNiI+PHRzcGFuCiAgIHN0eWxlPSJmaWxsOiM5OTAwMDA7ZmlsbC1vcGFjaXR5OjEiCiAgIGlkPSJ0c3BhbjciPnNzPC90c3Bhbj5sPC90c3Bhbj5lYXJuPC90c3Bhbj48L3RleHQ+CiAgPC9nPgogIDxnCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIyIgogICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAyIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNi4yOTg3ODQsLTE3Mi4zODMwMikiPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNiIKICAgICAgIGN4PSI3My41NDY1NTUiCiAgICAgICBjeT0iMjE5LjY2MTEyIgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi02MCIKICAgICAgIGN4PSI3Mi4wOTg0NzMiCiAgICAgICBjeT0iMTk5LjU5MTI5IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi00IgogICAgICAgY3g9IjM3Ljc3MDYzOCIKICAgICAgIGN5PSIxOTEuOTQ0NDkiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgiCiAgICAgICBjeD0iNjYuMjkyODMxIgogICAgICAgY3k9IjE4NC40Mzg1MSIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC05IgogICAgICAgY3g9IjkwLjMzMDkzMyIKICAgICAgIGN5PSIyMDEuMDk1ODciCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtOS05IgogICAgICAgY3g9IjEwNi40OTUzNSIKICAgICAgIGN5PSIyMTYuMjc1OCIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC0zIgogICAgICAgY3g9IjEwNC40NzYyMiIKICAgICAgIGN5PSIyMDAuNDI1MzIiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtOCIKICAgICAgIGN4PSI4Ny4zMjUyOTQiCiAgICAgICBjeT0iMTg1LjM0Njc5IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTciCiAgICAgICBjeD0iMTA1LjIxNDE5IgogICAgICAgY3k9IjE4NS4zMzM1NiIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC0zNCIKICAgICAgIGN4PSIxMTkuNzc2MzciCiAgICAgICBjeT0iMjAwLjM4MjEiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtMCIKICAgICAgIGN4PSIxMjIuNjYwMzUiCiAgICAgICBjeT0iMjE2LjI2Njk0IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTc0IgogICAgICAgY3g9IjEyMy40MjE1OSIKICAgICAgIGN5PSIxODQuNjgzNzUiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtNiIKICAgICAgIGN4PSI0OS4zNDc0NjIiCiAgICAgICBjeT0iMTg0LjUxOTMzIgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi03IgogICAgICAgY3g9IjIyLjcxMTA1NiIKICAgICAgIGN5PSIxOTkuMjExMjQiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTItMSIKICAgICAgIGN4PSIyNS4wODQ1MDciCiAgICAgICBjeT0iMjE2LjIxODY0IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTciCiAgICAgICBjeD0iMjM3Ljg1NDY2IgogICAgICAgY3k9IjIyMS4wODMzNyIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC01Mi0wOSIKICAgICAgIGN4PSIyMTkuMjE0NDUiCiAgICAgICBjeT0iMTgyLjM4MzA0IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTMiCiAgICAgICBjeD0iMjM1LjM5OTciCiAgICAgICBjeT0iMTg4LjQzNjI4IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTcxIgogICAgICAgY3g9IjIzOS4zNDY3NyIKICAgICAgIGN5PSIyMDIuOTYzMjYiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtNTItNzEtNyIKICAgICAgIGN4PSIyMTIuNDE1MjIiCiAgICAgICBjeT0iMjE1Ljk5MDgzIgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTcxLTctNSIKICAgICAgIGN4PSIyMTAuNjcwMTQiCiAgICAgICBjeT0iMTk5LjQxNzAxIgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTIiCiAgICAgICBjeD0iMTY5LjI3NzAyIgogICAgICAgY3k9IjIwNC40NzAyMSIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC01Mi0yLTciCiAgICAgICBjeD0iMTYwLjE2MTcxIgogICAgICAgY3k9IjIxNy45MDE1IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTItNy04IgogICAgICAgY3g9IjE1NC4yMTE2NSIKICAgICAgIGN5PSIyMDEuMDM4MTIiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtNTItMi03LTYiCiAgICAgICBjeD0iMTY2LjkxMjg3IgogICAgICAgY3k9IjE4Ni4zNzQ4NSIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC01Mi04IgogICAgICAgY3g9IjE5OC43Njc5NyIKICAgICAgIGN5PSIyMTkuMjU2MzIiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTgtNTItNCIKICAgICAgIGN4PSIxOTAuMDMyMjMiCiAgICAgICBjeT0iMjAxLjE3NDM2IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTAiCiAgICAgICBjeD0iMTk3LjY5MzgzIgogICAgICAgY3k9IjE4NC40NDIxOCIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxjaXJjbGUKICAgICAgIHN0eWxlPSJmaWxsOiM5OWM3ZTU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDYtOC01Mi0wLTMiCiAgICAgICBjeD0iMTgyLjE5NzIiCiAgICAgICBjeT0iMTg5LjMzMTc0IgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTUyLTAtNyIKICAgICAgIGN4PSIxNzYuMDA4OTQiCiAgICAgICBjeT0iMjIwLjcwMTYzIgogICAgICAgcj0iNi40MTIyNzE1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6Izk5YzdlNTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNi04LTA5IgogICAgICAgY3g9IjIyOC4xMzQzNyIKICAgICAgIGN5PSIyMTEuMjI4NzEiCiAgICAgICByPSI2LjQxMjI3MTUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGg2LTItMTUiCiAgICAgICBjeD0iNTEuNTg1MjYyIgogICAgICAgY3k9IjIwOC4yMjk1NSIKICAgICAgIHI9IjYuNDEyMjcxNSIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJzdGFyIgogICAgICAgc3R5bGU9ImZpbGw6Izk5MDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zNTI2OSIKICAgICAgIGlkPSJwYXRoNC0yIgogICAgICAgaW5rc2NhcGU6ZmxhdHNpZGVkPSJ0cnVlIgogICAgICAgc29kaXBvZGk6c2lkZXM9IjMiCiAgICAgICBzb2RpcG9kaTpjeD0iNjAuOTg4MjM1IgogICAgICAgc29kaXBvZGk6Y3k9IjQwLjAzNjc2MiIKICAgICAgIHNvZGlwb2RpOnIxPSIyLjkwOTYxMjciCiAgICAgICBzb2RpcG9kaTpyMj0iMS40NTQ4MDY0IgogICAgICAgc29kaXBvZGk6YXJnMT0iMC41MzMxMzE0OSIKICAgICAgIHNvZGlwb2RpOmFyZzI9IjEuNTgwMzI5IgogICAgICAgaW5rc2NhcGU6cm91bmRlZD0iMCIKICAgICAgIGlua3NjYXBlOnJhbmRvbWl6ZWQ9IjAiCiAgICAgICBkPSJtIDYzLjQ5NDA1MSw0MS41MTU1MjMgLTUuMDM5MzY4LC0wLjA0ODA0IDIuNTYxMjg5LC00LjM0MDIgeiIKICAgICAgIGlua3NjYXBlOnRyYW5zZm9ybS1jZW50ZXIteD0iMC4wNTY4NzU1MDkiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii0yLjkzMzcxNTIiCiAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCg0LjEwMTAyNjEsMCwwLDQuMTAxMDI2MSwtMjE0Ljk2MjU3LDQ4LjAxMzY1MikiIC8+CiAgICA8cGF0aAogICAgICAgc29kaXBvZGk6dHlwZT0ic3RhciIKICAgICAgIHN0eWxlPSJmaWxsOiM5OTAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDQiCiAgICAgICBpbmtzY2FwZTpmbGF0c2lkZWQ9ImZhbHNlIgogICAgICAgc29kaXBvZGk6c2lkZXM9IjMiCiAgICAgICBzb2RpcG9kaTpjeD0iNjAuOTg4MjM1IgogICAgICAgc29kaXBvZGk6Y3k9IjQwLjAzNjc2MiIKICAgICAgIHNvZGlwb2RpOnIxPSIyLjkwOTYxMjciCiAgICAgICBzb2RpcG9kaTpyMj0iMS40NTQ4MDY0IgogICAgICAgc29kaXBvZGk6YXJnMT0iMC41MzMxMzE0OSIKICAgICAgIHNvZGlwb2RpOmFyZzI9IjEuNTgwMzI5IgogICAgICAgaW5rc2NhcGU6cm91bmRlZD0iMCIKICAgICAgIGlua3NjYXBlOnJhbmRvbWl6ZWQ9IjAiCiAgICAgICBkPSJtIDYzLjQ5NDA1MSw0MS41MTU1MjMgLTIuNTE5Njg0LC0wLjAyNDAyIC0yLjUxOTY4NCwtMC4wMjQwMiAxLjI4MDY0NCwtMi4xNzAxIDEuMjgwNjQ1LC0yLjE3MDEgMS4yMzkwNCwyLjE5NDEyIHoiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXg9IjAuMDU2ODczODE3IgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci15PSItMi45MzM3MTQxIgogICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoNC4xMDEwMjYxLDAsMCw0LjEwMTAyNjEsLTE5NS41NDQyNSwzMC40NjAzMSkiIC8+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zaXplOjUwLjhweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxLjA4NTA2IgogICAgICAgeD0iMTg4LjQ2NzQxIgogICAgICAgeT0iMjI1Ljc0MTQ0IgogICAgICAgaWQ9InRleHQ1Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuNSIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo1MC44cHg7Zm9udC1mYW1pbHk6UDA1MjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidQMDUyIEJvbGQnO2ZpbGw6IzAwN2YwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgICAgeD0iMTg4LjQ2NzQxIgogICAgICAgICB5PSIyMjUuNzQxNDQiPio8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6NTAuOHB4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICB4PSIyMTQuMjA4OTEiCiAgICAgICB5PSIyMjMuMTg1MDYiCiAgICAgICBpZD0idGV4dDUtOCI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjUtOSIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo1MC44cHg7Zm9udC1mYW1pbHk6UDA1MjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidQMDUyIEJvbGQnO2ZpbGw6IzAwN2YwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MS4wODUwNiIKICAgICAgICAgeD0iMjE0LjIwODkxIgogICAgICAgICB5PSIyMjMuMTg1MDYiPio8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6NTAuOHB4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICB4PSIxNzEuNzY4NDgiCiAgICAgICB5PSIyMzkuMDk3OTkiCiAgICAgICBpZD0idGV4dDUtOC03Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuNS05LTkiCiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NTAuOHB4O2ZvbnQtZmFtaWx5OlAwNTI7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonUDA1MiBCb2xkJztmaWxsOiMwMDdmMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjEuMDg1MDYiCiAgICAgICAgIHg9IjE3MS43Njg0OCIKICAgICAgICAgeT0iMjM5LjA5Nzk5Ij4qPC90c3Bhbj48L3RleHQ+CiAgICA8cGF0aAogICAgICAgc29kaXBvZGk6dHlwZT0ic3RhciIKICAgICAgIHN0eWxlPSJmaWxsOiM5OTAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzUyNjkiCiAgICAgICBpZD0icGF0aDQtNiIKICAgICAgIGlua3NjYXBlOmZsYXRzaWRlZD0iZmFsc2UiCiAgICAgICBzb2RpcG9kaTpzaWRlcz0iMyIKICAgICAgIHNvZGlwb2RpOmN4PSI2MC45ODgyMzUiCiAgICAgICBzb2RpcG9kaTpjeT0iNDAuMDM2NzYyIgogICAgICAgc29kaXBvZGk6cjE9IjIuOTA5NjEyNyIKICAgICAgIHNvZGlwb2RpOnIyPSIxLjQ1NDgwNjQiCiAgICAgICBzb2RpcG9kaTphcmcxPSIwLjUzMzEzMTQ5IgogICAgICAgc29kaXBvZGk6YXJnMj0iMS41ODAzMjkiCiAgICAgICBpbmtzY2FwZTpyb3VuZGVkPSIwIgogICAgICAgaW5rc2NhcGU6cmFuZG9taXplZD0iMCIKICAgICAgIGQ9Im0gNjMuNDk0MDUxLDQxLjUxNTUyMyAtMi41MTk2ODQsLTAuMDI0MDIgLTIuNTE5Njg0LC0wLjAyNDAyIDEuMjgwNjQ0LC0yLjE3MDEgMS4yODA2NDUsLTIuMTcwMSAxLjIzOTA0LDIuMTk0MTIgeiIKICAgICAgIGlua3NjYXBlOnRyYW5zZm9ybS1jZW50ZXIteD0iMC4wNTY4NzYwNDUiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii0yLjkzMzcxMiIKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDQuMTAxMDI2MSwwLDAsNC4xMDEwMjYxLC0xODQuMzAzNTUsNTIuNzI1NjYxKSIgLz4KICAgIDxlbGxpcHNlCiAgICAgICBzdHlsZT0iZmlsbDojOTljN2U1O3N0cm9rZS13aWR0aDowLjM1MjY5IgogICAgICAgaWQ9InBhdGgxIgogICAgICAgY3g9IjkyLjEyNTQ1IgogICAgICAgY3k9IjE4Ny44NTIzMSIKICAgICAgIHJ4PSIwLjI1MjY3ODM2IgogICAgICAgcnk9IjAuNzgxNzE2MjkiIC8+CiAgPC9nPgo8L3N2Zz4K" class="logo" alt="project logo"/>
</a>
            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#self-training-algorithms">Self-Training Algorithms</a></li>
  <li><a href="#co-training-algorithms">Co-Training Algorithms</a></li>
  <li><a href="#all-doc">All doc</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#SelfTraining">SelfTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SelfTraining.__init__">SelfTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#SelfTraining.fit">fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoTrainingByCommittee">CoTrainingByCommittee</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.__init__">CoTrainingByCommittee</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.score">score</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTrainingByCommittee.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Rasco">Rasco</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Rasco.__init__">Rasco</a>
                        </li>
                        <li>
                                <a class="function" href="#Rasco.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Rasco.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RelRasco">RelRasco</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RelRasco.__init__">RelRasco</a>
                        </li>
                        <li>
                                <a class="function" href="#RelRasco.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TriTraining">TriTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TriTraining.__init__">TriTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#TriTraining.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#TriTraining.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WiWTriTraining">WiWTriTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WiWTriTraining.__init__">WiWTriTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#WiWTriTraining.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#WiWTriTraining.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#WiWTriTraining.set_fit_request">set_fit_request</a>
                        </li>
                        <li>
                                <a class="function" href="#WiWTriTraining.set_predict_request">set_predict_request</a>
                        </li>
                        <li>
                                <a class="function" href="#WiWTriTraining.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoTraining">CoTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoTraining.__init__">CoTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.score">score</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.set_fit_request">set_fit_request</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.set_predict_request">set_predict_request</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.set_predict_proba_request">set_predict_proba_request</a>
                        </li>
                        <li>
                                <a class="function" href="#CoTraining.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DeTriTraining">DeTriTraining</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DeTriTraining.__init__">DeTriTraining</a>
                        </li>
                        <li>
                                <a class="function" href="#DeTriTraining.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#DeTriTraining.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DemocraticCoLearning">DemocraticCoLearning</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DemocraticCoLearning.__init__">DemocraticCoLearning</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.set_fit_request">set_fit_request</a>
                        </li>
                        <li>
                                <a class="function" href="#DemocraticCoLearning.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Setred">Setred</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Setred.__init__">Setred</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#Setred.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CoForest">CoForest</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CoForest.__init__">CoForest</a>
                        </li>
                        <li>
                                <a class="function" href="#CoForest.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#CoForest.set_score_request">set_score_request</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>pdoc 14.4.0</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../sslearn.html">sslearn</a><wbr>.wrapper    </h1>

                        <div class="docstring"><p>Summary of module <code><a href="">sslearn.wrapper</a></code>:</p>

<p>This module contains classes to train semi-supervised learning algorithms using a wrapper approach.</p>

<h2 id="self-training-algorithms">Self-Training Algorithms</h2>

<ol>
<li>SelfTraining : Self-training algorithm.</li>
<li>Setred : Self-training with redundancy reduction.</li>
</ol>

<h2 id="co-training-algorithms">Co-Training Algorithms</h2>

<ol>
<li>CoTraining : Co-training</li>
<li>CoTrainingByCommittee : Co-training by committee</li>
<li>DemocraticCoLearning : Democratic co-learning</li>
<li>Rasco : Random subspace co-training</li>
<li>RelRasco : Relevant random subspace co-training</li>
<li>CoForest : Co-Forest</li>
<li>TriTraining : Tri-training</li>
<li>DeTriTraining : Data Editing Tri-training</li>
<li>WiWTriTraining : Who-Is-Who Tri-training</li>
</ol>

<h2 id="all-doc">All doc</h2>
</div>

                        <input id="mod-wrapper-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-wrapper-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">Summary of module `sslearn.wrapper`:</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">This module contains classes to train semi-supervised learning algorithms using a wrapper approach.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">Self-Training Algorithms</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">------------------------</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">1. SelfTraining : Self-training algorithm.</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">2. Setred : Self-training with redundancy reduction.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">Co-Training Algorithms</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">-----------------------</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">1. CoTraining : Co-training</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">2. CoTrainingByCommittee : Co-training by committee</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">3. DemocraticCoLearning : Democratic co-learning</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">4. Rasco : Random subspace co-training</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">5. RelRasco : Relevant random subspace co-training</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">6. CoForest : Co-Forest</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">7. TriTraining : Tri-training</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="sd">8. DeTriTraining : Data Editing Tri-training</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">9. WiWTriTraining : Who-Is-Who Tri-training</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">All doc</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="sd">----</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span> <span class="nn">._co</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CoForest</span><span class="p">,</span> <span class="n">CoTraining</span><span class="p">,</span> <span class="n">CoTrainingByCommittee</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>                  <span class="n">DemocraticCoLearning</span><span class="p">,</span> <span class="n">Rasco</span><span class="p">,</span> <span class="n">RelRasco</span><span class="p">)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="kn">from</span> <span class="nn">._self</span> <span class="kn">import</span> <span class="n">SelfTraining</span><span class="p">,</span> <span class="n">Setred</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="kn">from</span> <span class="nn">._tritraining</span> <span class="kn">import</span> <span class="n">DeTriTraining</span><span class="p">,</span> <span class="n">TriTraining</span><span class="p">,</span> <span class="n">WiWTriTraining</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SelfTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;CoTrainingByCommittee&quot;</span><span class="p">,</span> <span class="s2">&quot;Rasco&quot;</span><span class="p">,</span> <span class="s2">&quot;RelRasco&quot;</span><span class="p">,</span> <span class="s2">&quot;TriTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;WiWTriTraining&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>           <span class="s2">&quot;CoTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;DeTriTraining&quot;</span><span class="p">,</span> <span class="s2">&quot;DemocraticCoLearning&quot;</span><span class="p">,</span> <span class="s2">&quot;Setred&quot;</span><span class="p">,</span> <span class="s2">&quot;CoForest&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="SelfTraining">
                            <input id="SelfTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SelfTraining</span><wbr>(<span class="base">sklearn.semi_supervised._self_training.SelfTrainingClassifier</span>):

                <label class="view-source-button" for="SelfTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining-16"><a href="#SelfTraining-16"><span class="linenos"> 16</span></a><span class="k">class</span> <span class="nc">SelfTraining</span><span class="p">(</span><span class="n">SelfTrainingClassifier</span><span class="p">):</span>
</span><span id="SelfTraining-17"><a href="#SelfTraining-17"><span class="linenos"> 17</span></a>
</span><span id="SelfTraining-18"><a href="#SelfTraining-18"><span class="linenos"> 18</span></a>    <span class="n">_estimator_type</span> <span class="o">=</span> <span class="s2">&quot;classifier&quot;</span>
</span><span id="SelfTraining-19"><a href="#SelfTraining-19"><span class="linenos"> 19</span></a>
</span><span id="SelfTraining-20"><a href="#SelfTraining-20"><span class="linenos"> 20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SelfTraining-21"><a href="#SelfTraining-21"><span class="linenos"> 21</span></a>                 <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="SelfTraining-22"><a href="#SelfTraining-22"><span class="linenos"> 22</span></a>                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="SelfTraining-23"><a href="#SelfTraining-23"><span class="linenos"> 23</span></a>                 <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
</span><span id="SelfTraining-24"><a href="#SelfTraining-24"><span class="linenos"> 24</span></a>                 <span class="n">k_best</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining-25"><a href="#SelfTraining-25"><span class="linenos"> 25</span></a>                 <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining-26"><a href="#SelfTraining-26"><span class="linenos"> 26</span></a>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="SelfTraining-27"><a href="#SelfTraining-27"><span class="linenos"> 27</span></a>        <span class="sd">&quot;&quot;&quot;Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</span>
</span><span id="SelfTraining-28"><a href="#SelfTraining-28"><span class="linenos"> 28</span></a>
</span><span id="SelfTraining-29"><a href="#SelfTraining-29"><span class="linenos"> 29</span></a><span class="sd">        This class allows a given supervised classifier to function as a</span>
</span><span id="SelfTraining-30"><a href="#SelfTraining-30"><span class="linenos"> 30</span></a><span class="sd">        semi-supervised classifier, allowing it to learn from unlabeled data. It</span>
</span><span id="SelfTraining-31"><a href="#SelfTraining-31"><span class="linenos"> 31</span></a><span class="sd">        does this by iteratively predicting pseudo-labels for the unlabeled data</span>
</span><span id="SelfTraining-32"><a href="#SelfTraining-32"><span class="linenos"> 32</span></a><span class="sd">        and adding them to the training set.</span>
</span><span id="SelfTraining-33"><a href="#SelfTraining-33"><span class="linenos"> 33</span></a>
</span><span id="SelfTraining-34"><a href="#SelfTraining-34"><span class="linenos"> 34</span></a><span class="sd">        The classifier will continue iterating until either max_iter is reached, or</span>
</span><span id="SelfTraining-35"><a href="#SelfTraining-35"><span class="linenos"> 35</span></a><span class="sd">        no pseudo-labels were added to the training set in the previous iteration.</span>
</span><span id="SelfTraining-36"><a href="#SelfTraining-36"><span class="linenos"> 36</span></a>
</span><span id="SelfTraining-37"><a href="#SelfTraining-37"><span class="linenos"> 37</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining-38"><a href="#SelfTraining-38"><span class="linenos"> 38</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining-39"><a href="#SelfTraining-39"><span class="linenos"> 39</span></a><span class="sd">        base_estimator : estimator object</span>
</span><span id="SelfTraining-40"><a href="#SelfTraining-40"><span class="linenos"> 40</span></a><span class="sd">            An estimator object implementing ``fit`` and ``predict_proba``.</span>
</span><span id="SelfTraining-41"><a href="#SelfTraining-41"><span class="linenos"> 41</span></a><span class="sd">            Invoking the ``fit`` method will fit a clone of the passed estimator,</span>
</span><span id="SelfTraining-42"><a href="#SelfTraining-42"><span class="linenos"> 42</span></a><span class="sd">            which will be stored in the ``base_estimator_`` attribute.</span>
</span><span id="SelfTraining-43"><a href="#SelfTraining-43"><span class="linenos"> 43</span></a>
</span><span id="SelfTraining-44"><a href="#SelfTraining-44"><span class="linenos"> 44</span></a><span class="sd">        threshold : float, default=0.75</span>
</span><span id="SelfTraining-45"><a href="#SelfTraining-45"><span class="linenos"> 45</span></a><span class="sd">            The decision threshold for use with `criterion=&#39;threshold&#39;`.</span>
</span><span id="SelfTraining-46"><a href="#SelfTraining-46"><span class="linenos"> 46</span></a><span class="sd">            Should be in [0, 1). When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining-47"><a href="#SelfTraining-47"><span class="linenos"> 47</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining-48"><a href="#SelfTraining-48"><span class="linenos"> 48</span></a>
</span><span id="SelfTraining-49"><a href="#SelfTraining-49"><span class="linenos"> 49</span></a><span class="sd">        criterion : {&#39;threshold&#39;, &#39;k_best&#39;}, default=&#39;threshold&#39;</span>
</span><span id="SelfTraining-50"><a href="#SelfTraining-50"><span class="linenos"> 50</span></a><span class="sd">            The selection criterion used to select which labels to add to the</span>
</span><span id="SelfTraining-51"><a href="#SelfTraining-51"><span class="linenos"> 51</span></a><span class="sd">            training set. If &#39;threshold&#39;, pseudo-labels with prediction</span>
</span><span id="SelfTraining-52"><a href="#SelfTraining-52"><span class="linenos"> 52</span></a><span class="sd">            probabilities above `threshold` are added to the dataset. If &#39;k_best&#39;,</span>
</span><span id="SelfTraining-53"><a href="#SelfTraining-53"><span class="linenos"> 53</span></a><span class="sd">            the `k_best` pseudo-labels with highest prediction probabilities are</span>
</span><span id="SelfTraining-54"><a href="#SelfTraining-54"><span class="linenos"> 54</span></a><span class="sd">            added to the dataset. When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining-55"><a href="#SelfTraining-55"><span class="linenos"> 55</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining-56"><a href="#SelfTraining-56"><span class="linenos"> 56</span></a>
</span><span id="SelfTraining-57"><a href="#SelfTraining-57"><span class="linenos"> 57</span></a><span class="sd">        k_best : int, default=10</span>
</span><span id="SelfTraining-58"><a href="#SelfTraining-58"><span class="linenos"> 58</span></a><span class="sd">            The amount of samples to add in each iteration. Only used when</span>
</span><span id="SelfTraining-59"><a href="#SelfTraining-59"><span class="linenos"> 59</span></a><span class="sd">            `criterion` is k_best&#39;.</span>
</span><span id="SelfTraining-60"><a href="#SelfTraining-60"><span class="linenos"> 60</span></a>
</span><span id="SelfTraining-61"><a href="#SelfTraining-61"><span class="linenos"> 61</span></a><span class="sd">        max_iter : int or None, default=10</span>
</span><span id="SelfTraining-62"><a href="#SelfTraining-62"><span class="linenos"> 62</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal</span>
</span><span id="SelfTraining-63"><a href="#SelfTraining-63"><span class="linenos"> 63</span></a><span class="sd">            to 0. If it is ``None``, the classifier will continue to predict labels</span>
</span><span id="SelfTraining-64"><a href="#SelfTraining-64"><span class="linenos"> 64</span></a><span class="sd">            until no new pseudo-labels are added, or all unlabeled samples have</span>
</span><span id="SelfTraining-65"><a href="#SelfTraining-65"><span class="linenos"> 65</span></a><span class="sd">            been labeled.</span>
</span><span id="SelfTraining-66"><a href="#SelfTraining-66"><span class="linenos"> 66</span></a>
</span><span id="SelfTraining-67"><a href="#SelfTraining-67"><span class="linenos"> 67</span></a><span class="sd">        verbose : bool, default=False</span>
</span><span id="SelfTraining-68"><a href="#SelfTraining-68"><span class="linenos"> 68</span></a><span class="sd">            Enable verbose output.</span>
</span><span id="SelfTraining-69"><a href="#SelfTraining-69"><span class="linenos"> 69</span></a>
</span><span id="SelfTraining-70"><a href="#SelfTraining-70"><span class="linenos"> 70</span></a><span class="sd">        References</span>
</span><span id="SelfTraining-71"><a href="#SelfTraining-71"><span class="linenos"> 71</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining-72"><a href="#SelfTraining-72"><span class="linenos"> 72</span></a><span class="sd">        David Yarowsky. 1995. Unsupervised word sense disambiguation rivaling</span>
</span><span id="SelfTraining-73"><a href="#SelfTraining-73"><span class="linenos"> 73</span></a><span class="sd">        supervised methods. In Proceedings of the 33rd annual meeting on</span>
</span><span id="SelfTraining-74"><a href="#SelfTraining-74"><span class="linenos"> 74</span></a><span class="sd">        Association for Computational Linguistics (ACL &#39;95). Association for</span>
</span><span id="SelfTraining-75"><a href="#SelfTraining-75"><span class="linenos"> 75</span></a><span class="sd">        Computational Linguistics, Stroudsburg, PA, USA, 189-196. DOI:</span>
</span><span id="SelfTraining-76"><a href="#SelfTraining-76"><span class="linenos"> 76</span></a><span class="sd">        https://doi.org/10.3115/981658.981684</span>
</span><span id="SelfTraining-77"><a href="#SelfTraining-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining-78"><a href="#SelfTraining-78"><span class="linenos"> 78</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">k_best</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="SelfTraining-79"><a href="#SelfTraining-79"><span class="linenos"> 79</span></a>
</span><span id="SelfTraining-80"><a href="#SelfTraining-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="SelfTraining-81"><a href="#SelfTraining-81"><span class="linenos"> 81</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SelfTraining-82"><a href="#SelfTraining-82"><span class="linenos"> 82</span></a><span class="sd">        Fits this ``SelfTrainingClassifier`` to a dataset.</span>
</span><span id="SelfTraining-83"><a href="#SelfTraining-83"><span class="linenos"> 83</span></a>
</span><span id="SelfTraining-84"><a href="#SelfTraining-84"><span class="linenos"> 84</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining-85"><a href="#SelfTraining-85"><span class="linenos"> 85</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining-86"><a href="#SelfTraining-86"><span class="linenos"> 86</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="SelfTraining-87"><a href="#SelfTraining-87"><span class="linenos"> 87</span></a><span class="sd">            Array representing the data.</span>
</span><span id="SelfTraining-88"><a href="#SelfTraining-88"><span class="linenos"> 88</span></a>
</span><span id="SelfTraining-89"><a href="#SelfTraining-89"><span class="linenos"> 89</span></a><span class="sd">        y : {array-like, sparse matrix} of shape (n_samples,)</span>
</span><span id="SelfTraining-90"><a href="#SelfTraining-90"><span class="linenos"> 90</span></a><span class="sd">            Array representing the labels. Unlabeled samples should have the</span>
</span><span id="SelfTraining-91"><a href="#SelfTraining-91"><span class="linenos"> 91</span></a><span class="sd">            label -1.</span>
</span><span id="SelfTraining-92"><a href="#SelfTraining-92"><span class="linenos"> 92</span></a>
</span><span id="SelfTraining-93"><a href="#SelfTraining-93"><span class="linenos"> 93</span></a><span class="sd">        Returns</span>
</span><span id="SelfTraining-94"><a href="#SelfTraining-94"><span class="linenos"> 94</span></a><span class="sd">        -------</span>
</span><span id="SelfTraining-95"><a href="#SelfTraining-95"><span class="linenos"> 95</span></a><span class="sd">        self : SelfTrainingClassifier</span>
</span><span id="SelfTraining-96"><a href="#SelfTraining-96"><span class="linenos"> 96</span></a><span class="sd">            Returns an instance of self.</span>
</span><span id="SelfTraining-97"><a href="#SelfTraining-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining-98"><a href="#SelfTraining-98"><span class="linenos"> 98</span></a>        <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SelfTraining-99"><a href="#SelfTraining-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
</span><span id="SelfTraining-100"><a href="#SelfTraining-100"><span class="linenos">100</span></a>            <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
</span><span id="SelfTraining-101"><a href="#SelfTraining-101"><span class="linenos">101</span></a>            <span class="n">y_adapted</span><span class="p">[</span><span class="n">y_adapted</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="SelfTraining-102"><a href="#SelfTraining-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_adapted</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Self-training classifier.</p>

<p>This :term:<code>metaestimator</code> allows a given supervised classifier to function as a
semi-supervised classifier, allowing it to learn from unlabeled data. It
does this by iteratively predicting pseudo-labels for the unlabeled data
and adding them to the training set.</p>

<p>The classifier will continue iterating until either max_iter is reached, or
no pseudo-labels were added to the training set in the previous iteration.</p>

<p>Read more in the :ref:<code>User Guide &lt;self_training&gt;</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (estimator object):
An estimator object implementing <code><a href="#SelfTraining.fit">fit</a></code> and <code><a href="#SelfTraining.predict_proba">predict_proba</a></code>.
Invoking the <code><a href="#SelfTraining.fit">fit</a></code> method will fit a clone of the passed estimator,
which will be stored in the <code>base_estimator_</code> attribute.</li>
<li><strong>threshold</strong> (float, default=0.75):
The decision threshold for use with <code>criterion='threshold'</code>.
Should be in [0, 1). When using the <code>'threshold'</code> criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>criterion</strong> ({'threshold', 'k_best'}, default='threshold'):
The selection criterion used to select which labels to add to the
training set. If <code>'threshold'</code>, pseudo-labels with prediction
probabilities above <code>threshold</code> are added to the dataset. If <code>'k_best'</code>,
the <code>k_best</code> pseudo-labels with highest prediction probabilities are
added to the dataset. When using the 'threshold' criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>k_best</strong> (int, default=10):
The amount of samples to add in each iteration. Only used when
<code>criterion='k_best'</code>.</li>
<li><strong>max_iter</strong> (int or None, default=10):
Maximum number of iterations allowed. Should be greater than or equal
to 0. If it is <code>None</code>, the classifier will continue to predict labels
until no new pseudo-labels are added, or all unlabeled samples have
been labeled.</li>
<li><strong>verbose</strong> (bool, default=False):
Enable verbose output.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>base_estimator_</strong> (estimator object):
The fitted estimator.</li>
<li><strong>classes_</strong> (ndarray or list of ndarray of shape (n_classes,)):
Class labels for each output. (Taken from the trained
<code>base_estimator_</code>).</li>
<li><strong>transduction_</strong> (ndarray of shape (n_samples,)):
The labels used for the final fit of the classifier, including
pseudo-labels added during fit.</li>
<li><strong>labeled_iter_</strong> (ndarray of shape (n_samples,)):
The iteration in which each sample was labeled. When a sample has
iteration 0, the sample was already labeled in the original dataset.
When a sample has iteration -1, the sample was not labeled in any
iteration.</li>
<li><p><strong>n_features_in_</strong> (int):
Number of features seen during :term:<code><a href="#SelfTraining.fit">fit</a></code>.</p>

<p><em>New in version 0.24.</em></p></li>
<li><p><strong>feature_names_in_</strong> (ndarray of shape (<code>n_features_in_</code>,)):
Names of features seen during :term:<code><a href="#SelfTraining.fit">fit</a></code>. Defined only when <code>X</code>
has feature names that are all strings.</p>

<p><em>New in version 1.0.</em></p></li>
<li><strong>n_iter_</strong> (int):
The number of rounds of self-training, that is the number of times the
base estimator is fitted on relabeled variants of the training set.</li>
<li><p><strong>termination_condition_</strong> ({'max_iter', 'no_change', 'all_labeled'}):
The reason that fitting was stopped.</p>

<ul>
<li><code>'max_iter'</code>: <code>n_iter_</code> reached <code>max_iter</code>.</li>
<li><code>'no_change'</code>: no new labels were predicted.</li>
<li><code>'all_labeled'</code>: all unlabeled samples were labeled before <code>max_iter</code>
was reached.</li>
</ul></li>
</ul>

<h6 id="see-also">See Also</h6>

<p><code>LabelPropagation</code>:  Label propagation classifier. <br />
<code>LabelSpreading</code>:  Label spreading model for semi-supervised learning.  </p>

<h6 id="references">References</h6>

<p>:doi:<code>David Yarowsky. 1995. Unsupervised word sense disambiguation rivaling
supervised methods. In Proceedings of the 33rd annual meeting on
Association for Computational Linguistics (ACL '95). Association for
Computational Linguistics, Stroudsburg, PA, USA, 189-196.
&lt;10.3115/981658.981684&gt;</code></p>

<h6 id="examples">Examples</h6>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.semi_supervised</span> <span class="kn">import</span> <span class="n">SelfTrainingClassifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random_unlabeled_points</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">[</span><span class="n">random_unlabeled_points</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">self_training_model</span> <span class="o">=</span> <span class="n">SelfTrainingClassifier</span><span class="p">(</span><span class="n">svc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">self_training_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="go">SelfTrainingClassifier(...)</span>
</code></pre>
</div>
</div>


                            <div id="SelfTraining.__init__" class="classattr">
                                        <input id="SelfTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SelfTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span>,</span><span class="param">	<span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span>,</span><span class="param">	<span class="n">k_best</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="SelfTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining.__init__-20"><a href="#SelfTraining.__init__-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-21"><a href="#SelfTraining.__init__-21"><span class="linenos">21</span></a>                 <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-22"><a href="#SelfTraining.__init__-22"><span class="linenos">22</span></a>                 <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-23"><a href="#SelfTraining.__init__-23"><span class="linenos">23</span></a>                 <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-24"><a href="#SelfTraining.__init__-24"><span class="linenos">24</span></a>                 <span class="n">k_best</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-25"><a href="#SelfTraining.__init__-25"><span class="linenos">25</span></a>                 <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="SelfTraining.__init__-26"><a href="#SelfTraining.__init__-26"><span class="linenos">26</span></a>                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="SelfTraining.__init__-27"><a href="#SelfTraining.__init__-27"><span class="linenos">27</span></a>        <span class="sd">&quot;&quot;&quot;Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</span>
</span><span id="SelfTraining.__init__-28"><a href="#SelfTraining.__init__-28"><span class="linenos">28</span></a>
</span><span id="SelfTraining.__init__-29"><a href="#SelfTraining.__init__-29"><span class="linenos">29</span></a><span class="sd">        This class allows a given supervised classifier to function as a</span>
</span><span id="SelfTraining.__init__-30"><a href="#SelfTraining.__init__-30"><span class="linenos">30</span></a><span class="sd">        semi-supervised classifier, allowing it to learn from unlabeled data. It</span>
</span><span id="SelfTraining.__init__-31"><a href="#SelfTraining.__init__-31"><span class="linenos">31</span></a><span class="sd">        does this by iteratively predicting pseudo-labels for the unlabeled data</span>
</span><span id="SelfTraining.__init__-32"><a href="#SelfTraining.__init__-32"><span class="linenos">32</span></a><span class="sd">        and adding them to the training set.</span>
</span><span id="SelfTraining.__init__-33"><a href="#SelfTraining.__init__-33"><span class="linenos">33</span></a>
</span><span id="SelfTraining.__init__-34"><a href="#SelfTraining.__init__-34"><span class="linenos">34</span></a><span class="sd">        The classifier will continue iterating until either max_iter is reached, or</span>
</span><span id="SelfTraining.__init__-35"><a href="#SelfTraining.__init__-35"><span class="linenos">35</span></a><span class="sd">        no pseudo-labels were added to the training set in the previous iteration.</span>
</span><span id="SelfTraining.__init__-36"><a href="#SelfTraining.__init__-36"><span class="linenos">36</span></a>
</span><span id="SelfTraining.__init__-37"><a href="#SelfTraining.__init__-37"><span class="linenos">37</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining.__init__-38"><a href="#SelfTraining.__init__-38"><span class="linenos">38</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining.__init__-39"><a href="#SelfTraining.__init__-39"><span class="linenos">39</span></a><span class="sd">        base_estimator : estimator object</span>
</span><span id="SelfTraining.__init__-40"><a href="#SelfTraining.__init__-40"><span class="linenos">40</span></a><span class="sd">            An estimator object implementing ``fit`` and ``predict_proba``.</span>
</span><span id="SelfTraining.__init__-41"><a href="#SelfTraining.__init__-41"><span class="linenos">41</span></a><span class="sd">            Invoking the ``fit`` method will fit a clone of the passed estimator,</span>
</span><span id="SelfTraining.__init__-42"><a href="#SelfTraining.__init__-42"><span class="linenos">42</span></a><span class="sd">            which will be stored in the ``base_estimator_`` attribute.</span>
</span><span id="SelfTraining.__init__-43"><a href="#SelfTraining.__init__-43"><span class="linenos">43</span></a>
</span><span id="SelfTraining.__init__-44"><a href="#SelfTraining.__init__-44"><span class="linenos">44</span></a><span class="sd">        threshold : float, default=0.75</span>
</span><span id="SelfTraining.__init__-45"><a href="#SelfTraining.__init__-45"><span class="linenos">45</span></a><span class="sd">            The decision threshold for use with `criterion=&#39;threshold&#39;`.</span>
</span><span id="SelfTraining.__init__-46"><a href="#SelfTraining.__init__-46"><span class="linenos">46</span></a><span class="sd">            Should be in [0, 1). When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining.__init__-47"><a href="#SelfTraining.__init__-47"><span class="linenos">47</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining.__init__-48"><a href="#SelfTraining.__init__-48"><span class="linenos">48</span></a>
</span><span id="SelfTraining.__init__-49"><a href="#SelfTraining.__init__-49"><span class="linenos">49</span></a><span class="sd">        criterion : {&#39;threshold&#39;, &#39;k_best&#39;}, default=&#39;threshold&#39;</span>
</span><span id="SelfTraining.__init__-50"><a href="#SelfTraining.__init__-50"><span class="linenos">50</span></a><span class="sd">            The selection criterion used to select which labels to add to the</span>
</span><span id="SelfTraining.__init__-51"><a href="#SelfTraining.__init__-51"><span class="linenos">51</span></a><span class="sd">            training set. If &#39;threshold&#39;, pseudo-labels with prediction</span>
</span><span id="SelfTraining.__init__-52"><a href="#SelfTraining.__init__-52"><span class="linenos">52</span></a><span class="sd">            probabilities above `threshold` are added to the dataset. If &#39;k_best&#39;,</span>
</span><span id="SelfTraining.__init__-53"><a href="#SelfTraining.__init__-53"><span class="linenos">53</span></a><span class="sd">            the `k_best` pseudo-labels with highest prediction probabilities are</span>
</span><span id="SelfTraining.__init__-54"><a href="#SelfTraining.__init__-54"><span class="linenos">54</span></a><span class="sd">            added to the dataset. When using the &#39;threshold&#39; criterion, a</span>
</span><span id="SelfTraining.__init__-55"><a href="#SelfTraining.__init__-55"><span class="linenos">55</span></a><span class="sd">            :ref:`well calibrated classifier &lt;calibration&gt;` should be used.</span>
</span><span id="SelfTraining.__init__-56"><a href="#SelfTraining.__init__-56"><span class="linenos">56</span></a>
</span><span id="SelfTraining.__init__-57"><a href="#SelfTraining.__init__-57"><span class="linenos">57</span></a><span class="sd">        k_best : int, default=10</span>
</span><span id="SelfTraining.__init__-58"><a href="#SelfTraining.__init__-58"><span class="linenos">58</span></a><span class="sd">            The amount of samples to add in each iteration. Only used when</span>
</span><span id="SelfTraining.__init__-59"><a href="#SelfTraining.__init__-59"><span class="linenos">59</span></a><span class="sd">            `criterion` is k_best&#39;.</span>
</span><span id="SelfTraining.__init__-60"><a href="#SelfTraining.__init__-60"><span class="linenos">60</span></a>
</span><span id="SelfTraining.__init__-61"><a href="#SelfTraining.__init__-61"><span class="linenos">61</span></a><span class="sd">        max_iter : int or None, default=10</span>
</span><span id="SelfTraining.__init__-62"><a href="#SelfTraining.__init__-62"><span class="linenos">62</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal</span>
</span><span id="SelfTraining.__init__-63"><a href="#SelfTraining.__init__-63"><span class="linenos">63</span></a><span class="sd">            to 0. If it is ``None``, the classifier will continue to predict labels</span>
</span><span id="SelfTraining.__init__-64"><a href="#SelfTraining.__init__-64"><span class="linenos">64</span></a><span class="sd">            until no new pseudo-labels are added, or all unlabeled samples have</span>
</span><span id="SelfTraining.__init__-65"><a href="#SelfTraining.__init__-65"><span class="linenos">65</span></a><span class="sd">            been labeled.</span>
</span><span id="SelfTraining.__init__-66"><a href="#SelfTraining.__init__-66"><span class="linenos">66</span></a>
</span><span id="SelfTraining.__init__-67"><a href="#SelfTraining.__init__-67"><span class="linenos">67</span></a><span class="sd">        verbose : bool, default=False</span>
</span><span id="SelfTraining.__init__-68"><a href="#SelfTraining.__init__-68"><span class="linenos">68</span></a><span class="sd">            Enable verbose output.</span>
</span><span id="SelfTraining.__init__-69"><a href="#SelfTraining.__init__-69"><span class="linenos">69</span></a>
</span><span id="SelfTraining.__init__-70"><a href="#SelfTraining.__init__-70"><span class="linenos">70</span></a><span class="sd">        References</span>
</span><span id="SelfTraining.__init__-71"><a href="#SelfTraining.__init__-71"><span class="linenos">71</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining.__init__-72"><a href="#SelfTraining.__init__-72"><span class="linenos">72</span></a><span class="sd">        David Yarowsky. 1995. Unsupervised word sense disambiguation rivaling</span>
</span><span id="SelfTraining.__init__-73"><a href="#SelfTraining.__init__-73"><span class="linenos">73</span></a><span class="sd">        supervised methods. In Proceedings of the 33rd annual meeting on</span>
</span><span id="SelfTraining.__init__-74"><a href="#SelfTraining.__init__-74"><span class="linenos">74</span></a><span class="sd">        Association for Computational Linguistics (ACL &#39;95). Association for</span>
</span><span id="SelfTraining.__init__-75"><a href="#SelfTraining.__init__-75"><span class="linenos">75</span></a><span class="sd">        Computational Linguistics, Stroudsburg, PA, USA, 189-196. DOI:</span>
</span><span id="SelfTraining.__init__-76"><a href="#SelfTraining.__init__-76"><span class="linenos">76</span></a><span class="sd">        https://doi.org/10.3115/981658.981684</span>
</span><span id="SelfTraining.__init__-77"><a href="#SelfTraining.__init__-77"><span class="linenos">77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining.__init__-78"><a href="#SelfTraining.__init__-78"><span class="linenos">78</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">k_best</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Self-training. Adaptation of SelfTrainingClassifier from sklearn with data loader compatible.</p>

<p>This class allows a given supervised classifier to function as a
semi-supervised classifier, allowing it to learn from unlabeled data. It
does this by iteratively predicting pseudo-labels for the unlabeled data
and adding them to the training set.</p>

<p>The classifier will continue iterating until either max_iter is reached, or
no pseudo-labels were added to the training set in the previous iteration.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (estimator object):
An estimator object implementing <code><a href="#SelfTraining.fit">fit</a></code> and <code><a href="#SelfTraining.predict_proba">predict_proba</a></code>.
Invoking the <code><a href="#SelfTraining.fit">fit</a></code> method will fit a clone of the passed estimator,
which will be stored in the <code>base_estimator_</code> attribute.</li>
<li><strong>threshold</strong> (float, default=0.75):
The decision threshold for use with <code>criterion='threshold'</code>.
Should be in [0, 1). When using the 'threshold' criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>criterion</strong> ({'threshold', 'k_best'}, default='threshold'):
The selection criterion used to select which labels to add to the
training set. If 'threshold', pseudo-labels with prediction
probabilities above <code>threshold</code> are added to the dataset. If 'k_best',
the <code>k_best</code> pseudo-labels with highest prediction probabilities are
added to the dataset. When using the 'threshold' criterion, a
:ref:<code>well calibrated classifier &lt;calibration&gt;</code> should be used.</li>
<li><strong>k_best</strong> (int, default=10):
The amount of samples to add in each iteration. Only used when
<code>criterion</code> is k_best'.</li>
<li><strong>max_iter</strong> (int or None, default=10):
Maximum number of iterations allowed. Should be greater than or equal
to 0. If it is <code>None</code>, the classifier will continue to predict labels
until no new pseudo-labels are added, or all unlabeled samples have
been labeled.</li>
<li><strong>verbose</strong> (bool, default=False):
Enable verbose output.</li>
</ul>

<h6 id="references">References</h6>

<p>David Yarowsky. 1995. Unsupervised word sense disambiguation rivaling
supervised methods. In Proceedings of the 33rd annual meeting on
Association for Computational Linguistics (ACL '95). Association for
Computational Linguistics, Stroudsburg, PA, USA, 189-196. DOI:
<a href="https://doi.org/10.3115/981658.981684">https://doi.org/10.3115/981658.981684</a></p>
</div>


                            </div>
                            <div id="SelfTraining.fit" class="classattr">
                                        <input id="SelfTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SelfTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SelfTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SelfTraining.fit-80"><a href="#SelfTraining.fit-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="SelfTraining.fit-81"><a href="#SelfTraining.fit-81"><span class="linenos"> 81</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="SelfTraining.fit-82"><a href="#SelfTraining.fit-82"><span class="linenos"> 82</span></a><span class="sd">        Fits this ``SelfTrainingClassifier`` to a dataset.</span>
</span><span id="SelfTraining.fit-83"><a href="#SelfTraining.fit-83"><span class="linenos"> 83</span></a>
</span><span id="SelfTraining.fit-84"><a href="#SelfTraining.fit-84"><span class="linenos"> 84</span></a><span class="sd">        Parameters</span>
</span><span id="SelfTraining.fit-85"><a href="#SelfTraining.fit-85"><span class="linenos"> 85</span></a><span class="sd">        ----------</span>
</span><span id="SelfTraining.fit-86"><a href="#SelfTraining.fit-86"><span class="linenos"> 86</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="SelfTraining.fit-87"><a href="#SelfTraining.fit-87"><span class="linenos"> 87</span></a><span class="sd">            Array representing the data.</span>
</span><span id="SelfTraining.fit-88"><a href="#SelfTraining.fit-88"><span class="linenos"> 88</span></a>
</span><span id="SelfTraining.fit-89"><a href="#SelfTraining.fit-89"><span class="linenos"> 89</span></a><span class="sd">        y : {array-like, sparse matrix} of shape (n_samples,)</span>
</span><span id="SelfTraining.fit-90"><a href="#SelfTraining.fit-90"><span class="linenos"> 90</span></a><span class="sd">            Array representing the labels. Unlabeled samples should have the</span>
</span><span id="SelfTraining.fit-91"><a href="#SelfTraining.fit-91"><span class="linenos"> 91</span></a><span class="sd">            label -1.</span>
</span><span id="SelfTraining.fit-92"><a href="#SelfTraining.fit-92"><span class="linenos"> 92</span></a>
</span><span id="SelfTraining.fit-93"><a href="#SelfTraining.fit-93"><span class="linenos"> 93</span></a><span class="sd">        Returns</span>
</span><span id="SelfTraining.fit-94"><a href="#SelfTraining.fit-94"><span class="linenos"> 94</span></a><span class="sd">        -------</span>
</span><span id="SelfTraining.fit-95"><a href="#SelfTraining.fit-95"><span class="linenos"> 95</span></a><span class="sd">        self : SelfTrainingClassifier</span>
</span><span id="SelfTraining.fit-96"><a href="#SelfTraining.fit-96"><span class="linenos"> 96</span></a><span class="sd">            Returns an instance of self.</span>
</span><span id="SelfTraining.fit-97"><a href="#SelfTraining.fit-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SelfTraining.fit-98"><a href="#SelfTraining.fit-98"><span class="linenos"> 98</span></a>        <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="SelfTraining.fit-99"><a href="#SelfTraining.fit-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
</span><span id="SelfTraining.fit-100"><a href="#SelfTraining.fit-100"><span class="linenos">100</span></a>            <span class="n">y_adapted</span> <span class="o">=</span> <span class="n">y_adapted</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
</span><span id="SelfTraining.fit-101"><a href="#SelfTraining.fit-101"><span class="linenos">101</span></a>            <span class="n">y_adapted</span><span class="p">[</span><span class="n">y_adapted</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="SelfTraining.fit-102"><a href="#SelfTraining.fit-102"><span class="linenos">102</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_adapted</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fits this <code>SelfTrainingClassifier</code> to a dataset.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>y</strong> ({array-like, sparse matrix} of shape (n_samples,)):
Array representing the labels. Unlabeled samples should have the
label -1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (SelfTrainingClassifier):
Returns an instance of self.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.semi_supervised._self_training.SelfTrainingClassifier</dt>
                                <dd id="SelfTraining.predict" class="function">predict</dd>
                <dd id="SelfTraining.predict_proba" class="function">predict_proba</dd>
                <dd id="SelfTraining.decision_function" class="function">decision_function</dd>
                <dd id="SelfTraining.predict_log_proba" class="function">predict_log_proba</dd>
                <dd id="SelfTraining.score" class="function">score</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="SelfTraining.get_params" class="function">get_params</dd>
                <dd id="SelfTraining.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="SelfTraining.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoTrainingByCommittee">
                            <input id="CoTrainingByCommittee-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoTrainingByCommittee</span><wbr>(<span class="base">sklearn.base.ClassifierMixin</span>, <span class="base"><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></span>, <span class="base">sklearn.base.BaseEstimator</span>):

                <label class="view-source-button" for="CoTrainingByCommittee-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee-858"><a href="#CoTrainingByCommittee-858"><span class="linenos"> 858</span></a><span class="k">class</span> <span class="nc">CoTrainingByCommittee</span><span class="p">(</span><span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">BaseEnsemble</span><span class="p">,</span> <span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-859"><a href="#CoTrainingByCommittee-859"><span class="linenos"> 859</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-860"><a href="#CoTrainingByCommittee-860"><span class="linenos"> 860</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-861"><a href="#CoTrainingByCommittee-861"><span class="linenos"> 861</span></a>        <span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">(),</span>
</span><span id="CoTrainingByCommittee-862"><a href="#CoTrainingByCommittee-862"><span class="linenos"> 862</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-863"><a href="#CoTrainingByCommittee-863"><span class="linenos"> 863</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-864"><a href="#CoTrainingByCommittee-864"><span class="linenos"> 864</span></a>        <span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-865"><a href="#CoTrainingByCommittee-865"><span class="linenos"> 865</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-866"><a href="#CoTrainingByCommittee-866"><span class="linenos"> 866</span></a>    <span class="p">):</span>
</span><span id="CoTrainingByCommittee-867"><a href="#CoTrainingByCommittee-867"><span class="linenos"> 867</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-868"><a href="#CoTrainingByCommittee-868"><span class="linenos"> 868</span></a><span class="sd">        Create a committee trained by cotraining based on</span>
</span><span id="CoTrainingByCommittee-869"><a href="#CoTrainingByCommittee-869"><span class="linenos"> 869</span></a><span class="sd">        the diversity of classifiers.</span>
</span><span id="CoTrainingByCommittee-870"><a href="#CoTrainingByCommittee-870"><span class="linenos"> 870</span></a>
</span><span id="CoTrainingByCommittee-871"><a href="#CoTrainingByCommittee-871"><span class="linenos"> 871</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-872"><a href="#CoTrainingByCommittee-872"><span class="linenos"> 872</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-873"><a href="#CoTrainingByCommittee-873"><span class="linenos"> 873</span></a><span class="sd">        ensemble_estimator : ClassifierMixin, optional</span>
</span><span id="CoTrainingByCommittee-874"><a href="#CoTrainingByCommittee-874"><span class="linenos"> 874</span></a><span class="sd">            ensemble method, works without a ensemble as</span>
</span><span id="CoTrainingByCommittee-875"><a href="#CoTrainingByCommittee-875"><span class="linenos"> 875</span></a><span class="sd">            self training with pool, by default BaggingClassifier().</span>
</span><span id="CoTrainingByCommittee-876"><a href="#CoTrainingByCommittee-876"><span class="linenos"> 876</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTrainingByCommittee-877"><a href="#CoTrainingByCommittee-877"><span class="linenos"> 877</span></a><span class="sd">            number of iterations of training, -1 if no max iterations, by default 100</span>
</span><span id="CoTrainingByCommittee-878"><a href="#CoTrainingByCommittee-878"><span class="linenos"> 878</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTrainingByCommittee-879"><a href="#CoTrainingByCommittee-879"><span class="linenos"> 879</span></a><span class="sd">            max number of unlabeled instances candidates to pseudolabel, by default 100</span>
</span><span id="CoTrainingByCommittee-880"><a href="#CoTrainingByCommittee-880"><span class="linenos"> 880</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTrainingByCommittee-881"><a href="#CoTrainingByCommittee-881"><span class="linenos"> 881</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTrainingByCommittee-882"><a href="#CoTrainingByCommittee-882"><span class="linenos"> 882</span></a>
</span><span id="CoTrainingByCommittee-883"><a href="#CoTrainingByCommittee-883"><span class="linenos"> 883</span></a><span class="sd">        References</span>
</span><span id="CoTrainingByCommittee-884"><a href="#CoTrainingByCommittee-884"><span class="linenos"> 884</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-885"><a href="#CoTrainingByCommittee-885"><span class="linenos"> 885</span></a><span class="sd">        M. F. A. Hady and F. Schwenker,</span>
</span><span id="CoTrainingByCommittee-886"><a href="#CoTrainingByCommittee-886"><span class="linenos"> 886</span></a><span class="sd">        &quot;Co-training by Committee: A New Semi-supervised Learning Framework,&quot;</span>
</span><span id="CoTrainingByCommittee-887"><a href="#CoTrainingByCommittee-887"><span class="linenos"> 887</span></a><span class="sd">        2008 IEEE International Conference on Data Mining Workshops,</span>
</span><span id="CoTrainingByCommittee-888"><a href="#CoTrainingByCommittee-888"><span class="linenos"> 888</span></a><span class="sd">        Pisa, 2008, pp. 563-572, doi: 10.1109/ICDMW.2008.27.</span>
</span><span id="CoTrainingByCommittee-889"><a href="#CoTrainingByCommittee-889"><span class="linenos"> 889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-890"><a href="#CoTrainingByCommittee-890"><span class="linenos"> 890</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">ensemble_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-891"><a href="#CoTrainingByCommittee-891"><span class="linenos"> 891</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTrainingByCommittee-892"><a href="#CoTrainingByCommittee-892"><span class="linenos"> 892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTrainingByCommittee-893"><a href="#CoTrainingByCommittee-893"><span class="linenos"> 893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTrainingByCommittee-894"><a href="#CoTrainingByCommittee-894"><span class="linenos"> 894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span> <span class="o">=</span> <span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee-895"><a href="#CoTrainingByCommittee-895"><span class="linenos"> 895</span></a>
</span><span id="CoTrainingByCommittee-896"><a href="#CoTrainingByCommittee-896"><span class="linenos"> 896</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-897"><a href="#CoTrainingByCommittee-897"><span class="linenos"> 897</span></a>        <span class="sd">&quot;&quot;&quot;Build a CoTrainingByCommittee classifier from the training set (X, y).</span>
</span><span id="CoTrainingByCommittee-898"><a href="#CoTrainingByCommittee-898"><span class="linenos"> 898</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-899"><a href="#CoTrainingByCommittee-899"><span class="linenos"> 899</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-900"><a href="#CoTrainingByCommittee-900"><span class="linenos"> 900</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-901"><a href="#CoTrainingByCommittee-901"><span class="linenos"> 901</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoTrainingByCommittee-902"><a href="#CoTrainingByCommittee-902"><span class="linenos"> 902</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee-903"><a href="#CoTrainingByCommittee-903"><span class="linenos"> 903</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoTrainingByCommittee-904"><a href="#CoTrainingByCommittee-904"><span class="linenos"> 904</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-905"><a href="#CoTrainingByCommittee-905"><span class="linenos"> 905</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-906"><a href="#CoTrainingByCommittee-906"><span class="linenos"> 906</span></a><span class="sd">        self : CoTrainingByCommittee</span>
</span><span id="CoTrainingByCommittee-907"><a href="#CoTrainingByCommittee-907"><span class="linenos"> 907</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTrainingByCommittee-908"><a href="#CoTrainingByCommittee-908"><span class="linenos"> 908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-909"><a href="#CoTrainingByCommittee-909"><span class="linenos"> 909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-910"><a href="#CoTrainingByCommittee-910"><span class="linenos"> 910</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-911"><a href="#CoTrainingByCommittee-911"><span class="linenos"> 911</span></a>
</span><span id="CoTrainingByCommittee-912"><a href="#CoTrainingByCommittee-912"><span class="linenos"> 912</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_prev</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-913"><a href="#CoTrainingByCommittee-913"><span class="linenos"> 913</span></a>
</span><span id="CoTrainingByCommittee-914"><a href="#CoTrainingByCommittee-914"><span class="linenos"> 914</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-915"><a href="#CoTrainingByCommittee-915"><span class="linenos"> 915</span></a>
</span><span id="CoTrainingByCommittee-916"><a href="#CoTrainingByCommittee-916"><span class="linenos"> 916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="CoTrainingByCommittee-917"><a href="#CoTrainingByCommittee-917"><span class="linenos"> 917</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_prev</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-918"><a href="#CoTrainingByCommittee-918"><span class="linenos"> 918</span></a>
</span><span id="CoTrainingByCommittee-919"><a href="#CoTrainingByCommittee-919"><span class="linenos"> 919</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span>
</span><span id="CoTrainingByCommittee-920"><a href="#CoTrainingByCommittee-920"><span class="linenos"> 920</span></a>
</span><span id="CoTrainingByCommittee-921"><a href="#CoTrainingByCommittee-921"><span class="linenos"> 921</span></a>        <span class="n">prior</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-922"><a href="#CoTrainingByCommittee-922"><span class="linenos"> 922</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee-923"><a href="#CoTrainingByCommittee-923"><span class="linenos"> 923</span></a>
</span><span id="CoTrainingByCommittee-924"><a href="#CoTrainingByCommittee-924"><span class="linenos"> 924</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-925"><a href="#CoTrainingByCommittee-925"><span class="linenos"> 925</span></a>
</span><span id="CoTrainingByCommittee-926"><a href="#CoTrainingByCommittee-926"><span class="linenos"> 926</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-927"><a href="#CoTrainingByCommittee-927"><span class="linenos"> 927</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee-928"><a href="#CoTrainingByCommittee-928"><span class="linenos"> 928</span></a>
</span><span id="CoTrainingByCommittee-929"><a href="#CoTrainingByCommittee-929"><span class="linenos"> 929</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-930"><a href="#CoTrainingByCommittee-930"><span class="linenos"> 930</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-931"><a href="#CoTrainingByCommittee-931"><span class="linenos"> 931</span></a>                <span class="k">break</span>
</span><span id="CoTrainingByCommittee-932"><a href="#CoTrainingByCommittee-932"><span class="linenos"> 932</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-933"><a href="#CoTrainingByCommittee-933"><span class="linenos"> 933</span></a>                <span class="n">X_unlabel</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span>
</span><span id="CoTrainingByCommittee-934"><a href="#CoTrainingByCommittee-934"><span class="linenos"> 934</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-935"><a href="#CoTrainingByCommittee-935"><span class="linenos"> 935</span></a>
</span><span id="CoTrainingByCommittee-936"><a href="#CoTrainingByCommittee-936"><span class="linenos"> 936</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-937"><a href="#CoTrainingByCommittee-937"><span class="linenos"> 937</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-938"><a href="#CoTrainingByCommittee-938"><span class="linenos"> 938</span></a>
</span><span id="CoTrainingByCommittee-939"><a href="#CoTrainingByCommittee-939"><span class="linenos"> 939</span></a>            <span class="n">added</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-940"><a href="#CoTrainingByCommittee-940"><span class="linenos"> 940</span></a>            <span class="c1"># First the n (or less) most confidence instances will be selected</span>
</span><span id="CoTrainingByCommittee-941"><a href="#CoTrainingByCommittee-941"><span class="linenos"> 941</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-942"><a href="#CoTrainingByCommittee-942"><span class="linenos"> 942</span></a>                <span class="n">condition</span> <span class="o">=</span> <span class="n">class_predicted</span> <span class="o">==</span> <span class="n">c</span>
</span><span id="CoTrainingByCommittee-943"><a href="#CoTrainingByCommittee-943"><span class="linenos"> 943</span></a>
</span><span id="CoTrainingByCommittee-944"><a href="#CoTrainingByCommittee-944"><span class="linenos"> 944</span></a>                <span class="n">candidates</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-945"><a href="#CoTrainingByCommittee-945"><span class="linenos"> 945</span></a>                <span class="n">candidates_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-946"><a href="#CoTrainingByCommittee-946"><span class="linenos"> 946</span></a>                <span class="n">candidates_sub_set</span> <span class="o">=</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-947"><a href="#CoTrainingByCommittee-947"><span class="linenos"> 947</span></a>
</span><span id="CoTrainingByCommittee-948"><a href="#CoTrainingByCommittee-948"><span class="linenos"> 948</span></a>                <span class="n">instances_index_selected</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[</span>
</span><span id="CoTrainingByCommittee-949"><a href="#CoTrainingByCommittee-949"><span class="linenos"> 949</span></a>                    <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-950"><a href="#CoTrainingByCommittee-950"><span class="linenos"> 950</span></a>                <span class="p">]</span>
</span><span id="CoTrainingByCommittee-951"><a href="#CoTrainingByCommittee-951"><span class="linenos"> 951</span></a>
</span><span id="CoTrainingByCommittee-952"><a href="#CoTrainingByCommittee-952"><span class="linenos"> 952</span></a>                <span class="n">candidates_sub_set</span><span class="p">[</span><span class="n">instances_index_selected</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-953"><a href="#CoTrainingByCommittee-953"><span class="linenos"> 953</span></a>                <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span> <span class="o">+=</span> <span class="n">candidates_sub_set</span>
</span><span id="CoTrainingByCommittee-954"><a href="#CoTrainingByCommittee-954"><span class="linenos"> 954</span></a>
</span><span id="CoTrainingByCommittee-955"><a href="#CoTrainingByCommittee-955"><span class="linenos"> 955</span></a>                <span class="n">added</span><span class="p">[</span><span class="n">candidates_bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-956"><a href="#CoTrainingByCommittee-956"><span class="linenos"> 956</span></a>
</span><span id="CoTrainingByCommittee-957"><a href="#CoTrainingByCommittee-957"><span class="linenos"> 957</span></a>            <span class="c1"># Bajo esta interpretación se garantiza que al menos existen n elemento de cada clase por iteración</span>
</span><span id="CoTrainingByCommittee-958"><a href="#CoTrainingByCommittee-958"><span class="linenos"> 958</span></a>            <span class="c1"># Pero si se añaden ya en el proceso de proporción no se duplica.</span>
</span><span id="CoTrainingByCommittee-959"><a href="#CoTrainingByCommittee-959"><span class="linenos"> 959</span></a>
</span><span id="CoTrainingByCommittee-960"><a href="#CoTrainingByCommittee-960"><span class="linenos"> 960</span></a>            <span class="c1"># Con esta otra interpretación ignora las n primeras instancias de cada clase</span>
</span><span id="CoTrainingByCommittee-961"><a href="#CoTrainingByCommittee-961"><span class="linenos"> 961</span></a>            <span class="n">to_label</span> <span class="o">=</span> <span class="n">choice_with_proportion</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-962"><a href="#CoTrainingByCommittee-962"><span class="linenos"> 962</span></a>                <span class="n">predictions</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee-963"><a href="#CoTrainingByCommittee-963"><span class="linenos"> 963</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-964"><a href="#CoTrainingByCommittee-964"><span class="linenos"> 964</span></a>            <span class="n">added</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee-965"><a href="#CoTrainingByCommittee-965"><span class="linenos"> 965</span></a>
</span><span id="CoTrainingByCommittee-966"><a href="#CoTrainingByCommittee-966"><span class="linenos"> 966</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-967"><a href="#CoTrainingByCommittee-967"><span class="linenos"> 967</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-968"><a href="#CoTrainingByCommittee-968"><span class="linenos"> 968</span></a>                <span class="p">[</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]]</span>
</span><span id="CoTrainingByCommittee-969"><a href="#CoTrainingByCommittee-969"><span class="linenos"> 969</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee-970"><a href="#CoTrainingByCommittee-970"><span class="linenos"> 970</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee-971"><a href="#CoTrainingByCommittee-971"><span class="linenos"> 971</span></a>
</span><span id="CoTrainingByCommittee-972"><a href="#CoTrainingByCommittee-972"><span class="linenos"> 972</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-973"><a href="#CoTrainingByCommittee-973"><span class="linenos"> 973</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTrainingByCommittee-974"><a href="#CoTrainingByCommittee-974"><span class="linenos"> 974</span></a>
</span><span id="CoTrainingByCommittee-975"><a href="#CoTrainingByCommittee-975"><span class="linenos"> 975</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-976"><a href="#CoTrainingByCommittee-976"><span class="linenos"> 976</span></a>
</span><span id="CoTrainingByCommittee-977"><a href="#CoTrainingByCommittee-977"><span class="linenos"> 977</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee-978"><a href="#CoTrainingByCommittee-978"><span class="linenos"> 978</span></a>
</span><span id="CoTrainingByCommittee-979"><a href="#CoTrainingByCommittee-979"><span class="linenos"> 979</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-980"><a href="#CoTrainingByCommittee-980"><span class="linenos"> 980</span></a>        <span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="CoTrainingByCommittee-981"><a href="#CoTrainingByCommittee-981"><span class="linenos"> 981</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="CoTrainingByCommittee-982"><a href="#CoTrainingByCommittee-982"><span class="linenos"> 982</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-983"><a href="#CoTrainingByCommittee-983"><span class="linenos"> 983</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-984"><a href="#CoTrainingByCommittee-984"><span class="linenos"> 984</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-985"><a href="#CoTrainingByCommittee-985"><span class="linenos"> 985</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee-986"><a href="#CoTrainingByCommittee-986"><span class="linenos"> 986</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-987"><a href="#CoTrainingByCommittee-987"><span class="linenos"> 987</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-988"><a href="#CoTrainingByCommittee-988"><span class="linenos"> 988</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee-989"><a href="#CoTrainingByCommittee-989"><span class="linenos"> 989</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee-990"><a href="#CoTrainingByCommittee-990"><span class="linenos"> 990</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-991"><a href="#CoTrainingByCommittee-991"><span class="linenos"> 991</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-992"><a href="#CoTrainingByCommittee-992"><span class="linenos"> 992</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee-993"><a href="#CoTrainingByCommittee-993"><span class="linenos"> 993</span></a>
</span><span id="CoTrainingByCommittee-994"><a href="#CoTrainingByCommittee-994"><span class="linenos"> 994</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-995"><a href="#CoTrainingByCommittee-995"><span class="linenos"> 995</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="CoTrainingByCommittee-996"><a href="#CoTrainingByCommittee-996"><span class="linenos"> 996</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="CoTrainingByCommittee-997"><a href="#CoTrainingByCommittee-997"><span class="linenos"> 997</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-998"><a href="#CoTrainingByCommittee-998"><span class="linenos"> 998</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-999"><a href="#CoTrainingByCommittee-999"><span class="linenos"> 999</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1000"><a href="#CoTrainingByCommittee-1000"><span class="linenos">1000</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee-1001"><a href="#CoTrainingByCommittee-1001"><span class="linenos">1001</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1002"><a href="#CoTrainingByCommittee-1002"><span class="linenos">1002</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1003"><a href="#CoTrainingByCommittee-1003"><span class="linenos">1003</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="CoTrainingByCommittee-1004"><a href="#CoTrainingByCommittee-1004"><span class="linenos">1004</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee-1005"><a href="#CoTrainingByCommittee-1005"><span class="linenos">1005</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1006"><a href="#CoTrainingByCommittee-1006"><span class="linenos">1006</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1007"><a href="#CoTrainingByCommittee-1007"><span class="linenos">1007</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1008"><a href="#CoTrainingByCommittee-1008"><span class="linenos">1008</span></a>
</span><span id="CoTrainingByCommittee-1009"><a href="#CoTrainingByCommittee-1009"><span class="linenos">1009</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1010"><a href="#CoTrainingByCommittee-1010"><span class="linenos">1010</span></a>        <span class="sd">&quot;&quot;&quot;Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTrainingByCommittee-1011"><a href="#CoTrainingByCommittee-1011"><span class="linenos">1011</span></a><span class="sd">        In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</span>
</span><span id="CoTrainingByCommittee-1012"><a href="#CoTrainingByCommittee-1012"><span class="linenos">1012</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee-1013"><a href="#CoTrainingByCommittee-1013"><span class="linenos">1013</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee-1014"><a href="#CoTrainingByCommittee-1014"><span class="linenos">1014</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee-1015"><a href="#CoTrainingByCommittee-1015"><span class="linenos">1015</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTrainingByCommittee-1016"><a href="#CoTrainingByCommittee-1016"><span class="linenos">1016</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTrainingByCommittee-1017"><a href="#CoTrainingByCommittee-1017"><span class="linenos">1017</span></a><span class="sd">            True labels for X.</span>
</span><span id="CoTrainingByCommittee-1018"><a href="#CoTrainingByCommittee-1018"><span class="linenos">1018</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), optional</span>
</span><span id="CoTrainingByCommittee-1019"><a href="#CoTrainingByCommittee-1019"><span class="linenos">1019</span></a><span class="sd">            Sample weights., by default None</span>
</span><span id="CoTrainingByCommittee-1020"><a href="#CoTrainingByCommittee-1020"><span class="linenos">1020</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee-1021"><a href="#CoTrainingByCommittee-1021"><span class="linenos">1021</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee-1022"><a href="#CoTrainingByCommittee-1022"><span class="linenos">1022</span></a><span class="sd">        score: float</span>
</span><span id="CoTrainingByCommittee-1023"><a href="#CoTrainingByCommittee-1023"><span class="linenos">1023</span></a><span class="sd">            Mean accuracy of self.predict(X) wrt. y.</span>
</span><span id="CoTrainingByCommittee-1024"><a href="#CoTrainingByCommittee-1024"><span class="linenos">1024</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee-1025"><a href="#CoTrainingByCommittee-1025"><span class="linenos">1025</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1026"><a href="#CoTrainingByCommittee-1026"><span class="linenos">1026</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1027"><a href="#CoTrainingByCommittee-1027"><span class="linenos">1027</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee-1028"><a href="#CoTrainingByCommittee-1028"><span class="linenos">1028</span></a>            <span class="k">if</span> <span class="s2">&quot;le_dict_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee-1029"><a href="#CoTrainingByCommittee-1029"><span class="linenos">1029</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1030"><a href="#CoTrainingByCommittee-1030"><span class="linenos">1030</span></a>                    <span class="nb">zip</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee-1031"><a href="#CoTrainingByCommittee-1031"><span class="linenos">1031</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee-1032"><a href="#CoTrainingByCommittee-1032"><span class="linenos">1032</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span>
</span><span id="CoTrainingByCommittee-1033"><a href="#CoTrainingByCommittee-1033"><span class="linenos">1033</span></a>                    <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1034"><a href="#CoTrainingByCommittee-1034"><span class="linenos">1034</span></a>                <span class="p">)</span>
</span><span id="CoTrainingByCommittee-1035"><a href="#CoTrainingByCommittee-1035"><span class="linenos">1035</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee-1036"><a href="#CoTrainingByCommittee-1036"><span class="linenos">1036</span></a>
</span><span id="CoTrainingByCommittee-1037"><a href="#CoTrainingByCommittee-1037"><span class="linenos">1037</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Mixin class for all classifiers in scikit-learn.</p>
</div>


                            <div id="CoTrainingByCommittee.__init__" class="classattr">
                                        <input id="CoTrainingByCommittee.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoTrainingByCommittee</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CoTrainingByCommittee.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.__init__-859"><a href="#CoTrainingByCommittee.__init__-859"><span class="linenos">859</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.__init__-860"><a href="#CoTrainingByCommittee.__init__-860"><span class="linenos">860</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-861"><a href="#CoTrainingByCommittee.__init__-861"><span class="linenos">861</span></a>        <span class="n">ensemble_estimator</span><span class="o">=</span><span class="n">BaggingClassifier</span><span class="p">(),</span>
</span><span id="CoTrainingByCommittee.__init__-862"><a href="#CoTrainingByCommittee.__init__-862"><span class="linenos">862</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-863"><a href="#CoTrainingByCommittee.__init__-863"><span class="linenos">863</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-864"><a href="#CoTrainingByCommittee.__init__-864"><span class="linenos">864</span></a>        <span class="n">min_instances_for_class</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-865"><a href="#CoTrainingByCommittee.__init__-865"><span class="linenos">865</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.__init__-866"><a href="#CoTrainingByCommittee.__init__-866"><span class="linenos">866</span></a>    <span class="p">):</span>
</span><span id="CoTrainingByCommittee.__init__-867"><a href="#CoTrainingByCommittee.__init__-867"><span class="linenos">867</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.__init__-868"><a href="#CoTrainingByCommittee.__init__-868"><span class="linenos">868</span></a><span class="sd">        Create a committee trained by cotraining based on</span>
</span><span id="CoTrainingByCommittee.__init__-869"><a href="#CoTrainingByCommittee.__init__-869"><span class="linenos">869</span></a><span class="sd">        the diversity of classifiers.</span>
</span><span id="CoTrainingByCommittee.__init__-870"><a href="#CoTrainingByCommittee.__init__-870"><span class="linenos">870</span></a>
</span><span id="CoTrainingByCommittee.__init__-871"><a href="#CoTrainingByCommittee.__init__-871"><span class="linenos">871</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.__init__-872"><a href="#CoTrainingByCommittee.__init__-872"><span class="linenos">872</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.__init__-873"><a href="#CoTrainingByCommittee.__init__-873"><span class="linenos">873</span></a><span class="sd">        ensemble_estimator : ClassifierMixin, optional</span>
</span><span id="CoTrainingByCommittee.__init__-874"><a href="#CoTrainingByCommittee.__init__-874"><span class="linenos">874</span></a><span class="sd">            ensemble method, works without a ensemble as</span>
</span><span id="CoTrainingByCommittee.__init__-875"><a href="#CoTrainingByCommittee.__init__-875"><span class="linenos">875</span></a><span class="sd">            self training with pool, by default BaggingClassifier().</span>
</span><span id="CoTrainingByCommittee.__init__-876"><a href="#CoTrainingByCommittee.__init__-876"><span class="linenos">876</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTrainingByCommittee.__init__-877"><a href="#CoTrainingByCommittee.__init__-877"><span class="linenos">877</span></a><span class="sd">            number of iterations of training, -1 if no max iterations, by default 100</span>
</span><span id="CoTrainingByCommittee.__init__-878"><a href="#CoTrainingByCommittee.__init__-878"><span class="linenos">878</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTrainingByCommittee.__init__-879"><a href="#CoTrainingByCommittee.__init__-879"><span class="linenos">879</span></a><span class="sd">            max number of unlabeled instances candidates to pseudolabel, by default 100</span>
</span><span id="CoTrainingByCommittee.__init__-880"><a href="#CoTrainingByCommittee.__init__-880"><span class="linenos">880</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTrainingByCommittee.__init__-881"><a href="#CoTrainingByCommittee.__init__-881"><span class="linenos">881</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTrainingByCommittee.__init__-882"><a href="#CoTrainingByCommittee.__init__-882"><span class="linenos">882</span></a>
</span><span id="CoTrainingByCommittee.__init__-883"><a href="#CoTrainingByCommittee.__init__-883"><span class="linenos">883</span></a><span class="sd">        References</span>
</span><span id="CoTrainingByCommittee.__init__-884"><a href="#CoTrainingByCommittee.__init__-884"><span class="linenos">884</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.__init__-885"><a href="#CoTrainingByCommittee.__init__-885"><span class="linenos">885</span></a><span class="sd">        M. F. A. Hady and F. Schwenker,</span>
</span><span id="CoTrainingByCommittee.__init__-886"><a href="#CoTrainingByCommittee.__init__-886"><span class="linenos">886</span></a><span class="sd">        &quot;Co-training by Committee: A New Semi-supervised Learning Framework,&quot;</span>
</span><span id="CoTrainingByCommittee.__init__-887"><a href="#CoTrainingByCommittee.__init__-887"><span class="linenos">887</span></a><span class="sd">        2008 IEEE International Conference on Data Mining Workshops,</span>
</span><span id="CoTrainingByCommittee.__init__-888"><a href="#CoTrainingByCommittee.__init__-888"><span class="linenos">888</span></a><span class="sd">        Pisa, 2008, pp. 563-572, doi: 10.1109/ICDMW.2008.27.</span>
</span><span id="CoTrainingByCommittee.__init__-889"><a href="#CoTrainingByCommittee.__init__-889"><span class="linenos">889</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.__init__-890"><a href="#CoTrainingByCommittee.__init__-890"><span class="linenos">890</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">ensemble_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.__init__-891"><a href="#CoTrainingByCommittee.__init__-891"><span class="linenos">891</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTrainingByCommittee.__init__-892"><a href="#CoTrainingByCommittee.__init__-892"><span class="linenos">892</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTrainingByCommittee.__init__-893"><a href="#CoTrainingByCommittee.__init__-893"><span class="linenos">893</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTrainingByCommittee.__init__-894"><a href="#CoTrainingByCommittee.__init__-894"><span class="linenos">894</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span> <span class="o">=</span> <span class="n">min_instances_for_class</span>
</span></pre></div>


            <div class="docstring"><p>Create a committee trained by cotraining based on
the diversity of classifiers.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ensemble_estimator</strong> (ClassifierMixin, optional):
ensemble method, works without a ensemble as
self training with pool, by default BaggingClassifier().</li>
<li><strong>max_iterations</strong> (int, optional):
number of iterations of training, -1 if no max iterations, by default 100</li>
<li><strong>poolsize</strong> (int, optional):
max number of unlabeled instances candidates to pseudolabel, by default 100</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>M. F. A. Hady and F. Schwenker,
"Co-training by Committee: A New Semi-supervised Learning Framework,"
2008 IEEE International Conference on Data Mining Workshops,
Pisa, 2008, pp. 563-572, doi: 10.1109/ICDMW.2008.27.</p>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.fit" class="classattr">
                                        <input id="CoTrainingByCommittee.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.fit-896"><a href="#CoTrainingByCommittee.fit-896"><span class="linenos">896</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.fit-897"><a href="#CoTrainingByCommittee.fit-897"><span class="linenos">897</span></a>        <span class="sd">&quot;&quot;&quot;Build a CoTrainingByCommittee classifier from the training set (X, y).</span>
</span><span id="CoTrainingByCommittee.fit-898"><a href="#CoTrainingByCommittee.fit-898"><span class="linenos">898</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.fit-899"><a href="#CoTrainingByCommittee.fit-899"><span class="linenos">899</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.fit-900"><a href="#CoTrainingByCommittee.fit-900"><span class="linenos">900</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.fit-901"><a href="#CoTrainingByCommittee.fit-901"><span class="linenos">901</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoTrainingByCommittee.fit-902"><a href="#CoTrainingByCommittee.fit-902"><span class="linenos">902</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee.fit-903"><a href="#CoTrainingByCommittee.fit-903"><span class="linenos">903</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoTrainingByCommittee.fit-904"><a href="#CoTrainingByCommittee.fit-904"><span class="linenos">904</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.fit-905"><a href="#CoTrainingByCommittee.fit-905"><span class="linenos">905</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.fit-906"><a href="#CoTrainingByCommittee.fit-906"><span class="linenos">906</span></a><span class="sd">        self : CoTrainingByCommittee</span>
</span><span id="CoTrainingByCommittee.fit-907"><a href="#CoTrainingByCommittee.fit-907"><span class="linenos">907</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTrainingByCommittee.fit-908"><a href="#CoTrainingByCommittee.fit-908"><span class="linenos">908</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.fit-909"><a href="#CoTrainingByCommittee.fit-909"><span class="linenos">909</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-910"><a href="#CoTrainingByCommittee.fit-910"><span class="linenos">910</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-911"><a href="#CoTrainingByCommittee.fit-911"><span class="linenos">911</span></a>
</span><span id="CoTrainingByCommittee.fit-912"><a href="#CoTrainingByCommittee.fit-912"><span class="linenos">912</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_prev</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-913"><a href="#CoTrainingByCommittee.fit-913"><span class="linenos">913</span></a>
</span><span id="CoTrainingByCommittee.fit-914"><a href="#CoTrainingByCommittee.fit-914"><span class="linenos">914</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-915"><a href="#CoTrainingByCommittee.fit-915"><span class="linenos">915</span></a>
</span><span id="CoTrainingByCommittee.fit-916"><a href="#CoTrainingByCommittee.fit-916"><span class="linenos">916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="CoTrainingByCommittee.fit-917"><a href="#CoTrainingByCommittee.fit-917"><span class="linenos">917</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_prev</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-918"><a href="#CoTrainingByCommittee.fit-918"><span class="linenos">918</span></a>
</span><span id="CoTrainingByCommittee.fit-919"><a href="#CoTrainingByCommittee.fit-919"><span class="linenos">919</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span>
</span><span id="CoTrainingByCommittee.fit-920"><a href="#CoTrainingByCommittee.fit-920"><span class="linenos">920</span></a>
</span><span id="CoTrainingByCommittee.fit-921"><a href="#CoTrainingByCommittee.fit-921"><span class="linenos">921</span></a>        <span class="n">prior</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-922"><a href="#CoTrainingByCommittee.fit-922"><span class="linenos">922</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTrainingByCommittee.fit-923"><a href="#CoTrainingByCommittee.fit-923"><span class="linenos">923</span></a>
</span><span id="CoTrainingByCommittee.fit-924"><a href="#CoTrainingByCommittee.fit-924"><span class="linenos">924</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-925"><a href="#CoTrainingByCommittee.fit-925"><span class="linenos">925</span></a>
</span><span id="CoTrainingByCommittee.fit-926"><a href="#CoTrainingByCommittee.fit-926"><span class="linenos">926</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-927"><a href="#CoTrainingByCommittee.fit-927"><span class="linenos">927</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTrainingByCommittee.fit-928"><a href="#CoTrainingByCommittee.fit-928"><span class="linenos">928</span></a>
</span><span id="CoTrainingByCommittee.fit-929"><a href="#CoTrainingByCommittee.fit-929"><span class="linenos">929</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.fit-930"><a href="#CoTrainingByCommittee.fit-930"><span class="linenos">930</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">permutation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-931"><a href="#CoTrainingByCommittee.fit-931"><span class="linenos">931</span></a>                <span class="k">break</span>
</span><span id="CoTrainingByCommittee.fit-932"><a href="#CoTrainingByCommittee.fit-932"><span class="linenos">932</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-933"><a href="#CoTrainingByCommittee.fit-933"><span class="linenos">933</span></a>                <span class="n">X_unlabel</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]]</span>
</span><span id="CoTrainingByCommittee.fit-934"><a href="#CoTrainingByCommittee.fit-934"><span class="linenos">934</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-935"><a href="#CoTrainingByCommittee.fit-935"><span class="linenos">935</span></a>
</span><span id="CoTrainingByCommittee.fit-936"><a href="#CoTrainingByCommittee.fit-936"><span class="linenos">936</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-937"><a href="#CoTrainingByCommittee.fit-937"><span class="linenos">937</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-938"><a href="#CoTrainingByCommittee.fit-938"><span class="linenos">938</span></a>
</span><span id="CoTrainingByCommittee.fit-939"><a href="#CoTrainingByCommittee.fit-939"><span class="linenos">939</span></a>            <span class="n">added</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-940"><a href="#CoTrainingByCommittee.fit-940"><span class="linenos">940</span></a>            <span class="c1"># First the n (or less) most confidence instances will be selected</span>
</span><span id="CoTrainingByCommittee.fit-941"><a href="#CoTrainingByCommittee.fit-941"><span class="linenos">941</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-942"><a href="#CoTrainingByCommittee.fit-942"><span class="linenos">942</span></a>                <span class="n">condition</span> <span class="o">=</span> <span class="n">class_predicted</span> <span class="o">==</span> <span class="n">c</span>
</span><span id="CoTrainingByCommittee.fit-943"><a href="#CoTrainingByCommittee.fit-943"><span class="linenos">943</span></a>
</span><span id="CoTrainingByCommittee.fit-944"><a href="#CoTrainingByCommittee.fit-944"><span class="linenos">944</span></a>                <span class="n">candidates</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-945"><a href="#CoTrainingByCommittee.fit-945"><span class="linenos">945</span></a>                <span class="n">candidates_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-946"><a href="#CoTrainingByCommittee.fit-946"><span class="linenos">946</span></a>                <span class="n">candidates_sub_set</span> <span class="o">=</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-947"><a href="#CoTrainingByCommittee.fit-947"><span class="linenos">947</span></a>
</span><span id="CoTrainingByCommittee.fit-948"><a href="#CoTrainingByCommittee.fit-948"><span class="linenos">948</span></a>                <span class="n">instances_index_selected</span> <span class="o">=</span> <span class="n">candidates</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[</span>
</span><span id="CoTrainingByCommittee.fit-949"><a href="#CoTrainingByCommittee.fit-949"><span class="linenos">949</span></a>                    <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.fit-950"><a href="#CoTrainingByCommittee.fit-950"><span class="linenos">950</span></a>                <span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-951"><a href="#CoTrainingByCommittee.fit-951"><span class="linenos">951</span></a>
</span><span id="CoTrainingByCommittee.fit-952"><a href="#CoTrainingByCommittee.fit-952"><span class="linenos">952</span></a>                <span class="n">candidates_sub_set</span><span class="p">[</span><span class="n">instances_index_selected</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-953"><a href="#CoTrainingByCommittee.fit-953"><span class="linenos">953</span></a>                <span class="n">candidates_bool</span><span class="p">[</span><span class="n">condition</span><span class="p">]</span> <span class="o">+=</span> <span class="n">candidates_sub_set</span>
</span><span id="CoTrainingByCommittee.fit-954"><a href="#CoTrainingByCommittee.fit-954"><span class="linenos">954</span></a>
</span><span id="CoTrainingByCommittee.fit-955"><a href="#CoTrainingByCommittee.fit-955"><span class="linenos">955</span></a>                <span class="n">added</span><span class="p">[</span><span class="n">candidates_bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-956"><a href="#CoTrainingByCommittee.fit-956"><span class="linenos">956</span></a>
</span><span id="CoTrainingByCommittee.fit-957"><a href="#CoTrainingByCommittee.fit-957"><span class="linenos">957</span></a>            <span class="c1"># Bajo esta interpretación se garantiza que al menos existen n elemento de cada clase por iteración</span>
</span><span id="CoTrainingByCommittee.fit-958"><a href="#CoTrainingByCommittee.fit-958"><span class="linenos">958</span></a>            <span class="c1"># Pero si se añaden ya en el proceso de proporción no se duplica.</span>
</span><span id="CoTrainingByCommittee.fit-959"><a href="#CoTrainingByCommittee.fit-959"><span class="linenos">959</span></a>
</span><span id="CoTrainingByCommittee.fit-960"><a href="#CoTrainingByCommittee.fit-960"><span class="linenos">960</span></a>            <span class="c1"># Con esta otra interpretación ignora las n primeras instancias de cada clase</span>
</span><span id="CoTrainingByCommittee.fit-961"><a href="#CoTrainingByCommittee.fit-961"><span class="linenos">961</span></a>            <span class="n">to_label</span> <span class="o">=</span> <span class="n">choice_with_proportion</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-962"><a href="#CoTrainingByCommittee.fit-962"><span class="linenos">962</span></a>                <span class="n">predictions</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_instances_for_class</span>
</span><span id="CoTrainingByCommittee.fit-963"><a href="#CoTrainingByCommittee.fit-963"><span class="linenos">963</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-964"><a href="#CoTrainingByCommittee.fit-964"><span class="linenos">964</span></a>            <span class="n">added</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoTrainingByCommittee.fit-965"><a href="#CoTrainingByCommittee.fit-965"><span class="linenos">965</span></a>
</span><span id="CoTrainingByCommittee.fit-966"><a href="#CoTrainingByCommittee.fit-966"><span class="linenos">966</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-967"><a href="#CoTrainingByCommittee.fit-967"><span class="linenos">967</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.fit-968"><a href="#CoTrainingByCommittee.fit-968"><span class="linenos">968</span></a>                <span class="p">[</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]]</span>
</span><span id="CoTrainingByCommittee.fit-969"><a href="#CoTrainingByCommittee.fit-969"><span class="linenos">969</span></a>            <span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-970"><a href="#CoTrainingByCommittee.fit-970"><span class="linenos">970</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">added</span><span class="p">]</span>
</span><span id="CoTrainingByCommittee.fit-971"><a href="#CoTrainingByCommittee.fit-971"><span class="linenos">971</span></a>
</span><span id="CoTrainingByCommittee.fit-972"><a href="#CoTrainingByCommittee.fit-972"><span class="linenos">972</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-973"><a href="#CoTrainingByCommittee.fit-973"><span class="linenos">973</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTrainingByCommittee.fit-974"><a href="#CoTrainingByCommittee.fit-974"><span class="linenos">974</span></a>
</span><span id="CoTrainingByCommittee.fit-975"><a href="#CoTrainingByCommittee.fit-975"><span class="linenos">975</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.fit-976"><a href="#CoTrainingByCommittee.fit-976"><span class="linenos">976</span></a>
</span><span id="CoTrainingByCommittee.fit-977"><a href="#CoTrainingByCommittee.fit-977"><span class="linenos">977</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoTrainingByCommittee classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoTrainingByCommittee):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.predict" class="classattr">
                                        <input id="CoTrainingByCommittee.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.predict-979"><a href="#CoTrainingByCommittee.predict-979"><span class="linenos">979</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.predict-980"><a href="#CoTrainingByCommittee.predict-980"><span class="linenos">980</span></a>        <span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="CoTrainingByCommittee.predict-981"><a href="#CoTrainingByCommittee.predict-981"><span class="linenos">981</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="CoTrainingByCommittee.predict-982"><a href="#CoTrainingByCommittee.predict-982"><span class="linenos">982</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.predict-983"><a href="#CoTrainingByCommittee.predict-983"><span class="linenos">983</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.predict-984"><a href="#CoTrainingByCommittee.predict-984"><span class="linenos">984</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.predict-985"><a href="#CoTrainingByCommittee.predict-985"><span class="linenos">985</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee.predict-986"><a href="#CoTrainingByCommittee.predict-986"><span class="linenos">986</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.predict-987"><a href="#CoTrainingByCommittee.predict-987"><span class="linenos">987</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.predict-988"><a href="#CoTrainingByCommittee.predict-988"><span class="linenos">988</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTrainingByCommittee.predict-989"><a href="#CoTrainingByCommittee.predict-989"><span class="linenos">989</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee.predict-990"><a href="#CoTrainingByCommittee.predict-990"><span class="linenos">990</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.predict-991"><a href="#CoTrainingByCommittee.predict-991"><span class="linenos">991</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.predict-992"><a href="#CoTrainingByCommittee.predict-992"><span class="linenos">992</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Predict class value for X.
For a classification model, the predicted class for each sample in X is returned.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.predict_proba" class="classattr">
                                        <input id="CoTrainingByCommittee.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.predict_proba-994"><a href="#CoTrainingByCommittee.predict_proba-994"><span class="linenos"> 994</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.predict_proba-995"><a href="#CoTrainingByCommittee.predict_proba-995"><span class="linenos"> 995</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="CoTrainingByCommittee.predict_proba-996"><a href="#CoTrainingByCommittee.predict_proba-996"><span class="linenos"> 996</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="CoTrainingByCommittee.predict_proba-997"><a href="#CoTrainingByCommittee.predict_proba-997"><span class="linenos"> 997</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.predict_proba-998"><a href="#CoTrainingByCommittee.predict_proba-998"><span class="linenos"> 998</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.predict_proba-999"><a href="#CoTrainingByCommittee.predict_proba-999"><span class="linenos"> 999</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.predict_proba-1000"><a href="#CoTrainingByCommittee.predict_proba-1000"><span class="linenos">1000</span></a><span class="sd">            The input samples.</span>
</span><span id="CoTrainingByCommittee.predict_proba-1001"><a href="#CoTrainingByCommittee.predict_proba-1001"><span class="linenos">1001</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.predict_proba-1002"><a href="#CoTrainingByCommittee.predict_proba-1002"><span class="linenos">1002</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.predict_proba-1003"><a href="#CoTrainingByCommittee.predict_proba-1003"><span class="linenos">1003</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="CoTrainingByCommittee.predict_proba-1004"><a href="#CoTrainingByCommittee.predict_proba-1004"><span class="linenos">1004</span></a><span class="sd">            The predicted classes</span>
</span><span id="CoTrainingByCommittee.predict_proba-1005"><a href="#CoTrainingByCommittee.predict_proba-1005"><span class="linenos">1005</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.predict_proba-1006"><a href="#CoTrainingByCommittee.predict_proba-1006"><span class="linenos">1006</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.predict_proba-1007"><a href="#CoTrainingByCommittee.predict_proba-1007"><span class="linenos">1007</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class probabilities of the input samples X.
The predicted class probability depends on the ensemble estimator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.score" class="classattr">
                                        <input id="CoTrainingByCommittee.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTrainingByCommittee.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTrainingByCommittee.score-1009"><a href="#CoTrainingByCommittee.score-1009"><span class="linenos">1009</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.score-1010"><a href="#CoTrainingByCommittee.score-1010"><span class="linenos">1010</span></a>        <span class="sd">&quot;&quot;&quot;Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTrainingByCommittee.score-1011"><a href="#CoTrainingByCommittee.score-1011"><span class="linenos">1011</span></a><span class="sd">        In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</span>
</span><span id="CoTrainingByCommittee.score-1012"><a href="#CoTrainingByCommittee.score-1012"><span class="linenos">1012</span></a><span class="sd">        Parameters</span>
</span><span id="CoTrainingByCommittee.score-1013"><a href="#CoTrainingByCommittee.score-1013"><span class="linenos">1013</span></a><span class="sd">        ----------</span>
</span><span id="CoTrainingByCommittee.score-1014"><a href="#CoTrainingByCommittee.score-1014"><span class="linenos">1014</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTrainingByCommittee.score-1015"><a href="#CoTrainingByCommittee.score-1015"><span class="linenos">1015</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTrainingByCommittee.score-1016"><a href="#CoTrainingByCommittee.score-1016"><span class="linenos">1016</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTrainingByCommittee.score-1017"><a href="#CoTrainingByCommittee.score-1017"><span class="linenos">1017</span></a><span class="sd">            True labels for X.</span>
</span><span id="CoTrainingByCommittee.score-1018"><a href="#CoTrainingByCommittee.score-1018"><span class="linenos">1018</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), optional</span>
</span><span id="CoTrainingByCommittee.score-1019"><a href="#CoTrainingByCommittee.score-1019"><span class="linenos">1019</span></a><span class="sd">            Sample weights., by default None</span>
</span><span id="CoTrainingByCommittee.score-1020"><a href="#CoTrainingByCommittee.score-1020"><span class="linenos">1020</span></a><span class="sd">        Returns</span>
</span><span id="CoTrainingByCommittee.score-1021"><a href="#CoTrainingByCommittee.score-1021"><span class="linenos">1021</span></a><span class="sd">        -------</span>
</span><span id="CoTrainingByCommittee.score-1022"><a href="#CoTrainingByCommittee.score-1022"><span class="linenos">1022</span></a><span class="sd">        score: float</span>
</span><span id="CoTrainingByCommittee.score-1023"><a href="#CoTrainingByCommittee.score-1023"><span class="linenos">1023</span></a><span class="sd">            Mean accuracy of self.predict(X) wrt. y.</span>
</span><span id="CoTrainingByCommittee.score-1024"><a href="#CoTrainingByCommittee.score-1024"><span class="linenos">1024</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTrainingByCommittee.score-1025"><a href="#CoTrainingByCommittee.score-1025"><span class="linenos">1025</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.score-1026"><a href="#CoTrainingByCommittee.score-1026"><span class="linenos">1026</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1027"><a href="#CoTrainingByCommittee.score-1027"><span class="linenos">1027</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="CoTrainingByCommittee.score-1028"><a href="#CoTrainingByCommittee.score-1028"><span class="linenos">1028</span></a>            <span class="k">if</span> <span class="s2">&quot;le_dict_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTrainingByCommittee.score-1029"><a href="#CoTrainingByCommittee.score-1029"><span class="linenos">1029</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.score-1030"><a href="#CoTrainingByCommittee.score-1030"><span class="linenos">1030</span></a>                    <span class="nb">zip</span><span class="p">(</span>
</span><span id="CoTrainingByCommittee.score-1031"><a href="#CoTrainingByCommittee.score-1031"><span class="linenos">1031</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
</span><span id="CoTrainingByCommittee.score-1032"><a href="#CoTrainingByCommittee.score-1032"><span class="linenos">1032</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span>
</span><span id="CoTrainingByCommittee.score-1033"><a href="#CoTrainingByCommittee.score-1033"><span class="linenos">1033</span></a>                    <span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1034"><a href="#CoTrainingByCommittee.score-1034"><span class="linenos">1034</span></a>                <span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1035"><a href="#CoTrainingByCommittee.score-1035"><span class="linenos">1035</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">le_dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTrainingByCommittee.score-1036"><a href="#CoTrainingByCommittee.score-1036"><span class="linenos">1036</span></a>
</span><span id="CoTrainingByCommittee.score-1037"><a href="#CoTrainingByCommittee.score-1037"><span class="linenos">1037</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_estimator</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mean accuracy on the given test data and labels.
In multi-label classification, this is the subset accuracy which is a harsh metric since you require for each sample that each label set be correctly predicted.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (array-like of shape (n_samples, n_features)):
Test samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,) or (n_samples, n_outputs)):
True labels for X.</li>
<li><strong>sample_weight</strong> (array-like of shape (n_samples,), optional):
Sample weights., by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Mean accuracy of self.predict(X) wrt. y.</li>
</ul>
</div>


                            </div>
                            <div id="CoTrainingByCommittee.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoTrainingByCommittee.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoTrainingByCommittee.get_params" class="function">get_params</dd>
                <dd id="CoTrainingByCommittee.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="CoTrainingByCommittee.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Rasco">
                            <input id="Rasco-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Rasco</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="Rasco-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco-636"><a href="#Rasco-636"><span class="linenos">636</span></a><span class="k">class</span> <span class="nc">Rasco</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="Rasco-637"><a href="#Rasco-637"><span class="linenos">637</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Rasco-638"><a href="#Rasco-638"><span class="linenos">638</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Rasco-639"><a href="#Rasco-639"><span class="linenos">639</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="Rasco-640"><a href="#Rasco-640"><span class="linenos">640</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Rasco-641"><a href="#Rasco-641"><span class="linenos">641</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="Rasco-642"><a href="#Rasco-642"><span class="linenos">642</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-643"><a href="#Rasco-643"><span class="linenos">643</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-644"><a href="#Rasco-644"><span class="linenos">644</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco-645"><a href="#Rasco-645"><span class="linenos">645</span></a>    <span class="p">):</span>
</span><span id="Rasco-646"><a href="#Rasco-646"><span class="linenos">646</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rasco-647"><a href="#Rasco-647"><span class="linenos">647</span></a><span class="sd">        Co-Training based on random subspaces</span>
</span><span id="Rasco-648"><a href="#Rasco-648"><span class="linenos">648</span></a>
</span><span id="Rasco-649"><a href="#Rasco-649"><span class="linenos">649</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-650"><a href="#Rasco-650"><span class="linenos">650</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-651"><a href="#Rasco-651"><span class="linenos">651</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Rasco-652"><a href="#Rasco-652"><span class="linenos">652</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="Rasco-653"><a href="#Rasco-653"><span class="linenos">653</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Rasco-654"><a href="#Rasco-654"><span class="linenos">654</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="Rasco-655"><a href="#Rasco-655"><span class="linenos">655</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="Rasco-656"><a href="#Rasco-656"><span class="linenos">656</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="Rasco-657"><a href="#Rasco-657"><span class="linenos">657</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="Rasco-658"><a href="#Rasco-658"><span class="linenos">658</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="Rasco-659"><a href="#Rasco-659"><span class="linenos">659</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="Rasco-660"><a href="#Rasco-660"><span class="linenos">660</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Rasco-661"><a href="#Rasco-661"><span class="linenos">661</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Rasco-662"><a href="#Rasco-662"><span class="linenos">662</span></a>
</span><span id="Rasco-663"><a href="#Rasco-663"><span class="linenos">663</span></a><span class="sd">        References</span>
</span><span id="Rasco-664"><a href="#Rasco-664"><span class="linenos">664</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-665"><a href="#Rasco-665"><span class="linenos">665</span></a><span class="sd">        Wang, J., Luo, S. W., &amp; Zeng, X. H. (2008, June).</span>
</span><span id="Rasco-666"><a href="#Rasco-666"><span class="linenos">666</span></a><span class="sd">        A random subspace method for co-training.</span>
</span><span id="Rasco-667"><a href="#Rasco-667"><span class="linenos">667</span></a><span class="sd">        In &lt;i&gt;2008 IEEE International Joint Conference on Neural Networks&lt;/i&gt;</span>
</span><span id="Rasco-668"><a href="#Rasco-668"><span class="linenos">668</span></a><span class="sd">        (IEEE World Congress on Computational Intelligence)</span>
</span><span id="Rasco-669"><a href="#Rasco-669"><span class="linenos">669</span></a><span class="sd">        (pp. 195-200). IEEE.</span>
</span><span id="Rasco-670"><a href="#Rasco-670"><span class="linenos">670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-671"><a href="#Rasco-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">)</span>  <span class="c1"># C in paper</span>
</span><span id="Rasco-672"><a href="#Rasco-672"><span class="linenos">672</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>  <span class="c1"># J in paper</span>
</span><span id="Rasco-673"><a href="#Rasco-673"><span class="linenos">673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>  <span class="c1"># K in paper</span>
</span><span id="Rasco-674"><a href="#Rasco-674"><span class="linenos">674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="n">subspace_size</span>  <span class="c1"># m in paper</span>
</span><span id="Rasco-675"><a href="#Rasco-675"><span class="linenos">675</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="Rasco-676"><a href="#Rasco-676"><span class="linenos">676</span></a>
</span><span id="Rasco-677"><a href="#Rasco-677"><span class="linenos">677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Rasco-678"><a href="#Rasco-678"><span class="linenos">678</span></a>
</span><span id="Rasco-679"><a href="#Rasco-679"><span class="linenos">679</span></a>    <span class="k">def</span> <span class="nf">_generate_random_subspaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Rasco-680"><a href="#Rasco-680"><span class="linenos">680</span></a>        <span class="sd">&quot;&quot;&quot;Generate the random subspaces</span>
</span><span id="Rasco-681"><a href="#Rasco-681"><span class="linenos">681</span></a>
</span><span id="Rasco-682"><a href="#Rasco-682"><span class="linenos">682</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-683"><a href="#Rasco-683"><span class="linenos">683</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-684"><a href="#Rasco-684"><span class="linenos">684</span></a><span class="sd">        X : array like</span>
</span><span id="Rasco-685"><a href="#Rasco-685"><span class="linenos">685</span></a><span class="sd">            Labeled dataset</span>
</span><span id="Rasco-686"><a href="#Rasco-686"><span class="linenos">686</span></a><span class="sd">        y : array like, optional</span>
</span><span id="Rasco-687"><a href="#Rasco-687"><span class="linenos">687</span></a><span class="sd">            Target for each X, not needed on Rasco, by default None</span>
</span><span id="Rasco-688"><a href="#Rasco-688"><span class="linenos">688</span></a>
</span><span id="Rasco-689"><a href="#Rasco-689"><span class="linenos">689</span></a><span class="sd">        Returns</span>
</span><span id="Rasco-690"><a href="#Rasco-690"><span class="linenos">690</span></a><span class="sd">        -------</span>
</span><span id="Rasco-691"><a href="#Rasco-691"><span class="linenos">691</span></a><span class="sd">        subspaces : list</span>
</span><span id="Rasco-692"><a href="#Rasco-692"><span class="linenos">692</span></a><span class="sd">            List of index of features</span>
</span><span id="Rasco-693"><a href="#Rasco-693"><span class="linenos">693</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-694"><a href="#Rasco-694"><span class="linenos">694</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-695"><a href="#Rasco-695"><span class="linenos">695</span></a>        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Rasco-696"><a href="#Rasco-696"><span class="linenos">696</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco-697"><a href="#Rasco-697"><span class="linenos">697</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco-698"><a href="#Rasco-698"><span class="linenos">698</span></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">features</span><span class="p">)[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span><span class="p">])</span>
</span><span id="Rasco-699"><a href="#Rasco-699"><span class="linenos">699</span></a>        <span class="k">return</span> <span class="n">idxs</span>
</span><span id="Rasco-700"><a href="#Rasco-700"><span class="linenos">700</span></a>
</span><span id="Rasco-701"><a href="#Rasco-701"><span class="linenos">701</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco-702"><a href="#Rasco-702"><span class="linenos">702</span></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="Rasco-703"><a href="#Rasco-703"><span class="linenos">703</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="Rasco-704"><a href="#Rasco-704"><span class="linenos">704</span></a>            <span class="n">estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Rasco-705"><a href="#Rasco-705"><span class="linenos">705</span></a>        <span class="k">return</span> <span class="n">skclone</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-706"><a href="#Rasco-706"><span class="linenos">706</span></a>
</span><span id="Rasco-707"><a href="#Rasco-707"><span class="linenos">707</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco-708"><a href="#Rasco-708"><span class="linenos">708</span></a>        <span class="sd">&quot;&quot;&quot;Build a Rasco classifier from the training set (X, y).</span>
</span><span id="Rasco-709"><a href="#Rasco-709"><span class="linenos">709</span></a>
</span><span id="Rasco-710"><a href="#Rasco-710"><span class="linenos">710</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco-711"><a href="#Rasco-711"><span class="linenos">711</span></a><span class="sd">        ----------</span>
</span><span id="Rasco-712"><a href="#Rasco-712"><span class="linenos">712</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Rasco-713"><a href="#Rasco-713"><span class="linenos">713</span></a><span class="sd">            The training input samples.</span>
</span><span id="Rasco-714"><a href="#Rasco-714"><span class="linenos">714</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Rasco-715"><a href="#Rasco-715"><span class="linenos">715</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="Rasco-716"><a href="#Rasco-716"><span class="linenos">716</span></a>
</span><span id="Rasco-717"><a href="#Rasco-717"><span class="linenos">717</span></a><span class="sd">        Returns</span>
</span><span id="Rasco-718"><a href="#Rasco-718"><span class="linenos">718</span></a><span class="sd">        -------</span>
</span><span id="Rasco-719"><a href="#Rasco-719"><span class="linenos">719</span></a><span class="sd">        self: Rasco</span>
</span><span id="Rasco-720"><a href="#Rasco-720"><span class="linenos">720</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Rasco-721"><a href="#Rasco-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco-722"><a href="#Rasco-722"><span class="linenos">722</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Rasco-723"><a href="#Rasco-723"><span class="linenos">723</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-724"><a href="#Rasco-724"><span class="linenos">724</span></a>
</span><span id="Rasco-725"><a href="#Rasco-725"><span class="linenos">725</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Rasco-726"><a href="#Rasco-726"><span class="linenos">726</span></a>
</span><span id="Rasco-727"><a href="#Rasco-727"><span class="linenos">727</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-728"><a href="#Rasco-728"><span class="linenos">728</span></a>
</span><span id="Rasco-729"><a href="#Rasco-729"><span class="linenos">729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-730"><a href="#Rasco-730"><span class="linenos">730</span></a>        <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco-731"><a href="#Rasco-731"><span class="linenos">731</span></a>
</span><span id="Rasco-732"><a href="#Rasco-732"><span class="linenos">732</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Rasco-733"><a href="#Rasco-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Rasco-734"><a href="#Rasco-734"><span class="linenos">734</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_subspaces</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco-735"><a href="#Rasco-735"><span class="linenos">735</span></a>
</span><span id="Rasco-736"><a href="#Rasco-736"><span class="linenos">736</span></a>        <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco-737"><a href="#Rasco-737"><span class="linenos">737</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-738"><a href="#Rasco-738"><span class="linenos">738</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco-739"><a href="#Rasco-739"><span class="linenos">739</span></a>        <span class="p">)</span>
</span><span id="Rasco-740"><a href="#Rasco-740"><span class="linenos">740</span></a>
</span><span id="Rasco-741"><a href="#Rasco-741"><span class="linenos">741</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Rasco-742"><a href="#Rasco-742"><span class="linenos">742</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Rasco-743"><a href="#Rasco-743"><span class="linenos">743</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">it</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="Rasco-744"><a href="#Rasco-744"><span class="linenos">744</span></a>                <span class="n">X_unlabel</span>
</span><span id="Rasco-745"><a href="#Rasco-745"><span class="linenos">745</span></a>            <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Rasco-746"><a href="#Rasco-746"><span class="linenos">746</span></a>                <span class="k">break</span>
</span><span id="Rasco-747"><a href="#Rasco-747"><span class="linenos">747</span></a>
</span><span id="Rasco-748"><a href="#Rasco-748"><span class="linenos">748</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco-749"><a href="#Rasco-749"><span class="linenos">749</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco-750"><a href="#Rasco-750"><span class="linenos">750</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="n">cfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="Rasco-751"><a href="#Rasco-751"><span class="linenos">751</span></a>                <span class="n">raw_predicions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span><span id="Rasco-752"><a href="#Rasco-752"><span class="linenos">752</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="Rasco-753"><a href="#Rasco-753"><span class="linenos">753</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco-754"><a href="#Rasco-754"><span class="linenos">754</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco-755"><a href="#Rasco-755"><span class="linenos">755</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">class_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Rasco-756"><a href="#Rasco-756"><span class="linenos">756</span></a>
</span><span id="Rasco-757"><a href="#Rasco-757"><span class="linenos">757</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Rasco-758"><a href="#Rasco-758"><span class="linenos">758</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Rasco-759"><a href="#Rasco-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="Rasco-760"><a href="#Rasco-760"><span class="linenos">760</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">pseudoy</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="Rasco-761"><a href="#Rasco-761"><span class="linenos">761</span></a>
</span><span id="Rasco-762"><a href="#Rasco-762"><span class="linenos">762</span></a>            <span class="n">Lj</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco-763"><a href="#Rasco-763"><span class="linenos">763</span></a>            <span class="n">yj</span> <span class="o">=</span> <span class="n">pseudoy</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco-764"><a href="#Rasco-764"><span class="linenos">764</span></a>
</span><span id="Rasco-765"><a href="#Rasco-765"><span class="linenos">765</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">])</span>
</span><span id="Rasco-766"><a href="#Rasco-766"><span class="linenos">766</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span>
</span><span id="Rasco-767"><a href="#Rasco-767"><span class="linenos">767</span></a>            <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">final_instances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">final_instances</span><span class="p">])</span>
</span><span id="Rasco-768"><a href="#Rasco-768"><span class="linenos">768</span></a>
</span><span id="Rasco-769"><a href="#Rasco-769"><span class="linenos">769</span></a>            <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco-770"><a href="#Rasco-770"><span class="linenos">770</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco-771"><a href="#Rasco-771"><span class="linenos">771</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco-772"><a href="#Rasco-772"><span class="linenos">772</span></a>            <span class="p">)</span>
</span><span id="Rasco-773"><a href="#Rasco-773"><span class="linenos">773</span></a>
</span><span id="Rasco-774"><a href="#Rasco-774"><span class="linenos">774</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Rasco-775"><a href="#Rasco-775"><span class="linenos">775</span></a>
</span><span id="Rasco-776"><a href="#Rasco-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">cfs</span>
</span><span id="Rasco-777"><a href="#Rasco-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">idxs</span>
</span><span id="Rasco-778"><a href="#Rasco-778"><span class="linenos">778</span></a>
</span><span id="Rasco-779"><a href="#Rasco-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#Rasco.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="Rasco.__init__" class="classattr">
                                        <input id="Rasco.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Rasco</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Rasco.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco.__init__-637"><a href="#Rasco.__init__-637"><span class="linenos">637</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Rasco.__init__-638"><a href="#Rasco.__init__-638"><span class="linenos">638</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Rasco.__init__-639"><a href="#Rasco.__init__-639"><span class="linenos">639</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="Rasco.__init__-640"><a href="#Rasco.__init__-640"><span class="linenos">640</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="Rasco.__init__-641"><a href="#Rasco.__init__-641"><span class="linenos">641</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="Rasco.__init__-642"><a href="#Rasco.__init__-642"><span class="linenos">642</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-643"><a href="#Rasco.__init__-643"><span class="linenos">643</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-644"><a href="#Rasco.__init__-644"><span class="linenos">644</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Rasco.__init__-645"><a href="#Rasco.__init__-645"><span class="linenos">645</span></a>    <span class="p">):</span>
</span><span id="Rasco.__init__-646"><a href="#Rasco.__init__-646"><span class="linenos">646</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Rasco.__init__-647"><a href="#Rasco.__init__-647"><span class="linenos">647</span></a><span class="sd">        Co-Training based on random subspaces</span>
</span><span id="Rasco.__init__-648"><a href="#Rasco.__init__-648"><span class="linenos">648</span></a>
</span><span id="Rasco.__init__-649"><a href="#Rasco.__init__-649"><span class="linenos">649</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco.__init__-650"><a href="#Rasco.__init__-650"><span class="linenos">650</span></a><span class="sd">        ----------</span>
</span><span id="Rasco.__init__-651"><a href="#Rasco.__init__-651"><span class="linenos">651</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Rasco.__init__-652"><a href="#Rasco.__init__-652"><span class="linenos">652</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="Rasco.__init__-653"><a href="#Rasco.__init__-653"><span class="linenos">653</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Rasco.__init__-654"><a href="#Rasco.__init__-654"><span class="linenos">654</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="Rasco.__init__-655"><a href="#Rasco.__init__-655"><span class="linenos">655</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="Rasco.__init__-656"><a href="#Rasco.__init__-656"><span class="linenos">656</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="Rasco.__init__-657"><a href="#Rasco.__init__-657"><span class="linenos">657</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="Rasco.__init__-658"><a href="#Rasco.__init__-658"><span class="linenos">658</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="Rasco.__init__-659"><a href="#Rasco.__init__-659"><span class="linenos">659</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="Rasco.__init__-660"><a href="#Rasco.__init__-660"><span class="linenos">660</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Rasco.__init__-661"><a href="#Rasco.__init__-661"><span class="linenos">661</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Rasco.__init__-662"><a href="#Rasco.__init__-662"><span class="linenos">662</span></a>
</span><span id="Rasco.__init__-663"><a href="#Rasco.__init__-663"><span class="linenos">663</span></a><span class="sd">        References</span>
</span><span id="Rasco.__init__-664"><a href="#Rasco.__init__-664"><span class="linenos">664</span></a><span class="sd">        ----------</span>
</span><span id="Rasco.__init__-665"><a href="#Rasco.__init__-665"><span class="linenos">665</span></a><span class="sd">        Wang, J., Luo, S. W., &amp; Zeng, X. H. (2008, June).</span>
</span><span id="Rasco.__init__-666"><a href="#Rasco.__init__-666"><span class="linenos">666</span></a><span class="sd">        A random subspace method for co-training.</span>
</span><span id="Rasco.__init__-667"><a href="#Rasco.__init__-667"><span class="linenos">667</span></a><span class="sd">        In &lt;i&gt;2008 IEEE International Joint Conference on Neural Networks&lt;/i&gt;</span>
</span><span id="Rasco.__init__-668"><a href="#Rasco.__init__-668"><span class="linenos">668</span></a><span class="sd">        (IEEE World Congress on Computational Intelligence)</span>
</span><span id="Rasco.__init__-669"><a href="#Rasco.__init__-669"><span class="linenos">669</span></a><span class="sd">        (pp. 195-200). IEEE.</span>
</span><span id="Rasco.__init__-670"><a href="#Rasco.__init__-670"><span class="linenos">670</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco.__init__-671"><a href="#Rasco.__init__-671"><span class="linenos">671</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">)</span>  <span class="c1"># C in paper</span>
</span><span id="Rasco.__init__-672"><a href="#Rasco.__init__-672"><span class="linenos">672</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>  <span class="c1"># J in paper</span>
</span><span id="Rasco.__init__-673"><a href="#Rasco.__init__-673"><span class="linenos">673</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>  <span class="c1"># K in paper</span>
</span><span id="Rasco.__init__-674"><a href="#Rasco.__init__-674"><span class="linenos">674</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="n">subspace_size</span>  <span class="c1"># m in paper</span>
</span><span id="Rasco.__init__-675"><a href="#Rasco.__init__-675"><span class="linenos">675</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="Rasco.__init__-676"><a href="#Rasco.__init__-676"><span class="linenos">676</span></a>
</span><span id="Rasco.__init__-677"><a href="#Rasco.__init__-677"><span class="linenos">677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Co-Training based on random subspaces</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0.
If is -1 then will be infinite iterations until U be empty, by default 10</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 30</li>
<li><strong>subspace_size</strong> (int, optional):
The number of features for each subspace. If it is None will be the half of the features size., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Wang, J., Luo, S. W., &amp; Zeng, X. H. (2008, June).
A random subspace method for co-training.
In <i>2008 IEEE International Joint Conference on Neural Networks</i>
(IEEE World Congress on Computational Intelligence)
(pp. 195-200). IEEE.</p>
</div>


                            </div>
                            <div id="Rasco.fit" class="classattr">
                                        <input id="Rasco.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Rasco.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Rasco.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Rasco.fit-707"><a href="#Rasco.fit-707"><span class="linenos">707</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Rasco.fit-708"><a href="#Rasco.fit-708"><span class="linenos">708</span></a>        <span class="sd">&quot;&quot;&quot;Build a Rasco classifier from the training set (X, y).</span>
</span><span id="Rasco.fit-709"><a href="#Rasco.fit-709"><span class="linenos">709</span></a>
</span><span id="Rasco.fit-710"><a href="#Rasco.fit-710"><span class="linenos">710</span></a><span class="sd">        Parameters</span>
</span><span id="Rasco.fit-711"><a href="#Rasco.fit-711"><span class="linenos">711</span></a><span class="sd">        ----------</span>
</span><span id="Rasco.fit-712"><a href="#Rasco.fit-712"><span class="linenos">712</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Rasco.fit-713"><a href="#Rasco.fit-713"><span class="linenos">713</span></a><span class="sd">            The training input samples.</span>
</span><span id="Rasco.fit-714"><a href="#Rasco.fit-714"><span class="linenos">714</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Rasco.fit-715"><a href="#Rasco.fit-715"><span class="linenos">715</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="Rasco.fit-716"><a href="#Rasco.fit-716"><span class="linenos">716</span></a>
</span><span id="Rasco.fit-717"><a href="#Rasco.fit-717"><span class="linenos">717</span></a><span class="sd">        Returns</span>
</span><span id="Rasco.fit-718"><a href="#Rasco.fit-718"><span class="linenos">718</span></a><span class="sd">        -------</span>
</span><span id="Rasco.fit-719"><a href="#Rasco.fit-719"><span class="linenos">719</span></a><span class="sd">        self: Rasco</span>
</span><span id="Rasco.fit-720"><a href="#Rasco.fit-720"><span class="linenos">720</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Rasco.fit-721"><a href="#Rasco.fit-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Rasco.fit-722"><a href="#Rasco.fit-722"><span class="linenos">722</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Rasco.fit-723"><a href="#Rasco.fit-723"><span class="linenos">723</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-724"><a href="#Rasco.fit-724"><span class="linenos">724</span></a>
</span><span id="Rasco.fit-725"><a href="#Rasco.fit-725"><span class="linenos">725</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Rasco.fit-726"><a href="#Rasco.fit-726"><span class="linenos">726</span></a>
</span><span id="Rasco.fit-727"><a href="#Rasco.fit-727"><span class="linenos">727</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco.fit-728"><a href="#Rasco.fit-728"><span class="linenos">728</span></a>
</span><span id="Rasco.fit-729"><a href="#Rasco.fit-729"><span class="linenos">729</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-730"><a href="#Rasco.fit-730"><span class="linenos">730</span></a>        <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Rasco.fit-731"><a href="#Rasco.fit-731"><span class="linenos">731</span></a>
</span><span id="Rasco.fit-732"><a href="#Rasco.fit-732"><span class="linenos">732</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Rasco.fit-733"><a href="#Rasco.fit-733"><span class="linenos">733</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Rasco.fit-734"><a href="#Rasco.fit-734"><span class="linenos">734</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_random_subspaces</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="Rasco.fit-735"><a href="#Rasco.fit-735"><span class="linenos">735</span></a>
</span><span id="Rasco.fit-736"><a href="#Rasco.fit-736"><span class="linenos">736</span></a>        <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco.fit-737"><a href="#Rasco.fit-737"><span class="linenos">737</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco.fit-738"><a href="#Rasco.fit-738"><span class="linenos">738</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco.fit-739"><a href="#Rasco.fit-739"><span class="linenos">739</span></a>        <span class="p">)</span>
</span><span id="Rasco.fit-740"><a href="#Rasco.fit-740"><span class="linenos">740</span></a>
</span><span id="Rasco.fit-741"><a href="#Rasco.fit-741"><span class="linenos">741</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Rasco.fit-742"><a href="#Rasco.fit-742"><span class="linenos">742</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Rasco.fit-743"><a href="#Rasco.fit-743"><span class="linenos">743</span></a>            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">it</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="Rasco.fit-744"><a href="#Rasco.fit-744"><span class="linenos">744</span></a>                <span class="n">X_unlabel</span>
</span><span id="Rasco.fit-745"><a href="#Rasco.fit-745"><span class="linenos">745</span></a>            <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Rasco.fit-746"><a href="#Rasco.fit-746"><span class="linenos">746</span></a>                <span class="k">break</span>
</span><span id="Rasco.fit-747"><a href="#Rasco.fit-747"><span class="linenos">747</span></a>
</span><span id="Rasco.fit-748"><a href="#Rasco.fit-748"><span class="linenos">748</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Rasco.fit-749"><a href="#Rasco.fit-749"><span class="linenos">749</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="Rasco.fit-750"><a href="#Rasco.fit-750"><span class="linenos">750</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="n">cfs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="Rasco.fit-751"><a href="#Rasco.fit-751"><span class="linenos">751</span></a>                <span class="n">raw_predicions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span>
</span><span id="Rasco.fit-752"><a href="#Rasco.fit-752"><span class="linenos">752</span></a>            <span class="n">raw_predicions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="Rasco.fit-753"><a href="#Rasco.fit-753"><span class="linenos">753</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco.fit-754"><a href="#Rasco.fit-754"><span class="linenos">754</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predicions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Rasco.fit-755"><a href="#Rasco.fit-755"><span class="linenos">755</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">class_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Rasco.fit-756"><a href="#Rasco.fit-756"><span class="linenos">756</span></a>
</span><span id="Rasco.fit-757"><a href="#Rasco.fit-757"><span class="linenos">757</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="Rasco.fit-758"><a href="#Rasco.fit-758"><span class="linenos">758</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Rasco.fit-759"><a href="#Rasco.fit-759"><span class="linenos">759</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="Rasco.fit-760"><a href="#Rasco.fit-760"><span class="linenos">760</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">pseudoy</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="Rasco.fit-761"><a href="#Rasco.fit-761"><span class="linenos">761</span></a>
</span><span id="Rasco.fit-762"><a href="#Rasco.fit-762"><span class="linenos">762</span></a>            <span class="n">Lj</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco.fit-763"><a href="#Rasco.fit-763"><span class="linenos">763</span></a>            <span class="n">yj</span> <span class="o">=</span> <span class="n">pseudoy</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="Rasco.fit-764"><a href="#Rasco.fit-764"><span class="linenos">764</span></a>
</span><span id="Rasco.fit-765"><a href="#Rasco.fit-765"><span class="linenos">765</span></a>            <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Lj</span><span class="p">])</span>
</span><span id="Rasco.fit-766"><a href="#Rasco.fit-766"><span class="linenos">766</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">yj</span><span class="p">)</span>
</span><span id="Rasco.fit-767"><a href="#Rasco.fit-767"><span class="linenos">767</span></a>            <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">final_instances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">final_instances</span><span class="p">])</span>
</span><span id="Rasco.fit-768"><a href="#Rasco.fit-768"><span class="linenos">768</span></a>
</span><span id="Rasco.fit-769"><a href="#Rasco.fit-769"><span class="linenos">769</span></a>            <span class="n">cfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="Rasco.fit-770"><a href="#Rasco.fit-770"><span class="linenos">770</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">idxs</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Rasco.fit-771"><a href="#Rasco.fit-771"><span class="linenos">771</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="Rasco.fit-772"><a href="#Rasco.fit-772"><span class="linenos">772</span></a>            <span class="p">)</span>
</span><span id="Rasco.fit-773"><a href="#Rasco.fit-773"><span class="linenos">773</span></a>
</span><span id="Rasco.fit-774"><a href="#Rasco.fit-774"><span class="linenos">774</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Rasco.fit-775"><a href="#Rasco.fit-775"><span class="linenos">775</span></a>
</span><span id="Rasco.fit-776"><a href="#Rasco.fit-776"><span class="linenos">776</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">cfs</span>
</span><span id="Rasco.fit-777"><a href="#Rasco.fit-777"><span class="linenos">777</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">idxs</span>
</span><span id="Rasco.fit-778"><a href="#Rasco.fit-778"><span class="linenos">778</span></a>
</span><span id="Rasco.fit-779"><a href="#Rasco.fit-779"><span class="linenos">779</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a Rasco classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (Rasco):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="Rasco.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Rasco.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="Rasco.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="Rasco.get_params" class="function">get_params</dd>
                <dd id="Rasco.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="Rasco.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="Rasco.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="Rasco.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RelRasco">
                            <input id="RelRasco-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RelRasco</span><wbr>(<span class="base"><a href="#Rasco">sslearn.wrapper.Rasco</a></span>):

                <label class="view-source-button" for="RelRasco-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelRasco"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelRasco-782"><a href="#RelRasco-782"><span class="linenos">782</span></a><span class="k">class</span> <span class="nc">RelRasco</span><span class="p">(</span><span class="n">Rasco</span><span class="p">):</span>
</span><span id="RelRasco-783"><a href="#RelRasco-783"><span class="linenos">783</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco-784"><a href="#RelRasco-784"><span class="linenos">784</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RelRasco-785"><a href="#RelRasco-785"><span class="linenos">785</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="RelRasco-786"><a href="#RelRasco-786"><span class="linenos">786</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RelRasco-787"><a href="#RelRasco-787"><span class="linenos">787</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="RelRasco-788"><a href="#RelRasco-788"><span class="linenos">788</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-789"><a href="#RelRasco-789"><span class="linenos">789</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-790"><a href="#RelRasco-790"><span class="linenos">790</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco-791"><a href="#RelRasco-791"><span class="linenos">791</span></a>    <span class="p">):</span>
</span><span id="RelRasco-792"><a href="#RelRasco-792"><span class="linenos">792</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelRasco-793"><a href="#RelRasco-793"><span class="linenos">793</span></a><span class="sd">        Co-Training with relevant random subspaces</span>
</span><span id="RelRasco-794"><a href="#RelRasco-794"><span class="linenos">794</span></a>
</span><span id="RelRasco-795"><a href="#RelRasco-795"><span class="linenos">795</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco-796"><a href="#RelRasco-796"><span class="linenos">796</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco-797"><a href="#RelRasco-797"><span class="linenos">797</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="RelRasco-798"><a href="#RelRasco-798"><span class="linenos">798</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="RelRasco-799"><a href="#RelRasco-799"><span class="linenos">799</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="RelRasco-800"><a href="#RelRasco-800"><span class="linenos">800</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="RelRasco-801"><a href="#RelRasco-801"><span class="linenos">801</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="RelRasco-802"><a href="#RelRasco-802"><span class="linenos">802</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="RelRasco-803"><a href="#RelRasco-803"><span class="linenos">803</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="RelRasco-804"><a href="#RelRasco-804"><span class="linenos">804</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="RelRasco-805"><a href="#RelRasco-805"><span class="linenos">805</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="RelRasco-806"><a href="#RelRasco-806"><span class="linenos">806</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="RelRasco-807"><a href="#RelRasco-807"><span class="linenos">807</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="RelRasco-808"><a href="#RelRasco-808"><span class="linenos">808</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="RelRasco-809"><a href="#RelRasco-809"><span class="linenos">809</span></a><span class="sd">            The number of jobs to run in parallel. -1 means using all processors., by default None</span>
</span><span id="RelRasco-810"><a href="#RelRasco-810"><span class="linenos">810</span></a>
</span><span id="RelRasco-811"><a href="#RelRasco-811"><span class="linenos">811</span></a><span class="sd">        References</span>
</span><span id="RelRasco-812"><a href="#RelRasco-812"><span class="linenos">812</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco-813"><a href="#RelRasco-813"><span class="linenos">813</span></a><span class="sd">        Yaslan, Y., &amp; Cataltepe, Z. (2010).</span>
</span><span id="RelRasco-814"><a href="#RelRasco-814"><span class="linenos">814</span></a><span class="sd">        Co-training with relevant random subspaces.</span>
</span><span id="RelRasco-815"><a href="#RelRasco-815"><span class="linenos">815</span></a><span class="sd">        &lt;i&gt;Neurocomputing&lt;/i&gt;, 73(10-12), 1652-1661.</span>
</span><span id="RelRasco-816"><a href="#RelRasco-816"><span class="linenos">816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco-817"><a href="#RelRasco-817"><span class="linenos">817</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco-818"><a href="#RelRasco-818"><span class="linenos">818</span></a>            <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="RelRasco-819"><a href="#RelRasco-819"><span class="linenos">819</span></a>            <span class="n">max_iterations</span><span class="p">,</span>
</span><span id="RelRasco-820"><a href="#RelRasco-820"><span class="linenos">820</span></a>            <span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RelRasco-821"><a href="#RelRasco-821"><span class="linenos">821</span></a>            <span class="n">subspace_size</span><span class="p">,</span>
</span><span id="RelRasco-822"><a href="#RelRasco-822"><span class="linenos">822</span></a>            <span class="n">random_state</span><span class="p">,</span>
</span><span id="RelRasco-823"><a href="#RelRasco-823"><span class="linenos">823</span></a>            <span class="n">n_jobs</span><span class="p">,</span>
</span><span id="RelRasco-824"><a href="#RelRasco-824"><span class="linenos">824</span></a>        <span class="p">)</span>
</span><span id="RelRasco-825"><a href="#RelRasco-825"><span class="linenos">825</span></a>
</span><span id="RelRasco-826"><a href="#RelRasco-826"><span class="linenos">826</span></a>    <span class="k">def</span> <span class="nf">_generate_random_subspaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RelRasco-827"><a href="#RelRasco-827"><span class="linenos">827</span></a>        <span class="sd">&quot;&quot;&quot;Generate the relevant random subspcaes</span>
</span><span id="RelRasco-828"><a href="#RelRasco-828"><span class="linenos">828</span></a>
</span><span id="RelRasco-829"><a href="#RelRasco-829"><span class="linenos">829</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco-830"><a href="#RelRasco-830"><span class="linenos">830</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco-831"><a href="#RelRasco-831"><span class="linenos">831</span></a><span class="sd">        X : array like</span>
</span><span id="RelRasco-832"><a href="#RelRasco-832"><span class="linenos">832</span></a><span class="sd">            Labeled dataset</span>
</span><span id="RelRasco-833"><a href="#RelRasco-833"><span class="linenos">833</span></a><span class="sd">        y : array like, optional</span>
</span><span id="RelRasco-834"><a href="#RelRasco-834"><span class="linenos">834</span></a><span class="sd">            Target for each X, only needed on Rel-Rasco, by default None</span>
</span><span id="RelRasco-835"><a href="#RelRasco-835"><span class="linenos">835</span></a>
</span><span id="RelRasco-836"><a href="#RelRasco-836"><span class="linenos">836</span></a><span class="sd">        Returns</span>
</span><span id="RelRasco-837"><a href="#RelRasco-837"><span class="linenos">837</span></a><span class="sd">        -------</span>
</span><span id="RelRasco-838"><a href="#RelRasco-838"><span class="linenos">838</span></a><span class="sd">        subspaces: list</span>
</span><span id="RelRasco-839"><a href="#RelRasco-839"><span class="linenos">839</span></a><span class="sd">            List of index of features</span>
</span><span id="RelRasco-840"><a href="#RelRasco-840"><span class="linenos">840</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco-841"><a href="#RelRasco-841"><span class="linenos">841</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="RelRasco-842"><a href="#RelRasco-842"><span class="linenos">842</span></a>        <span class="n">relevance</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="RelRasco-843"><a href="#RelRasco-843"><span class="linenos">843</span></a>        <span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RelRasco-844"><a href="#RelRasco-844"><span class="linenos">844</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RelRasco-845"><a href="#RelRasco-845"><span class="linenos">845</span></a>            <span class="n">subspace</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RelRasco-846"><a href="#RelRasco-846"><span class="linenos">846</span></a>            <span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subspace_size</span><span class="p">):</span>
</span><span id="RelRasco-847"><a href="#RelRasco-847"><span class="linenos">847</span></a>                <span class="n">f1</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="RelRasco-848"><a href="#RelRasco-848"><span class="linenos">848</span></a>                <span class="n">f2</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="RelRasco-849"><a href="#RelRasco-849"><span class="linenos">849</span></a>                <span class="k">if</span> <span class="n">relevance</span><span class="p">[</span><span class="n">f1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">relevance</span><span class="p">[</span><span class="n">f2</span><span class="p">]:</span>
</span><span id="RelRasco-850"><a href="#RelRasco-850"><span class="linenos">850</span></a>                    <span class="n">subspace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="RelRasco-851"><a href="#RelRasco-851"><span class="linenos">851</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="RelRasco-852"><a href="#RelRasco-852"><span class="linenos">852</span></a>                    <span class="n">subspace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
</span><span id="RelRasco-853"><a href="#RelRasco-853"><span class="linenos">853</span></a>            <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subspace</span><span class="p">)</span>
</span><span id="RelRasco-854"><a href="#RelRasco-854"><span class="linenos">854</span></a>        <span class="k">return</span> <span class="n">idxs</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#RelRasco.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="RelRasco.__init__" class="classattr">
                                        <input id="RelRasco.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">RelRasco</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="RelRasco.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelRasco.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelRasco.__init__-783"><a href="#RelRasco.__init__-783"><span class="linenos">783</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco.__init__-784"><a href="#RelRasco.__init__-784"><span class="linenos">784</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RelRasco.__init__-785"><a href="#RelRasco.__init__-785"><span class="linenos">785</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="RelRasco.__init__-786"><a href="#RelRasco.__init__-786"><span class="linenos">786</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RelRasco.__init__-787"><a href="#RelRasco.__init__-787"><span class="linenos">787</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="RelRasco.__init__-788"><a href="#RelRasco.__init__-788"><span class="linenos">788</span></a>        <span class="n">subspace_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-789"><a href="#RelRasco.__init__-789"><span class="linenos">789</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-790"><a href="#RelRasco.__init__-790"><span class="linenos">790</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RelRasco.__init__-791"><a href="#RelRasco.__init__-791"><span class="linenos">791</span></a>    <span class="p">):</span>
</span><span id="RelRasco.__init__-792"><a href="#RelRasco.__init__-792"><span class="linenos">792</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelRasco.__init__-793"><a href="#RelRasco.__init__-793"><span class="linenos">793</span></a><span class="sd">        Co-Training with relevant random subspaces</span>
</span><span id="RelRasco.__init__-794"><a href="#RelRasco.__init__-794"><span class="linenos">794</span></a>
</span><span id="RelRasco.__init__-795"><a href="#RelRasco.__init__-795"><span class="linenos">795</span></a><span class="sd">        Parameters</span>
</span><span id="RelRasco.__init__-796"><a href="#RelRasco.__init__-796"><span class="linenos">796</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco.__init__-797"><a href="#RelRasco.__init__-797"><span class="linenos">797</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="RelRasco.__init__-798"><a href="#RelRasco.__init__-798"><span class="linenos">798</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="RelRasco.__init__-799"><a href="#RelRasco.__init__-799"><span class="linenos">799</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="RelRasco.__init__-800"><a href="#RelRasco.__init__-800"><span class="linenos">800</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0.</span>
</span><span id="RelRasco.__init__-801"><a href="#RelRasco.__init__-801"><span class="linenos">801</span></a><span class="sd">            If is -1 then will be infinite iterations until U be empty, by default 10</span>
</span><span id="RelRasco.__init__-802"><a href="#RelRasco.__init__-802"><span class="linenos">802</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="RelRasco.__init__-803"><a href="#RelRasco.__init__-803"><span class="linenos">803</span></a><span class="sd">            The number of base estimators in the ensemble., by default 30</span>
</span><span id="RelRasco.__init__-804"><a href="#RelRasco.__init__-804"><span class="linenos">804</span></a><span class="sd">        subspace_size : int, optional</span>
</span><span id="RelRasco.__init__-805"><a href="#RelRasco.__init__-805"><span class="linenos">805</span></a><span class="sd">            The number of features for each subspace. If it is None will be the half of the features size., by default None</span>
</span><span id="RelRasco.__init__-806"><a href="#RelRasco.__init__-806"><span class="linenos">806</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="RelRasco.__init__-807"><a href="#RelRasco.__init__-807"><span class="linenos">807</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="RelRasco.__init__-808"><a href="#RelRasco.__init__-808"><span class="linenos">808</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="RelRasco.__init__-809"><a href="#RelRasco.__init__-809"><span class="linenos">809</span></a><span class="sd">            The number of jobs to run in parallel. -1 means using all processors., by default None</span>
</span><span id="RelRasco.__init__-810"><a href="#RelRasco.__init__-810"><span class="linenos">810</span></a>
</span><span id="RelRasco.__init__-811"><a href="#RelRasco.__init__-811"><span class="linenos">811</span></a><span class="sd">        References</span>
</span><span id="RelRasco.__init__-812"><a href="#RelRasco.__init__-812"><span class="linenos">812</span></a><span class="sd">        ----------</span>
</span><span id="RelRasco.__init__-813"><a href="#RelRasco.__init__-813"><span class="linenos">813</span></a><span class="sd">        Yaslan, Y., &amp; Cataltepe, Z. (2010).</span>
</span><span id="RelRasco.__init__-814"><a href="#RelRasco.__init__-814"><span class="linenos">814</span></a><span class="sd">        Co-training with relevant random subspaces.</span>
</span><span id="RelRasco.__init__-815"><a href="#RelRasco.__init__-815"><span class="linenos">815</span></a><span class="sd">        &lt;i&gt;Neurocomputing&lt;/i&gt;, 73(10-12), 1652-1661.</span>
</span><span id="RelRasco.__init__-816"><a href="#RelRasco.__init__-816"><span class="linenos">816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RelRasco.__init__-817"><a href="#RelRasco.__init__-817"><span class="linenos">817</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RelRasco.__init__-818"><a href="#RelRasco.__init__-818"><span class="linenos">818</span></a>            <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="RelRasco.__init__-819"><a href="#RelRasco.__init__-819"><span class="linenos">819</span></a>            <span class="n">max_iterations</span><span class="p">,</span>
</span><span id="RelRasco.__init__-820"><a href="#RelRasco.__init__-820"><span class="linenos">820</span></a>            <span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RelRasco.__init__-821"><a href="#RelRasco.__init__-821"><span class="linenos">821</span></a>            <span class="n">subspace_size</span><span class="p">,</span>
</span><span id="RelRasco.__init__-822"><a href="#RelRasco.__init__-822"><span class="linenos">822</span></a>            <span class="n">random_state</span><span class="p">,</span>
</span><span id="RelRasco.__init__-823"><a href="#RelRasco.__init__-823"><span class="linenos">823</span></a>            <span class="n">n_jobs</span><span class="p">,</span>
</span><span id="RelRasco.__init__-824"><a href="#RelRasco.__init__-824"><span class="linenos">824</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Co-Training with relevant random subspaces</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0.
If is -1 then will be infinite iterations until U be empty, by default 10</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 30</li>
<li><strong>subspace_size</strong> (int, optional):
The number of features for each subspace. If it is None will be the half of the features size., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel. -1 means using all processors., by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Yaslan, Y., &amp; Cataltepe, Z. (2010).
Co-training with relevant random subspaces.
<i>Neurocomputing</i>, 73(10-12), 1652-1661.</p>
</div>


                            </div>
                            <div id="RelRasco.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#RelRasco.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Rasco">Rasco</a></dt>
                                <dd id="RelRasco.fit" class="function"><a href="#Rasco.fit">fit</a></dd>

            </div>
            <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="RelRasco.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="RelRasco.get_params" class="function">get_params</dd>
                <dd id="RelRasco.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="RelRasco.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="RelRasco.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="RelRasco.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TriTraining">
                            <input id="TriTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TriTraining</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="TriTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining-25"><a href="#TriTraining-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">TriTraining</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="TriTraining-26"><a href="#TriTraining-26"><span class="linenos"> 26</span></a>
</span><span id="TriTraining-27"><a href="#TriTraining-27"><span class="linenos"> 27</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TriTraining-28"><a href="#TriTraining-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TriTraining-29"><a href="#TriTraining-29"><span class="linenos"> 29</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="TriTraining-30"><a href="#TriTraining-30"><span class="linenos"> 30</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-31"><a href="#TriTraining-31"><span class="linenos"> 31</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-32"><a href="#TriTraining-32"><span class="linenos"> 32</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining-33"><a href="#TriTraining-33"><span class="linenos"> 33</span></a>    <span class="p">):</span>
</span><span id="TriTraining-34"><a href="#TriTraining-34"><span class="linenos"> 34</span></a>        <span class="sd">&quot;&quot;&quot;TriTraining. Trio of classifiers with bootstrapping.</span>
</span><span id="TriTraining-35"><a href="#TriTraining-35"><span class="linenos"> 35</span></a>
</span><span id="TriTraining-36"><a href="#TriTraining-36"><span class="linenos"> 36</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-37"><a href="#TriTraining-37"><span class="linenos"> 37</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-38"><a href="#TriTraining-38"><span class="linenos"> 38</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="TriTraining-39"><a href="#TriTraining-39"><span class="linenos"> 39</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="TriTraining-40"><a href="#TriTraining-40"><span class="linenos"> 40</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="TriTraining-41"><a href="#TriTraining-41"><span class="linenos"> 41</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="TriTraining-42"><a href="#TriTraining-42"><span class="linenos"> 42</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="TriTraining-43"><a href="#TriTraining-43"><span class="linenos"> 43</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining-44"><a href="#TriTraining-44"><span class="linenos"> 44</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining-45"><a href="#TriTraining-45"><span class="linenos"> 45</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="TriTraining-46"><a href="#TriTraining-46"><span class="linenos"> 46</span></a><span class="sd">            The number of jobs to run in parallel for both `fit` and `predict`.</span>
</span><span id="TriTraining-47"><a href="#TriTraining-47"><span class="linenos"> 47</span></a><span class="sd">            `None` means 1 unless in a :obj:`joblib.parallel_backend` context.</span>
</span><span id="TriTraining-48"><a href="#TriTraining-48"><span class="linenos"> 48</span></a><span class="sd">            `-1` means using all processors., by default None</span>
</span><span id="TriTraining-49"><a href="#TriTraining-49"><span class="linenos"> 49</span></a>
</span><span id="TriTraining-50"><a href="#TriTraining-50"><span class="linenos"> 50</span></a><span class="sd">        References</span>
</span><span id="TriTraining-51"><a href="#TriTraining-51"><span class="linenos"> 51</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-52"><a href="#TriTraining-52"><span class="linenos"> 52</span></a><span class="sd">        Zhi-Hua Zhou and Ming Li,</span>
</span><span id="TriTraining-53"><a href="#TriTraining-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;Tri-training: exploiting unlabeled data using three classifiers,&quot;</span>
</span><span id="TriTraining-54"><a href="#TriTraining-54"><span class="linenos"> 54</span></a><span class="sd">        in &lt;i&gt;IEEE Transactions on Knowledge and Data Engineering&lt;/i&gt;,</span>
</span><span id="TriTraining-55"><a href="#TriTraining-55"><span class="linenos"> 55</span></a><span class="sd">        vol. 17, no. 11, pp. 1529-1541, Nov. 2005,</span>
</span><span id="TriTraining-56"><a href="#TriTraining-56"><span class="linenos"> 56</span></a><span class="sd">        doi: 10.1109/TKDE.2005.186.</span>
</span><span id="TriTraining-57"><a href="#TriTraining-57"><span class="linenos"> 57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-58"><a href="#TriTraining-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="TriTraining-59"><a href="#TriTraining-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-60"><a href="#TriTraining-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_samples</span>
</span><span id="TriTraining-61"><a href="#TriTraining-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="TriTraining-62"><a href="#TriTraining-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="TriTraining-63"><a href="#TriTraining-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="TriTraining-64"><a href="#TriTraining-64"><span class="linenos"> 64</span></a>
</span><span id="TriTraining-65"><a href="#TriTraining-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining-66"><a href="#TriTraining-66"><span class="linenos"> 66</span></a>        <span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="TriTraining-67"><a href="#TriTraining-67"><span class="linenos"> 67</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-68"><a href="#TriTraining-68"><span class="linenos"> 68</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-69"><a href="#TriTraining-69"><span class="linenos"> 69</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining-70"><a href="#TriTraining-70"><span class="linenos"> 70</span></a><span class="sd">            The training input samples.</span>
</span><span id="TriTraining-71"><a href="#TriTraining-71"><span class="linenos"> 71</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining-72"><a href="#TriTraining-72"><span class="linenos"> 72</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="TriTraining-73"><a href="#TriTraining-73"><span class="linenos"> 73</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-74"><a href="#TriTraining-74"><span class="linenos"> 74</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-75"><a href="#TriTraining-75"><span class="linenos"> 75</span></a><span class="sd">        self : TriTraining</span>
</span><span id="TriTraining-76"><a href="#TriTraining-76"><span class="linenos"> 76</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="TriTraining-77"><a href="#TriTraining-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-78"><a href="#TriTraining-78"><span class="linenos"> 78</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining-79"><a href="#TriTraining-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-80"><a href="#TriTraining-80"><span class="linenos"> 80</span></a>
</span><span id="TriTraining-81"><a href="#TriTraining-81"><span class="linenos"> 81</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="TriTraining-82"><a href="#TriTraining-82"><span class="linenos"> 82</span></a>
</span><span id="TriTraining-83"><a href="#TriTraining-83"><span class="linenos"> 83</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="TriTraining-84"><a href="#TriTraining-84"><span class="linenos"> 84</span></a>
</span><span id="TriTraining-85"><a href="#TriTraining-85"><span class="linenos"> 85</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-86"><a href="#TriTraining-86"><span class="linenos"> 86</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-87"><a href="#TriTraining-87"><span class="linenos"> 87</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-88"><a href="#TriTraining-88"><span class="linenos"> 88</span></a>
</span><span id="TriTraining-89"><a href="#TriTraining-89"><span class="linenos"> 89</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="TriTraining-90"><a href="#TriTraining-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-91"><a href="#TriTraining-91"><span class="linenos"> 91</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="TriTraining-92"><a href="#TriTraining-92"><span class="linenos"> 92</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining-93"><a href="#TriTraining-93"><span class="linenos"> 93</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining-94"><a href="#TriTraining-94"><span class="linenos"> 94</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-95"><a href="#TriTraining-95"><span class="linenos"> 95</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-96"><a href="#TriTraining-96"><span class="linenos"> 96</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining-97"><a href="#TriTraining-97"><span class="linenos"> 97</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="TriTraining-98"><a href="#TriTraining-98"><span class="linenos"> 98</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="TriTraining-99"><a href="#TriTraining-99"><span class="linenos"> 99</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining-100"><a href="#TriTraining-100"><span class="linenos">100</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="TriTraining-101"><a href="#TriTraining-101"><span class="linenos">101</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining-102"><a href="#TriTraining-102"><span class="linenos">102</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining-103"><a href="#TriTraining-103"><span class="linenos">103</span></a>                <span class="k">break</span>
</span><span id="TriTraining-104"><a href="#TriTraining-104"><span class="linenos">104</span></a>
</span><span id="TriTraining-105"><a href="#TriTraining-105"><span class="linenos">105</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-106"><a href="#TriTraining-106"><span class="linenos">106</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="TriTraining-107"><a href="#TriTraining-107"><span class="linenos">107</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="TriTraining-108"><a href="#TriTraining-108"><span class="linenos">108</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="TriTraining-109"><a href="#TriTraining-109"><span class="linenos">109</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="TriTraining-110"><a href="#TriTraining-110"><span class="linenos">110</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="TriTraining-111"><a href="#TriTraining-111"><span class="linenos">111</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining-112"><a href="#TriTraining-112"><span class="linenos">112</span></a>            <span class="p">)</span>
</span><span id="TriTraining-113"><a href="#TriTraining-113"><span class="linenos">113</span></a>
</span><span id="TriTraining-114"><a href="#TriTraining-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-115"><a href="#TriTraining-115"><span class="linenos">115</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining-116"><a href="#TriTraining-116"><span class="linenos">116</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="TriTraining-117"><a href="#TriTraining-117"><span class="linenos">117</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining-118"><a href="#TriTraining-118"><span class="linenos">118</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining-119"><a href="#TriTraining-119"><span class="linenos">119</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining-120"><a href="#TriTraining-120"><span class="linenos">120</span></a>
</span><span id="TriTraining-121"><a href="#TriTraining-121"><span class="linenos">121</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining-122"><a href="#TriTraining-122"><span class="linenos">122</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining-123"><a href="#TriTraining-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="TriTraining-124"><a href="#TriTraining-124"><span class="linenos">124</span></a>
</span><span id="TriTraining-125"><a href="#TriTraining-125"><span class="linenos">125</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TriTraining-126"><a href="#TriTraining-126"><span class="linenos">126</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="TriTraining-127"><a href="#TriTraining-127"><span class="linenos">127</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TriTraining-128"><a href="#TriTraining-128"><span class="linenos">128</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-129"><a href="#TriTraining-129"><span class="linenos">129</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-130"><a href="#TriTraining-130"><span class="linenos">130</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-131"><a href="#TriTraining-131"><span class="linenos">131</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="TriTraining-132"><a href="#TriTraining-132"><span class="linenos">132</span></a>
</span><span id="TriTraining-133"><a href="#TriTraining-133"><span class="linenos">133</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-134"><a href="#TriTraining-134"><span class="linenos">134</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="TriTraining-135"><a href="#TriTraining-135"><span class="linenos">135</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining-136"><a href="#TriTraining-136"><span class="linenos">136</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span>
</span><span id="TriTraining-137"><a href="#TriTraining-137"><span class="linenos">137</span></a>                <span class="p">)</span>
</span><span id="TriTraining-138"><a href="#TriTraining-138"><span class="linenos">138</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-139"><a href="#TriTraining-139"><span class="linenos">139</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining-140"><a href="#TriTraining-140"><span class="linenos">140</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining-141"><a href="#TriTraining-141"><span class="linenos">141</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining-142"><a href="#TriTraining-142"><span class="linenos">142</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining-143"><a href="#TriTraining-143"><span class="linenos">143</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining-144"><a href="#TriTraining-144"><span class="linenos">144</span></a>
</span><span id="TriTraining-145"><a href="#TriTraining-145"><span class="linenos">145</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining-146"><a href="#TriTraining-146"><span class="linenos">146</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="TriTraining-147"><a href="#TriTraining-147"><span class="linenos">147</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TriTraining-148"><a href="#TriTraining-148"><span class="linenos">148</span></a>                    <span class="p">)</span>
</span><span id="TriTraining-149"><a href="#TriTraining-149"><span class="linenos">149</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="TriTraining-150"><a href="#TriTraining-150"><span class="linenos">150</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining-151"><a href="#TriTraining-151"><span class="linenos">151</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-152"><a href="#TriTraining-152"><span class="linenos">152</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-153"><a href="#TriTraining-153"><span class="linenos">153</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="TriTraining-154"><a href="#TriTraining-154"><span class="linenos">154</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="TriTraining-155"><a href="#TriTraining-155"><span class="linenos">155</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="TriTraining-156"><a href="#TriTraining-156"><span class="linenos">156</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="TriTraining-157"><a href="#TriTraining-157"><span class="linenos">157</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="TriTraining-158"><a href="#TriTraining-158"><span class="linenos">158</span></a>                        <span class="p">),</span>
</span><span id="TriTraining-159"><a href="#TriTraining-159"><span class="linenos">159</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining-160"><a href="#TriTraining-160"><span class="linenos">160</span></a>                    <span class="p">)</span>
</span><span id="TriTraining-161"><a href="#TriTraining-161"><span class="linenos">161</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining-162"><a href="#TriTraining-162"><span class="linenos">162</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining-163"><a href="#TriTraining-163"><span class="linenos">163</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-164"><a href="#TriTraining-164"><span class="linenos">164</span></a>
</span><span id="TriTraining-165"><a href="#TriTraining-165"><span class="linenos">165</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="TriTraining-166"><a href="#TriTraining-166"><span class="linenos">166</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="TriTraining-167"><a href="#TriTraining-167"><span class="linenos">167</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining-168"><a href="#TriTraining-168"><span class="linenos">168</span></a>                <span class="p">)</span>
</span><span id="TriTraining-169"><a href="#TriTraining-169"><span class="linenos">169</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining-170"><a href="#TriTraining-170"><span class="linenos">170</span></a>            <span class="p">)</span>
</span><span id="TriTraining-171"><a href="#TriTraining-171"><span class="linenos">171</span></a>
</span><span id="TriTraining-172"><a href="#TriTraining-172"><span class="linenos">172</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining-173"><a href="#TriTraining-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining-174"><a href="#TriTraining-174"><span class="linenos">174</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="TriTraining-175"><a href="#TriTraining-175"><span class="linenos">175</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining-176"><a href="#TriTraining-176"><span class="linenos">176</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining-177"><a href="#TriTraining-177"><span class="linenos">177</span></a>
</span><span id="TriTraining-178"><a href="#TriTraining-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="TriTraining-179"><a href="#TriTraining-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining-180"><a href="#TriTraining-180"><span class="linenos">180</span></a>
</span><span id="TriTraining-181"><a href="#TriTraining-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="TriTraining-182"><a href="#TriTraining-182"><span class="linenos">182</span></a>
</span><span id="TriTraining-183"><a href="#TriTraining-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining-184"><a href="#TriTraining-184"><span class="linenos">184</span></a>        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
</span><span id="TriTraining-185"><a href="#TriTraining-185"><span class="linenos">185</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="TriTraining-186"><a href="#TriTraining-186"><span class="linenos">186</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>
</span><span id="TriTraining-187"><a href="#TriTraining-187"><span class="linenos">187</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining-188"><a href="#TriTraining-188"><span class="linenos">188</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</span><span id="TriTraining-189"><a href="#TriTraining-189"><span class="linenos">189</span></a>            <span class="n">_tempY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">Ly</span><span class="p">))</span>
</span><span id="TriTraining-190"><a href="#TriTraining-190"><span class="linenos">190</span></a>
</span><span id="TriTraining-191"><a href="#TriTraining-191"><span class="linenos">191</span></a>            <span class="k">return</span> <span class="n">hyp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">_tempL</span><span class="p">,</span> <span class="n">_tempY</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining-192"><a href="#TriTraining-192"><span class="linenos">192</span></a>        <span class="k">return</span> <span class="n">hyp</span>
</span><span id="TriTraining-193"><a href="#TriTraining-193"><span class="linenos">193</span></a>
</span><span id="TriTraining-194"><a href="#TriTraining-194"><span class="linenos">194</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TriTraining-195"><a href="#TriTraining-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">_another_hs</span><span class="p">(</span><span class="n">hs</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="TriTraining-196"><a href="#TriTraining-196"><span class="linenos">196</span></a>        <span class="sd">&quot;&quot;&quot;Get the other hypotheses</span>
</span><span id="TriTraining-197"><a href="#TriTraining-197"><span class="linenos">197</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-198"><a href="#TriTraining-198"><span class="linenos">198</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-199"><a href="#TriTraining-199"><span class="linenos">199</span></a><span class="sd">        hs : list</span>
</span><span id="TriTraining-200"><a href="#TriTraining-200"><span class="linenos">200</span></a><span class="sd">            hypotheses collection</span>
</span><span id="TriTraining-201"><a href="#TriTraining-201"><span class="linenos">201</span></a><span class="sd">        index : int</span>
</span><span id="TriTraining-202"><a href="#TriTraining-202"><span class="linenos">202</span></a><span class="sd">            base hypothesis  index</span>
</span><span id="TriTraining-203"><a href="#TriTraining-203"><span class="linenos">203</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-204"><a href="#TriTraining-204"><span class="linenos">204</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-205"><a href="#TriTraining-205"><span class="linenos">205</span></a><span class="sd">        classifiers: list</span>
</span><span id="TriTraining-206"><a href="#TriTraining-206"><span class="linenos">206</span></a><span class="sd">            Collection of other hypotheses</span>
</span><span id="TriTraining-207"><a href="#TriTraining-207"><span class="linenos">207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-208"><a href="#TriTraining-208"><span class="linenos">208</span></a>        <span class="n">another_hs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining-209"><a href="#TriTraining-209"><span class="linenos">209</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hs</span><span class="p">)):</span>
</span><span id="TriTraining-210"><a href="#TriTraining-210"><span class="linenos">210</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">:</span>
</span><span id="TriTraining-211"><a href="#TriTraining-211"><span class="linenos">211</span></a>                <span class="n">another_hs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining-212"><a href="#TriTraining-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="n">another_hs</span>
</span><span id="TriTraining-213"><a href="#TriTraining-213"><span class="linenos">213</span></a>
</span><span id="TriTraining-214"><a href="#TriTraining-214"><span class="linenos">214</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TriTraining-215"><a href="#TriTraining-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">_subsample</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TriTraining-216"><a href="#TriTraining-216"><span class="linenos">216</span></a>        <span class="sd">&quot;&quot;&quot;Randomly removes |L| - s number of examples from L</span>
</span><span id="TriTraining-217"><a href="#TriTraining-217"><span class="linenos">217</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-218"><a href="#TriTraining-218"><span class="linenos">218</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-219"><a href="#TriTraining-219"><span class="linenos">219</span></a><span class="sd">        L : tuple of array-like</span>
</span><span id="TriTraining-220"><a href="#TriTraining-220"><span class="linenos">220</span></a><span class="sd">            Collection pseudo-labeled candidates and its labels</span>
</span><span id="TriTraining-221"><a href="#TriTraining-221"><span class="linenos">221</span></a><span class="sd">        s : int</span>
</span><span id="TriTraining-222"><a href="#TriTraining-222"><span class="linenos">222</span></a><span class="sd">            Equation 10 in paper</span>
</span><span id="TriTraining-223"><a href="#TriTraining-223"><span class="linenos">223</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining-224"><a href="#TriTraining-224"><span class="linenos">224</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining-225"><a href="#TriTraining-225"><span class="linenos">225</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-226"><a href="#TriTraining-226"><span class="linenos">226</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-227"><a href="#TriTraining-227"><span class="linenos">227</span></a><span class="sd">        subsamples: tuple</span>
</span><span id="TriTraining-228"><a href="#TriTraining-228"><span class="linenos">228</span></a><span class="sd">            Collection of pseudo-labeled selected for enlarged labeled examples.</span>
</span><span id="TriTraining-229"><a href="#TriTraining-229"><span class="linenos">229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-230"><a href="#TriTraining-230"><span class="linenos">230</span></a>        <span class="n">to_remove</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">s</span>
</span><span id="TriTraining-231"><a href="#TriTraining-231"><span class="linenos">231</span></a>        <span class="n">select</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">to_remove</span>
</span><span id="TriTraining-232"><a href="#TriTraining-232"><span class="linenos">232</span></a>
</span><span id="TriTraining-233"><a href="#TriTraining-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="n">resample</span><span class="p">(</span><span class="o">*</span><span class="n">L</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">select</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining-234"><a href="#TriTraining-234"><span class="linenos">234</span></a>
</span><span id="TriTraining-235"><a href="#TriTraining-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">_measure_error</span><span class="p">(</span>
</span><span id="TriTraining-236"><a href="#TriTraining-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h1</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">h2</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining-237"><a href="#TriTraining-237"><span class="linenos">237</span></a>    <span class="p">):</span>
</span><span id="TriTraining-238"><a href="#TriTraining-238"><span class="linenos">238</span></a>        <span class="sd">&quot;&quot;&quot;Calculate the error between two hypotheses</span>
</span><span id="TriTraining-239"><a href="#TriTraining-239"><span class="linenos">239</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining-240"><a href="#TriTraining-240"><span class="linenos">240</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining-241"><a href="#TriTraining-241"><span class="linenos">241</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining-242"><a href="#TriTraining-242"><span class="linenos">242</span></a><span class="sd">            The training labeled input samples.</span>
</span><span id="TriTraining-243"><a href="#TriTraining-243"><span class="linenos">243</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining-244"><a href="#TriTraining-244"><span class="linenos">244</span></a><span class="sd">            The target values (class labels).</span>
</span><span id="TriTraining-245"><a href="#TriTraining-245"><span class="linenos">245</span></a><span class="sd">        h1 : ClassifierMixin</span>
</span><span id="TriTraining-246"><a href="#TriTraining-246"><span class="linenos">246</span></a><span class="sd">            First hypothesis</span>
</span><span id="TriTraining-247"><a href="#TriTraining-247"><span class="linenos">247</span></a><span class="sd">        h2 : ClassifierMixin</span>
</span><span id="TriTraining-248"><a href="#TriTraining-248"><span class="linenos">248</span></a><span class="sd">            Second hypothesis</span>
</span><span id="TriTraining-249"><a href="#TriTraining-249"><span class="linenos">249</span></a><span class="sd">        epsilon : float</span>
</span><span id="TriTraining-250"><a href="#TriTraining-250"><span class="linenos">250</span></a><span class="sd">            A small number to avoid division by zero</span>
</span><span id="TriTraining-251"><a href="#TriTraining-251"><span class="linenos">251</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining-252"><a href="#TriTraining-252"><span class="linenos">252</span></a><span class="sd">        -------</span>
</span><span id="TriTraining-253"><a href="#TriTraining-253"><span class="linenos">253</span></a><span class="sd">        error : float</span>
</span><span id="TriTraining-254"><a href="#TriTraining-254"><span class="linenos">254</span></a><span class="sd">            Division of the number of labeled examples on which both h1 and h2 make incorrect classification,</span>
</span><span id="TriTraining-255"><a href="#TriTraining-255"><span class="linenos">255</span></a><span class="sd">            by the number of labeled examples on which the classification made by h1 is the same as that made by h2.</span>
</span><span id="TriTraining-256"><a href="#TriTraining-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining-257"><a href="#TriTraining-257"><span class="linenos">257</span></a>        <span class="n">y1</span> <span class="o">=</span> <span class="n">h1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="TriTraining-258"><a href="#TriTraining-258"><span class="linenos">258</span></a>        <span class="n">y2</span> <span class="o">=</span> <span class="n">h2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="TriTraining-259"><a href="#TriTraining-259"><span class="linenos">259</span></a>
</span><span id="TriTraining-260"><a href="#TriTraining-260"><span class="linenos">260</span></a>        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">!=</span> <span class="n">y</span><span class="p">))</span>
</span><span id="TriTraining-261"><a href="#TriTraining-261"><span class="linenos">261</span></a>        <span class="n">coincidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">)</span>
</span><span id="TriTraining-262"><a href="#TriTraining-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">coincidence</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#TriTraining.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="TriTraining.__init__" class="classattr">
                                        <input id="TriTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TriTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="TriTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining.__init__-27"><a href="#TriTraining.__init__-27"><span class="linenos">27</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="TriTraining.__init__-28"><a href="#TriTraining.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="TriTraining.__init__-29"><a href="#TriTraining.__init__-29"><span class="linenos">29</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="TriTraining.__init__-30"><a href="#TriTraining.__init__-30"><span class="linenos">30</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-31"><a href="#TriTraining.__init__-31"><span class="linenos">31</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-32"><a href="#TriTraining.__init__-32"><span class="linenos">32</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TriTraining.__init__-33"><a href="#TriTraining.__init__-33"><span class="linenos">33</span></a>    <span class="p">):</span>
</span><span id="TriTraining.__init__-34"><a href="#TriTraining.__init__-34"><span class="linenos">34</span></a>        <span class="sd">&quot;&quot;&quot;TriTraining. Trio of classifiers with bootstrapping.</span>
</span><span id="TriTraining.__init__-35"><a href="#TriTraining.__init__-35"><span class="linenos">35</span></a>
</span><span id="TriTraining.__init__-36"><a href="#TriTraining.__init__-36"><span class="linenos">36</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining.__init__-37"><a href="#TriTraining.__init__-37"><span class="linenos">37</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining.__init__-38"><a href="#TriTraining.__init__-38"><span class="linenos">38</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="TriTraining.__init__-39"><a href="#TriTraining.__init__-39"><span class="linenos">39</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="TriTraining.__init__-40"><a href="#TriTraining.__init__-40"><span class="linenos">40</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="TriTraining.__init__-41"><a href="#TriTraining.__init__-41"><span class="linenos">41</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="TriTraining.__init__-42"><a href="#TriTraining.__init__-42"><span class="linenos">42</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="TriTraining.__init__-43"><a href="#TriTraining.__init__-43"><span class="linenos">43</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="TriTraining.__init__-44"><a href="#TriTraining.__init__-44"><span class="linenos">44</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="TriTraining.__init__-45"><a href="#TriTraining.__init__-45"><span class="linenos">45</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="TriTraining.__init__-46"><a href="#TriTraining.__init__-46"><span class="linenos">46</span></a><span class="sd">            The number of jobs to run in parallel for both `fit` and `predict`.</span>
</span><span id="TriTraining.__init__-47"><a href="#TriTraining.__init__-47"><span class="linenos">47</span></a><span class="sd">            `None` means 1 unless in a :obj:`joblib.parallel_backend` context.</span>
</span><span id="TriTraining.__init__-48"><a href="#TriTraining.__init__-48"><span class="linenos">48</span></a><span class="sd">            `-1` means using all processors., by default None</span>
</span><span id="TriTraining.__init__-49"><a href="#TriTraining.__init__-49"><span class="linenos">49</span></a>
</span><span id="TriTraining.__init__-50"><a href="#TriTraining.__init__-50"><span class="linenos">50</span></a><span class="sd">        References</span>
</span><span id="TriTraining.__init__-51"><a href="#TriTraining.__init__-51"><span class="linenos">51</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining.__init__-52"><a href="#TriTraining.__init__-52"><span class="linenos">52</span></a><span class="sd">        Zhi-Hua Zhou and Ming Li,</span>
</span><span id="TriTraining.__init__-53"><a href="#TriTraining.__init__-53"><span class="linenos">53</span></a><span class="sd">        &quot;Tri-training: exploiting unlabeled data using three classifiers,&quot;</span>
</span><span id="TriTraining.__init__-54"><a href="#TriTraining.__init__-54"><span class="linenos">54</span></a><span class="sd">        in &lt;i&gt;IEEE Transactions on Knowledge and Data Engineering&lt;/i&gt;,</span>
</span><span id="TriTraining.__init__-55"><a href="#TriTraining.__init__-55"><span class="linenos">55</span></a><span class="sd">        vol. 17, no. 11, pp. 1529-1541, Nov. 2005,</span>
</span><span id="TriTraining.__init__-56"><a href="#TriTraining.__init__-56"><span class="linenos">56</span></a><span class="sd">        doi: 10.1109/TKDE.2005.186.</span>
</span><span id="TriTraining.__init__-57"><a href="#TriTraining.__init__-57"><span class="linenos">57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining.__init__-58"><a href="#TriTraining.__init__-58"><span class="linenos">58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="TriTraining.__init__-59"><a href="#TriTraining.__init__-59"><span class="linenos">59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.__init__-60"><a href="#TriTraining.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_samples</span>
</span><span id="TriTraining.__init__-61"><a href="#TriTraining.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="TriTraining.__init__-62"><a href="#TriTraining.__init__-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="TriTraining.__init__-63"><a href="#TriTraining.__init__-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span></pre></div>


            <div class="docstring"><p>TriTraining. Trio of classifiers with bootstrapping.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_samples</strong> (int, optional):
Number of samples to generate.
If left to None this is automatically set to the first dimension of the arrays., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel for both <code><a href="#TriTraining.fit">fit</a></code> and <code><a href="#TriTraining.predict">predict</a></code>.
<code>None</code> means 1 unless in a <code>joblib.parallel_backend</code> context.
<code>-1</code> means using all processors., by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Zhi-Hua Zhou and Ming Li,
"Tri-training: exploiting unlabeled data using three classifiers,"
in <i>IEEE Transactions on Knowledge and Data Engineering</i>,
vol. 17, no. 11, pp. 1529-1541, Nov. 2005,
doi: 10.1109/TKDE.2005.186.</p>
</div>


                            </div>
                            <div id="TriTraining.fit" class="classattr">
                                        <input id="TriTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TriTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TriTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TriTraining.fit-65"><a href="#TriTraining.fit-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="TriTraining.fit-66"><a href="#TriTraining.fit-66"><span class="linenos"> 66</span></a>        <span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="TriTraining.fit-67"><a href="#TriTraining.fit-67"><span class="linenos"> 67</span></a><span class="sd">        Parameters</span>
</span><span id="TriTraining.fit-68"><a href="#TriTraining.fit-68"><span class="linenos"> 68</span></a><span class="sd">        ----------</span>
</span><span id="TriTraining.fit-69"><a href="#TriTraining.fit-69"><span class="linenos"> 69</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="TriTraining.fit-70"><a href="#TriTraining.fit-70"><span class="linenos"> 70</span></a><span class="sd">            The training input samples.</span>
</span><span id="TriTraining.fit-71"><a href="#TriTraining.fit-71"><span class="linenos"> 71</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="TriTraining.fit-72"><a href="#TriTraining.fit-72"><span class="linenos"> 72</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="TriTraining.fit-73"><a href="#TriTraining.fit-73"><span class="linenos"> 73</span></a><span class="sd">        Returns</span>
</span><span id="TriTraining.fit-74"><a href="#TriTraining.fit-74"><span class="linenos"> 74</span></a><span class="sd">        -------</span>
</span><span id="TriTraining.fit-75"><a href="#TriTraining.fit-75"><span class="linenos"> 75</span></a><span class="sd">        self : TriTraining</span>
</span><span id="TriTraining.fit-76"><a href="#TriTraining.fit-76"><span class="linenos"> 76</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="TriTraining.fit-77"><a href="#TriTraining.fit-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TriTraining.fit-78"><a href="#TriTraining.fit-78"><span class="linenos"> 78</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="TriTraining.fit-79"><a href="#TriTraining.fit-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.fit-80"><a href="#TriTraining.fit-80"><span class="linenos"> 80</span></a>
</span><span id="TriTraining.fit-81"><a href="#TriTraining.fit-81"><span class="linenos"> 81</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="TriTraining.fit-82"><a href="#TriTraining.fit-82"><span class="linenos"> 82</span></a>
</span><span id="TriTraining.fit-83"><a href="#TriTraining.fit-83"><span class="linenos"> 83</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="TriTraining.fit-84"><a href="#TriTraining.fit-84"><span class="linenos"> 84</span></a>
</span><span id="TriTraining.fit-85"><a href="#TriTraining.fit-85"><span class="linenos"> 85</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining.fit-86"><a href="#TriTraining.fit-86"><span class="linenos"> 86</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-87"><a href="#TriTraining.fit-87"><span class="linenos"> 87</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-88"><a href="#TriTraining.fit-88"><span class="linenos"> 88</span></a>
</span><span id="TriTraining.fit-89"><a href="#TriTraining.fit-89"><span class="linenos"> 89</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="TriTraining.fit-90"><a href="#TriTraining.fit-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-91"><a href="#TriTraining.fit-91"><span class="linenos"> 91</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="TriTraining.fit-92"><a href="#TriTraining.fit-92"><span class="linenos"> 92</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining.fit-93"><a href="#TriTraining.fit-93"><span class="linenos"> 93</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="TriTraining.fit-94"><a href="#TriTraining.fit-94"><span class="linenos"> 94</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-95"><a href="#TriTraining.fit-95"><span class="linenos"> 95</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-96"><a href="#TriTraining.fit-96"><span class="linenos"> 96</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="TriTraining.fit-97"><a href="#TriTraining.fit-97"><span class="linenos"> 97</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="TriTraining.fit-98"><a href="#TriTraining.fit-98"><span class="linenos"> 98</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="TriTraining.fit-99"><a href="#TriTraining.fit-99"><span class="linenos"> 99</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining.fit-100"><a href="#TriTraining.fit-100"><span class="linenos">100</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="TriTraining.fit-101"><a href="#TriTraining.fit-101"><span class="linenos">101</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="TriTraining.fit-102"><a href="#TriTraining.fit-102"><span class="linenos">102</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining.fit-103"><a href="#TriTraining.fit-103"><span class="linenos">103</span></a>                <span class="k">break</span>
</span><span id="TriTraining.fit-104"><a href="#TriTraining.fit-104"><span class="linenos">104</span></a>
</span><span id="TriTraining.fit-105"><a href="#TriTraining.fit-105"><span class="linenos">105</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-106"><a href="#TriTraining.fit-106"><span class="linenos">106</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="TriTraining.fit-107"><a href="#TriTraining.fit-107"><span class="linenos">107</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="TriTraining.fit-108"><a href="#TriTraining.fit-108"><span class="linenos">108</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="TriTraining.fit-109"><a href="#TriTraining.fit-109"><span class="linenos">109</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="TriTraining.fit-110"><a href="#TriTraining.fit-110"><span class="linenos">110</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="TriTraining.fit-111"><a href="#TriTraining.fit-111"><span class="linenos">111</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining.fit-112"><a href="#TriTraining.fit-112"><span class="linenos">112</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-113"><a href="#TriTraining.fit-113"><span class="linenos">113</span></a>
</span><span id="TriTraining.fit-114"><a href="#TriTraining.fit-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-115"><a href="#TriTraining.fit-115"><span class="linenos">115</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining.fit-116"><a href="#TriTraining.fit-116"><span class="linenos">116</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="TriTraining.fit-117"><a href="#TriTraining.fit-117"><span class="linenos">117</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TriTraining.fit-118"><a href="#TriTraining.fit-118"><span class="linenos">118</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining.fit-119"><a href="#TriTraining.fit-119"><span class="linenos">119</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TriTraining.fit-120"><a href="#TriTraining.fit-120"><span class="linenos">120</span></a>
</span><span id="TriTraining.fit-121"><a href="#TriTraining.fit-121"><span class="linenos">121</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining.fit-122"><a href="#TriTraining.fit-122"><span class="linenos">122</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="TriTraining.fit-123"><a href="#TriTraining.fit-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-124"><a href="#TriTraining.fit-124"><span class="linenos">124</span></a>
</span><span id="TriTraining.fit-125"><a href="#TriTraining.fit-125"><span class="linenos">125</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="TriTraining.fit-126"><a href="#TriTraining.fit-126"><span class="linenos">126</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="TriTraining.fit-127"><a href="#TriTraining.fit-127"><span class="linenos">127</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TriTraining.fit-128"><a href="#TriTraining.fit-128"><span class="linenos">128</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-129"><a href="#TriTraining.fit-129"><span class="linenos">129</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-130"><a href="#TriTraining.fit-130"><span class="linenos">130</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TriTraining.fit-131"><a href="#TriTraining.fit-131"><span class="linenos">131</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="TriTraining.fit-132"><a href="#TriTraining.fit-132"><span class="linenos">132</span></a>
</span><span id="TriTraining.fit-133"><a href="#TriTraining.fit-133"><span class="linenos">133</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-134"><a href="#TriTraining.fit-134"><span class="linenos">134</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="TriTraining.fit-135"><a href="#TriTraining.fit-135"><span class="linenos">135</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="TriTraining.fit-136"><a href="#TriTraining.fit-136"><span class="linenos">136</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span>
</span><span id="TriTraining.fit-137"><a href="#TriTraining.fit-137"><span class="linenos">137</span></a>                <span class="p">)</span>
</span><span id="TriTraining.fit-138"><a href="#TriTraining.fit-138"><span class="linenos">138</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-139"><a href="#TriTraining.fit-139"><span class="linenos">139</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining.fit-140"><a href="#TriTraining.fit-140"><span class="linenos">140</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining.fit-141"><a href="#TriTraining.fit-141"><span class="linenos">141</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="TriTraining.fit-142"><a href="#TriTraining.fit-142"><span class="linenos">142</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining.fit-143"><a href="#TriTraining.fit-143"><span class="linenos">143</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="TriTraining.fit-144"><a href="#TriTraining.fit-144"><span class="linenos">144</span></a>
</span><span id="TriTraining.fit-145"><a href="#TriTraining.fit-145"><span class="linenos">145</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TriTraining.fit-146"><a href="#TriTraining.fit-146"><span class="linenos">146</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="TriTraining.fit-147"><a href="#TriTraining.fit-147"><span class="linenos">147</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TriTraining.fit-148"><a href="#TriTraining.fit-148"><span class="linenos">148</span></a>                    <span class="p">)</span>
</span><span id="TriTraining.fit-149"><a href="#TriTraining.fit-149"><span class="linenos">149</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="TriTraining.fit-150"><a href="#TriTraining.fit-150"><span class="linenos">150</span></a>                    <span class="k">continue</span>
</span><span id="TriTraining.fit-151"><a href="#TriTraining.fit-151"><span class="linenos">151</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-152"><a href="#TriTraining.fit-152"><span class="linenos">152</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-153"><a href="#TriTraining.fit-153"><span class="linenos">153</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="TriTraining.fit-154"><a href="#TriTraining.fit-154"><span class="linenos">154</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="TriTraining.fit-155"><a href="#TriTraining.fit-155"><span class="linenos">155</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="TriTraining.fit-156"><a href="#TriTraining.fit-156"><span class="linenos">156</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="TriTraining.fit-157"><a href="#TriTraining.fit-157"><span class="linenos">157</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="TriTraining.fit-158"><a href="#TriTraining.fit-158"><span class="linenos">158</span></a>                        <span class="p">),</span>
</span><span id="TriTraining.fit-159"><a href="#TriTraining.fit-159"><span class="linenos">159</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="TriTraining.fit-160"><a href="#TriTraining.fit-160"><span class="linenos">160</span></a>                    <span class="p">)</span>
</span><span id="TriTraining.fit-161"><a href="#TriTraining.fit-161"><span class="linenos">161</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="TriTraining.fit-162"><a href="#TriTraining.fit-162"><span class="linenos">162</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="TriTraining.fit-163"><a href="#TriTraining.fit-163"><span class="linenos">163</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-164"><a href="#TriTraining.fit-164"><span class="linenos">164</span></a>
</span><span id="TriTraining.fit-165"><a href="#TriTraining.fit-165"><span class="linenos">165</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="TriTraining.fit-166"><a href="#TriTraining.fit-166"><span class="linenos">166</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="TriTraining.fit-167"><a href="#TriTraining.fit-167"><span class="linenos">167</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="TriTraining.fit-168"><a href="#TriTraining.fit-168"><span class="linenos">168</span></a>                <span class="p">)</span>
</span><span id="TriTraining.fit-169"><a href="#TriTraining.fit-169"><span class="linenos">169</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="TriTraining.fit-170"><a href="#TriTraining.fit-170"><span class="linenos">170</span></a>            <span class="p">)</span>
</span><span id="TriTraining.fit-171"><a href="#TriTraining.fit-171"><span class="linenos">171</span></a>
</span><span id="TriTraining.fit-172"><a href="#TriTraining.fit-172"><span class="linenos">172</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="TriTraining.fit-173"><a href="#TriTraining.fit-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="TriTraining.fit-174"><a href="#TriTraining.fit-174"><span class="linenos">174</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="TriTraining.fit-175"><a href="#TriTraining.fit-175"><span class="linenos">175</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="TriTraining.fit-176"><a href="#TriTraining.fit-176"><span class="linenos">176</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TriTraining.fit-177"><a href="#TriTraining.fit-177"><span class="linenos">177</span></a>
</span><span id="TriTraining.fit-178"><a href="#TriTraining.fit-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="TriTraining.fit-179"><a href="#TriTraining.fit-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="TriTraining.fit-180"><a href="#TriTraining.fit-180"><span class="linenos">180</span></a>
</span><span id="TriTraining.fit-181"><a href="#TriTraining.fit-181"><span class="linenos">181</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a TriTraining classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (TriTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="TriTraining.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#TriTraining.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="TriTraining.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="TriTraining.get_params" class="function">get_params</dd>
                <dd id="TriTraining.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="TriTraining.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="TriTraining.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="TriTraining.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="WiWTriTraining">
                            <input id="WiWTriTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">WiWTriTraining</span><wbr>(<span class="base"><a href="#TriTraining">sslearn.wrapper.TriTraining</a></span>):

                <label class="view-source-button" for="WiWTriTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WiWTriTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WiWTriTraining-265"><a href="#WiWTriTraining-265"><span class="linenos">265</span></a><span class="k">class</span> <span class="nc">WiWTriTraining</span><span class="p">(</span><span class="n">TriTraining</span><span class="p">):</span>
</span><span id="WiWTriTraining-266"><a href="#WiWTriTraining-266"><span class="linenos">266</span></a>
</span><span id="WiWTriTraining-267"><a href="#WiWTriTraining-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="WiWTriTraining-268"><a href="#WiWTriTraining-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WiWTriTraining-269"><a href="#WiWTriTraining-269"><span class="linenos">269</span></a>        <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="WiWTriTraining-270"><a href="#WiWTriTraining-270"><span class="linenos">270</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="WiWTriTraining-271"><a href="#WiWTriTraining-271"><span class="linenos">271</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WiWTriTraining-272"><a href="#WiWTriTraining-272"><span class="linenos">272</span></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;hungarian&quot;</span><span class="p">,</span>
</span><span id="WiWTriTraining-273"><a href="#WiWTriTraining-273"><span class="linenos">273</span></a>        <span class="n">conflict_weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="WiWTriTraining-274"><a href="#WiWTriTraining-274"><span class="linenos">274</span></a>        <span class="n">conflict_over</span><span class="o">=</span><span class="s2">&quot;labeled&quot;</span><span class="p">,</span>
</span><span id="WiWTriTraining-275"><a href="#WiWTriTraining-275"><span class="linenos">275</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WiWTriTraining-276"><a href="#WiWTriTraining-276"><span class="linenos">276</span></a>    <span class="p">):</span>
</span><span id="WiWTriTraining-277"><a href="#WiWTriTraining-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot;TriTraining with restriction Who-is-Who.</span>
</span><span id="WiWTriTraining-278"><a href="#WiWTriTraining-278"><span class="linenos">278</span></a>
</span><span id="WiWTriTraining-279"><a href="#WiWTriTraining-279"><span class="linenos">279</span></a><span class="sd">        Parameters</span>
</span><span id="WiWTriTraining-280"><a href="#WiWTriTraining-280"><span class="linenos">280</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining-281"><a href="#WiWTriTraining-281"><span class="linenos">281</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="WiWTriTraining-282"><a href="#WiWTriTraining-282"><span class="linenos">282</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="WiWTriTraining-283"><a href="#WiWTriTraining-283"><span class="linenos">283</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="WiWTriTraining-284"><a href="#WiWTriTraining-284"><span class="linenos">284</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="WiWTriTraining-285"><a href="#WiWTriTraining-285"><span class="linenos">285</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="WiWTriTraining-286"><a href="#WiWTriTraining-286"><span class="linenos">286</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="WiWTriTraining-287"><a href="#WiWTriTraining-287"><span class="linenos">287</span></a><span class="sd">           Number of jobs to run in parallel. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors., by default None</span>
</span><span id="WiWTriTraining-288"><a href="#WiWTriTraining-288"><span class="linenos">288</span></a><span class="sd">        method : str, optional</span>
</span><span id="WiWTriTraining-289"><a href="#WiWTriTraining-289"><span class="linenos">289</span></a><span class="sd">            The method to use to assing class, it can be `greedy` to first-look or `hungarian` to use the Hungarian algorithm, by default &quot;hungarian&quot;</span>
</span><span id="WiWTriTraining-290"><a href="#WiWTriTraining-290"><span class="linenos">290</span></a><span class="sd">        conflict_weighted : bool, default=True</span>
</span><span id="WiWTriTraining-291"><a href="#WiWTriTraining-291"><span class="linenos">291</span></a><span class="sd">            Whether to weighted the confusion rate by the number of instances with the same group.</span>
</span><span id="WiWTriTraining-292"><a href="#WiWTriTraining-292"><span class="linenos">292</span></a><span class="sd">        conflict_over : str, optional</span>
</span><span id="WiWTriTraining-293"><a href="#WiWTriTraining-293"><span class="linenos">293</span></a><span class="sd">            The conflict rate penalizes the &quot;measure error&quot; of basic TriTraining, it can be calculated over differentes subsamples of X, can be:</span>
</span><span id="WiWTriTraining-294"><a href="#WiWTriTraining-294"><span class="linenos">294</span></a><span class="sd">            * &quot;labeled&quot; over complete L,</span>
</span><span id="WiWTriTraining-295"><a href="#WiWTriTraining-295"><span class="linenos">295</span></a><span class="sd">            * &quot;labeled_plus&quot; over complete L union L&#39;,</span>
</span><span id="WiWTriTraining-296"><a href="#WiWTriTraining-296"><span class="linenos">296</span></a><span class="sd">            * &quot;unlabeled¨: over complete U,</span>
</span><span id="WiWTriTraining-297"><a href="#WiWTriTraining-297"><span class="linenos">297</span></a><span class="sd">            * &quot;all&quot;: over complete X (LuU) and</span>
</span><span id="WiWTriTraining-298"><a href="#WiWTriTraining-298"><span class="linenos">298</span></a><span class="sd">            * &quot;none&quot;: don&#39;t penalize the &quot;meause error&quot;, by default &quot;labeled&quot;</span>
</span><span id="WiWTriTraining-299"><a href="#WiWTriTraining-299"><span class="linenos">299</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="WiWTriTraining-300"><a href="#WiWTriTraining-300"><span class="linenos">300</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="WiWTriTraining-301"><a href="#WiWTriTraining-301"><span class="linenos">301</span></a>
</span><span id="WiWTriTraining-302"><a href="#WiWTriTraining-302"><span class="linenos">302</span></a><span class="sd">        References</span>
</span><span id="WiWTriTraining-303"><a href="#WiWTriTraining-303"><span class="linenos">303</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining-304"><a href="#WiWTriTraining-304"><span class="linenos">304</span></a><span class="sd">        Ludmila I. Kuncheva, Juan J. Rodríguez, Aaron S. Jackson,</span>
</span><span id="WiWTriTraining-305"><a href="#WiWTriTraining-305"><span class="linenos">305</span></a><span class="sd">        Restricted set classification: Who is there?,</span>
</span><span id="WiWTriTraining-306"><a href="#WiWTriTraining-306"><span class="linenos">306</span></a><span class="sd">        Pattern Recognition, 63, 158-170, </span>
</span><span id="WiWTriTraining-307"><a href="#WiWTriTraining-307"><span class="linenos">307</span></a><span class="sd">        10.1016/j.patcog.2016.08.028</span>
</span><span id="WiWTriTraining-308"><a href="#WiWTriTraining-308"><span class="linenos">308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WiWTriTraining-309"><a href="#WiWTriTraining-309"><span class="linenos">309</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">)</span>
</span><span id="WiWTriTraining-310"><a href="#WiWTriTraining-310"><span class="linenos">310</span></a>        <span class="n">conflict_over_choices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;labeled&quot;</span><span class="p">,</span> <span class="s2">&quot;labeled_plus&quot;</span><span class="p">,</span> <span class="s2">&quot;unlabeled&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>
</span><span id="WiWTriTraining-311"><a href="#WiWTriTraining-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="n">conflict_over</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conflict_over_choices</span><span class="p">:</span>
</span><span id="WiWTriTraining-312"><a href="#WiWTriTraining-312"><span class="linenos">312</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WiWTriTraining-313"><a href="#WiWTriTraining-313"><span class="linenos">313</span></a>                <span class="sa">f</span><span class="s2">&quot;conflict_over must be one of </span><span class="si">{</span><span class="n">conflict_over_choices</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">conflict_over</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="WiWTriTraining-314"><a href="#WiWTriTraining-314"><span class="linenos">314</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining-315"><a href="#WiWTriTraining-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">=</span> <span class="n">conflict_over</span>
</span><span id="WiWTriTraining-316"><a href="#WiWTriTraining-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="WiWTriTraining-317"><a href="#WiWTriTraining-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conflict_weighted</span> <span class="o">=</span> <span class="n">conflict_weighted</span>
</span><span id="WiWTriTraining-318"><a href="#WiWTriTraining-318"><span class="linenos">318</span></a>
</span><span id="WiWTriTraining-319"><a href="#WiWTriTraining-319"><span class="linenos">319</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="WiWTriTraining-320"><a href="#WiWTriTraining-320"><span class="linenos">320</span></a>        <span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="WiWTriTraining-321"><a href="#WiWTriTraining-321"><span class="linenos">321</span></a><span class="sd">        Parameters</span>
</span><span id="WiWTriTraining-322"><a href="#WiWTriTraining-322"><span class="linenos">322</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining-323"><a href="#WiWTriTraining-323"><span class="linenos">323</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="WiWTriTraining-324"><a href="#WiWTriTraining-324"><span class="linenos">324</span></a><span class="sd">            The training input samples.</span>
</span><span id="WiWTriTraining-325"><a href="#WiWTriTraining-325"><span class="linenos">325</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="WiWTriTraining-326"><a href="#WiWTriTraining-326"><span class="linenos">326</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="WiWTriTraining-327"><a href="#WiWTriTraining-327"><span class="linenos">327</span></a><span class="sd">        instance_group : array-like of shape (n_samples)</span>
</span><span id="WiWTriTraining-328"><a href="#WiWTriTraining-328"><span class="linenos">328</span></a><span class="sd">            The group. Two instances with the same label are not allowed to be in the same group.</span>
</span><span id="WiWTriTraining-329"><a href="#WiWTriTraining-329"><span class="linenos">329</span></a><span class="sd">        Returns</span>
</span><span id="WiWTriTraining-330"><a href="#WiWTriTraining-330"><span class="linenos">330</span></a><span class="sd">        -------</span>
</span><span id="WiWTriTraining-331"><a href="#WiWTriTraining-331"><span class="linenos">331</span></a><span class="sd">        self : TriTraining</span>
</span><span id="WiWTriTraining-332"><a href="#WiWTriTraining-332"><span class="linenos">332</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="WiWTriTraining-333"><a href="#WiWTriTraining-333"><span class="linenos">333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WiWTriTraining-334"><a href="#WiWTriTraining-334"><span class="linenos">334</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="WiWTriTraining-335"><a href="#WiWTriTraining-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="WiWTriTraining-336"><a href="#WiWTriTraining-336"><span class="linenos">336</span></a>
</span><span id="WiWTriTraining-337"><a href="#WiWTriTraining-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="n">instance_group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WiWTriTraining-338"><a href="#WiWTriTraining-338"><span class="linenos">338</span></a>            <span class="n">warn</span><span class="p">(</span>
</span><span id="WiWTriTraining-339"><a href="#WiWTriTraining-339"><span class="linenos">339</span></a>                <span class="s2">&quot;Instance group is not provided. Each instance will belong their own group. Consider using `TriTraining`.&quot;</span>
</span><span id="WiWTriTraining-340"><a href="#WiWTriTraining-340"><span class="linenos">340</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining-341"><a href="#WiWTriTraining-341"><span class="linenos">341</span></a>            <span class="n">instance_group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="WiWTriTraining-342"><a href="#WiWTriTraining-342"><span class="linenos">342</span></a>
</span><span id="WiWTriTraining-343"><a href="#WiWTriTraining-343"><span class="linenos">343</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="WiWTriTraining-344"><a href="#WiWTriTraining-344"><span class="linenos">344</span></a>
</span><span id="WiWTriTraining-345"><a href="#WiWTriTraining-345"><span class="linenos">345</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="WiWTriTraining-346"><a href="#WiWTriTraining-346"><span class="linenos">346</span></a>
</span><span id="WiWTriTraining-347"><a href="#WiWTriTraining-347"><span class="linenos">347</span></a>        <span class="n">group_label</span> <span class="o">=</span> <span class="n">instance_group</span><span class="p">[</span><span class="n">y</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="WiWTriTraining-348"><a href="#WiWTriTraining-348"><span class="linenos">348</span></a>        <span class="n">group_unlabel</span> <span class="o">=</span> <span class="n">instance_group</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="WiWTriTraining-349"><a href="#WiWTriTraining-349"><span class="linenos">349</span></a>
</span><span id="WiWTriTraining-350"><a href="#WiWTriTraining-350"><span class="linenos">350</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WiWTriTraining-351"><a href="#WiWTriTraining-351"><span class="linenos">351</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-352"><a href="#WiWTriTraining-352"><span class="linenos">352</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-353"><a href="#WiWTriTraining-353"><span class="linenos">353</span></a>
</span><span id="WiWTriTraining-354"><a href="#WiWTriTraining-354"><span class="linenos">354</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="WiWTriTraining-355"><a href="#WiWTriTraining-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="WiWTriTraining-356"><a href="#WiWTriTraining-356"><span class="linenos">356</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="WiWTriTraining-357"><a href="#WiWTriTraining-357"><span class="linenos">357</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining-358"><a href="#WiWTriTraining-358"><span class="linenos">358</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining-359"><a href="#WiWTriTraining-359"><span class="linenos">359</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining-360"><a href="#WiWTriTraining-360"><span class="linenos">360</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">group_label</span><span class="p">)</span>
</span><span id="WiWTriTraining-361"><a href="#WiWTriTraining-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining-362"><a href="#WiWTriTraining-362"><span class="linenos">362</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">group_label</span><span class="p">)</span>
</span><span id="WiWTriTraining-363"><a href="#WiWTriTraining-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">g_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="WiWTriTraining-364"><a href="#WiWTriTraining-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="WiWTriTraining-365"><a href="#WiWTriTraining-365"><span class="linenos">365</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="WiWTriTraining-366"><a href="#WiWTriTraining-366"><span class="linenos">366</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="WiWTriTraining-367"><a href="#WiWTriTraining-367"><span class="linenos">367</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="WiWTriTraining-368"><a href="#WiWTriTraining-368"><span class="linenos">368</span></a>                <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
</span><span id="WiWTriTraining-369"><a href="#WiWTriTraining-369"><span class="linenos">369</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WiWTriTraining-370"><a href="#WiWTriTraining-370"><span class="linenos">370</span></a>                <span class="k">break</span>
</span><span id="WiWTriTraining-371"><a href="#WiWTriTraining-371"><span class="linenos">371</span></a>
</span><span id="WiWTriTraining-372"><a href="#WiWTriTraining-372"><span class="linenos">372</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining-373"><a href="#WiWTriTraining-373"><span class="linenos">373</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="n">group_sample</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="WiWTriTraining-374"><a href="#WiWTriTraining-374"><span class="linenos">374</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="WiWTriTraining-375"><a href="#WiWTriTraining-375"><span class="linenos">375</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="WiWTriTraining-376"><a href="#WiWTriTraining-376"><span class="linenos">376</span></a>                <span class="n">group_label</span><span class="p">,</span>
</span><span id="WiWTriTraining-377"><a href="#WiWTriTraining-377"><span class="linenos">377</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># It must be False to keep the group restriction</span>
</span><span id="WiWTriTraining-378"><a href="#WiWTriTraining-378"><span class="linenos">378</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="WiWTriTraining-379"><a href="#WiWTriTraining-379"><span class="linenos">379</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="WiWTriTraining-380"><a href="#WiWTriTraining-380"><span class="linenos">380</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining-381"><a href="#WiWTriTraining-381"><span class="linenos">381</span></a>
</span><span id="WiWTriTraining-382"><a href="#WiWTriTraining-382"><span class="linenos">382</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining-383"><a href="#WiWTriTraining-383"><span class="linenos">383</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="WiWTriTraining-384"><a href="#WiWTriTraining-384"><span class="linenos">384</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="WiWTriTraining-385"><a href="#WiWTriTraining-385"><span class="linenos">385</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="WiWTriTraining-386"><a href="#WiWTriTraining-386"><span class="linenos">386</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining-387"><a href="#WiWTriTraining-387"><span class="linenos">387</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining-388"><a href="#WiWTriTraining-388"><span class="linenos">388</span></a>            <span class="n">group_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">groups</span><span class="p">),</span> <span class="n">group_sample</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining-389"><a href="#WiWTriTraining-389"><span class="linenos">389</span></a>
</span><span id="WiWTriTraining-390"><a href="#WiWTriTraining-390"><span class="linenos">390</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WiWTriTraining-391"><a href="#WiWTriTraining-391"><span class="linenos">391</span></a>                <span class="n">WhoIsWhoClassifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">conflict_weighted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">conflict_weighted</span><span class="p">)</span><span class="o">.</span>
</span><span id="WiWTriTraining-392"><a href="#WiWTriTraining-392"><span class="linenos">392</span></a>                <span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_sample</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="WiWTriTraining-393"><a href="#WiWTriTraining-393"><span class="linenos">393</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining-394"><a href="#WiWTriTraining-394"><span class="linenos">394</span></a>
</span><span id="WiWTriTraining-395"><a href="#WiWTriTraining-395"><span class="linenos">395</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="WiWTriTraining-396"><a href="#WiWTriTraining-396"><span class="linenos">396</span></a>
</span><span id="WiWTriTraining-397"><a href="#WiWTriTraining-397"><span class="linenos">397</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="WiWTriTraining-398"><a href="#WiWTriTraining-398"><span class="linenos">398</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="WiWTriTraining-399"><a href="#WiWTriTraining-399"><span class="linenos">399</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-400"><a href="#WiWTriTraining-400"><span class="linenos">400</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-401"><a href="#WiWTriTraining-401"><span class="linenos">401</span></a>            <span class="n">G</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-402"><a href="#WiWTriTraining-402"><span class="linenos">402</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WiWTriTraining-403"><a href="#WiWTriTraining-403"><span class="linenos">403</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="WiWTriTraining-404"><a href="#WiWTriTraining-404"><span class="linenos">404</span></a>
</span><span id="WiWTriTraining-405"><a href="#WiWTriTraining-405"><span class="linenos">405</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining-406"><a href="#WiWTriTraining-406"><span class="linenos">406</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="WiWTriTraining-407"><a href="#WiWTriTraining-407"><span class="linenos">407</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WiWTriTraining-408"><a href="#WiWTriTraining-408"><span class="linenos">408</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">LU</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">GL</span><span class="o">=</span><span class="n">group_label</span><span class="p">,</span> <span class="n">GU</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">,</span> <span class="n">GLU</span><span class="o">=</span><span class="n">instance_group</span><span class="p">)</span>
</span><span id="WiWTriTraining-409"><a href="#WiWTriTraining-409"><span class="linenos">409</span></a>                <span class="p">)</span>
</span><span id="WiWTriTraining-410"><a href="#WiWTriTraining-410"><span class="linenos">410</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining-411"><a href="#WiWTriTraining-411"><span class="linenos">411</span></a>                    <span class="k">continue</span>
</span><span id="WiWTriTraining-412"><a href="#WiWTriTraining-412"><span class="linenos">412</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">)</span>
</span><span id="WiWTriTraining-413"><a href="#WiWTriTraining-413"><span class="linenos">413</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">)</span>
</span><span id="WiWTriTraining-414"><a href="#WiWTriTraining-414"><span class="linenos">414</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining-415"><a href="#WiWTriTraining-415"><span class="linenos">415</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining-416"><a href="#WiWTriTraining-416"><span class="linenos">416</span></a>                <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining-417"><a href="#WiWTriTraining-417"><span class="linenos">417</span></a>
</span><span id="WiWTriTraining-418"><a href="#WiWTriTraining-418"><span class="linenos">418</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WiWTriTraining-419"><a href="#WiWTriTraining-419"><span class="linenos">419</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="WiWTriTraining-420"><a href="#WiWTriTraining-420"><span class="linenos">420</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="WiWTriTraining-421"><a href="#WiWTriTraining-421"><span class="linenos">421</span></a>                    <span class="p">)</span>
</span><span id="WiWTriTraining-422"><a href="#WiWTriTraining-422"><span class="linenos">422</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="WiWTriTraining-423"><a href="#WiWTriTraining-423"><span class="linenos">423</span></a>                    <span class="k">continue</span>
</span><span id="WiWTriTraining-424"><a href="#WiWTriTraining-424"><span class="linenos">424</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining-425"><a href="#WiWTriTraining-425"><span class="linenos">425</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining-426"><a href="#WiWTriTraining-426"><span class="linenos">426</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="WiWTriTraining-427"><a href="#WiWTriTraining-427"><span class="linenos">427</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="WiWTriTraining-428"><a href="#WiWTriTraining-428"><span class="linenos">428</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="WiWTriTraining-429"><a href="#WiWTriTraining-429"><span class="linenos">429</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="WiWTriTraining-430"><a href="#WiWTriTraining-430"><span class="linenos">430</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="WiWTriTraining-431"><a href="#WiWTriTraining-431"><span class="linenos">431</span></a>                        <span class="p">),</span>
</span><span id="WiWTriTraining-432"><a href="#WiWTriTraining-432"><span class="linenos">432</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="WiWTriTraining-433"><a href="#WiWTriTraining-433"><span class="linenos">433</span></a>                    <span class="p">)</span>
</span><span id="WiWTriTraining-434"><a href="#WiWTriTraining-434"><span class="linenos">434</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining-435"><a href="#WiWTriTraining-435"><span class="linenos">435</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining-436"><a href="#WiWTriTraining-436"><span class="linenos">436</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="WiWTriTraining-437"><a href="#WiWTriTraining-437"><span class="linenos">437</span></a>
</span><span id="WiWTriTraining-438"><a href="#WiWTriTraining-438"><span class="linenos">438</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="WiWTriTraining-439"><a href="#WiWTriTraining-439"><span class="linenos">439</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="WiWTriTraining-440"><a href="#WiWTriTraining-440"><span class="linenos">440</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_label</span><span class="o">=</span><span class="n">group_label</span><span class="p">,</span> <span class="n">Lg</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="WiWTriTraining-441"><a href="#WiWTriTraining-441"><span class="linenos">441</span></a>                <span class="p">)</span>
</span><span id="WiWTriTraining-442"><a href="#WiWTriTraining-442"><span class="linenos">442</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="WiWTriTraining-443"><a href="#WiWTriTraining-443"><span class="linenos">443</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining-444"><a href="#WiWTriTraining-444"><span class="linenos">444</span></a>
</span><span id="WiWTriTraining-445"><a href="#WiWTriTraining-445"><span class="linenos">445</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining-446"><a href="#WiWTriTraining-446"><span class="linenos">446</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining-447"><a href="#WiWTriTraining-447"><span class="linenos">447</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="WiWTriTraining-448"><a href="#WiWTriTraining-448"><span class="linenos">448</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="WiWTriTraining-449"><a href="#WiWTriTraining-449"><span class="linenos">449</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining-450"><a href="#WiWTriTraining-450"><span class="linenos">450</span></a>
</span><span id="WiWTriTraining-451"><a href="#WiWTriTraining-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="WiWTriTraining-452"><a href="#WiWTriTraining-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining-453"><a href="#WiWTriTraining-453"><span class="linenos">453</span></a>
</span><span id="WiWTriTraining-454"><a href="#WiWTriTraining-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="WiWTriTraining-455"><a href="#WiWTriTraining-455"><span class="linenos">455</span></a>
</span><span id="WiWTriTraining-456"><a href="#WiWTriTraining-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">_measure_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h1</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">h2</span><span class="p">:</span> <span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="WiWTriTraining-457"><a href="#WiWTriTraining-457"><span class="linenos">457</span></a>        <span class="sd">&quot;&quot;&quot;Calculate the error between two hypotheses</span>
</span><span id="WiWTriTraining-458"><a href="#WiWTriTraining-458"><span class="linenos">458</span></a><span class="sd">        Parameters</span>
</span><span id="WiWTriTraining-459"><a href="#WiWTriTraining-459"><span class="linenos">459</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining-460"><a href="#WiWTriTraining-460"><span class="linenos">460</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="WiWTriTraining-461"><a href="#WiWTriTraining-461"><span class="linenos">461</span></a><span class="sd">            The training labeled input samples.</span>
</span><span id="WiWTriTraining-462"><a href="#WiWTriTraining-462"><span class="linenos">462</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="WiWTriTraining-463"><a href="#WiWTriTraining-463"><span class="linenos">463</span></a><span class="sd">            The target values (class labels).</span>
</span><span id="WiWTriTraining-464"><a href="#WiWTriTraining-464"><span class="linenos">464</span></a><span class="sd">        h1 : ClassifierMixin</span>
</span><span id="WiWTriTraining-465"><a href="#WiWTriTraining-465"><span class="linenos">465</span></a><span class="sd">            First hypothesis</span>
</span><span id="WiWTriTraining-466"><a href="#WiWTriTraining-466"><span class="linenos">466</span></a><span class="sd">        h2 : ClassifierMixin</span>
</span><span id="WiWTriTraining-467"><a href="#WiWTriTraining-467"><span class="linenos">467</span></a><span class="sd">            Second hypothesis</span>
</span><span id="WiWTriTraining-468"><a href="#WiWTriTraining-468"><span class="linenos">468</span></a><span class="sd">        epsilon : float</span>
</span><span id="WiWTriTraining-469"><a href="#WiWTriTraining-469"><span class="linenos">469</span></a><span class="sd">            A small number to avoid division by zero</span>
</span><span id="WiWTriTraining-470"><a href="#WiWTriTraining-470"><span class="linenos">470</span></a><span class="sd">        Returns</span>
</span><span id="WiWTriTraining-471"><a href="#WiWTriTraining-471"><span class="linenos">471</span></a><span class="sd">        -------</span>
</span><span id="WiWTriTraining-472"><a href="#WiWTriTraining-472"><span class="linenos">472</span></a><span class="sd">        error: float</span>
</span><span id="WiWTriTraining-473"><a href="#WiWTriTraining-473"><span class="linenos">473</span></a><span class="sd">            Division of the number of labeled examples on which both h1 and h2 make incorrect classification,</span>
</span><span id="WiWTriTraining-474"><a href="#WiWTriTraining-474"><span class="linenos">474</span></a><span class="sd">            by the number of labeled examples on which the classification made by h1 is the same as that made by h2.</span>
</span><span id="WiWTriTraining-475"><a href="#WiWTriTraining-475"><span class="linenos">475</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WiWTriTraining-476"><a href="#WiWTriTraining-476"><span class="linenos">476</span></a>        <span class="n">me</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h1</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">h2</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
</span><span id="WiWTriTraining-477"><a href="#WiWTriTraining-477"><span class="linenos">477</span></a>
</span><span id="WiWTriTraining-478"><a href="#WiWTriTraining-478"><span class="linenos">478</span></a>        <span class="n">LU</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;LU&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-479"><a href="#WiWTriTraining-479"><span class="linenos">479</span></a>        <span class="n">U</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-480"><a href="#WiWTriTraining-480"><span class="linenos">480</span></a>        <span class="n">GL</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GL&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-481"><a href="#WiWTriTraining-481"><span class="linenos">481</span></a>        <span class="n">GU</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GU&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-482"><a href="#WiWTriTraining-482"><span class="linenos">482</span></a>        <span class="n">GLU</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GLU&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-483"><a href="#WiWTriTraining-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">==</span> <span class="s2">&quot;labeled&quot;</span><span class="p">:</span>
</span><span id="WiWTriTraining-484"><a href="#WiWTriTraining-484"><span class="linenos">484</span></a>            <span class="n">conflict</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">GL</span><span class="p">)</span> <span class="o">+</span> <span class="n">h2</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">GL</span><span class="p">))</span>
</span><span id="WiWTriTraining-485"><a href="#WiWTriTraining-485"><span class="linenos">485</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">==</span> <span class="s2">&quot;labeled_plus&quot;</span><span class="p">:</span>
</span><span id="WiWTriTraining-486"><a href="#WiWTriTraining-486"><span class="linenos">486</span></a>            <span class="n">conflict</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">conflict_in_train</span> <span class="o">+</span> <span class="n">h2</span><span class="o">.</span><span class="n">conflict_in_train</span><span class="p">)</span>
</span><span id="WiWTriTraining-487"><a href="#WiWTriTraining-487"><span class="linenos">487</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">==</span> <span class="s2">&quot;unlabeled&quot;</span><span class="p">:</span>
</span><span id="WiWTriTraining-488"><a href="#WiWTriTraining-488"><span class="linenos">488</span></a>            <span class="n">conflict</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">GU</span><span class="p">)</span> <span class="o">+</span> <span class="n">h2</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">GU</span><span class="p">))</span>
</span><span id="WiWTriTraining-489"><a href="#WiWTriTraining-489"><span class="linenos">489</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="WiWTriTraining-490"><a href="#WiWTriTraining-490"><span class="linenos">490</span></a>            <span class="n">conflict</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">LU</span><span class="p">,</span> <span class="n">GLU</span><span class="p">)</span> <span class="o">+</span> <span class="n">h2</span><span class="o">.</span><span class="n">conflict_rate</span><span class="p">(</span><span class="n">LU</span><span class="p">,</span> <span class="n">GLU</span><span class="p">))</span>
</span><span id="WiWTriTraining-491"><a href="#WiWTriTraining-491"><span class="linenos">491</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="WiWTriTraining-492"><a href="#WiWTriTraining-492"><span class="linenos">492</span></a>            <span class="n">conflict</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="WiWTriTraining-493"><a href="#WiWTriTraining-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="n">me</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">conflict</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="WiWTriTraining-494"><a href="#WiWTriTraining-494"><span class="linenos">494</span></a>
</span><span id="WiWTriTraining-495"><a href="#WiWTriTraining-495"><span class="linenos">495</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">Ly</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="WiWTriTraining-496"><a href="#WiWTriTraining-496"><span class="linenos">496</span></a>        <span class="n">Lg</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Lg&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-497"><a href="#WiWTriTraining-497"><span class="linenos">497</span></a>        <span class="n">group_label</span> <span class="o">=</span> <span class="n">kwards</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;group_label&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="WiWTriTraining-498"><a href="#WiWTriTraining-498"><span class="linenos">498</span></a>        <span class="n">kwards</span>
</span><span id="WiWTriTraining-499"><a href="#WiWTriTraining-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
</span><span id="WiWTriTraining-500"><a href="#WiWTriTraining-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="WiWTriTraining-501"><a href="#WiWTriTraining-501"><span class="linenos">501</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">])</span>
</span><span id="WiWTriTraining-502"><a href="#WiWTriTraining-502"><span class="linenos">502</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="WiWTriTraining-503"><a href="#WiWTriTraining-503"><span class="linenos">503</span></a>                <span class="n">_tempL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</span><span id="WiWTriTraining-504"><a href="#WiWTriTraining-504"><span class="linenos">504</span></a>            <span class="n">_tempY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">Ly</span><span class="p">))</span>
</span><span id="WiWTriTraining-505"><a href="#WiWTriTraining-505"><span class="linenos">505</span></a>            <span class="n">_tempG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">group_label</span><span class="p">,</span> <span class="n">Lg</span><span class="p">))</span>
</span><span id="WiWTriTraining-506"><a href="#WiWTriTraining-506"><span class="linenos">506</span></a>
</span><span id="WiWTriTraining-507"><a href="#WiWTriTraining-507"><span class="linenos">507</span></a>            <span class="k">return</span> <span class="n">hyp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">_tempL</span><span class="p">,</span> <span class="n">_tempY</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">_tempG</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="WiWTriTraining-508"><a href="#WiWTriTraining-508"><span class="linenos">508</span></a>        <span class="k">return</span> <span class="n">hyp</span>
</span><span id="WiWTriTraining-509"><a href="#WiWTriTraining-509"><span class="linenos">509</span></a>
</span><span id="WiWTriTraining-510"><a href="#WiWTriTraining-510"><span class="linenos">510</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">):</span>
</span><span id="WiWTriTraining-511"><a href="#WiWTriTraining-511"><span class="linenos">511</span></a>        <span class="n">y_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="WiWTriTraining-512"><a href="#WiWTriTraining-512"><span class="linenos">512</span></a>
</span><span id="WiWTriTraining-513"><a href="#WiWTriTraining-513"><span class="linenos">513</span></a>        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">combine_predictions</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
</span><span id="WiWTriTraining-514"><a href="#WiWTriTraining-514"><span class="linenos">514</span></a>
</span><span id="WiWTriTraining-515"><a href="#WiWTriTraining-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#WiWTriTraining.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="WiWTriTraining.__init__" class="classattr">
                                        <input id="WiWTriTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">WiWTriTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span>,</span><span class="param">	<span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">method</span><span class="o">=</span><span class="s1">&#39;hungarian&#39;</span>,</span><span class="param">	<span class="n">conflict_weighted</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">conflict_over</span><span class="o">=</span><span class="s1">&#39;labeled&#39;</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="WiWTriTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WiWTriTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WiWTriTraining.__init__-267"><a href="#WiWTriTraining.__init__-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="WiWTriTraining.__init__-268"><a href="#WiWTriTraining.__init__-268"><span class="linenos">268</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-269"><a href="#WiWTriTraining.__init__-269"><span class="linenos">269</span></a>        <span class="n">base_estimator</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-270"><a href="#WiWTriTraining.__init__-270"><span class="linenos">270</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-271"><a href="#WiWTriTraining.__init__-271"><span class="linenos">271</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-272"><a href="#WiWTriTraining.__init__-272"><span class="linenos">272</span></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;hungarian&quot;</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-273"><a href="#WiWTriTraining.__init__-273"><span class="linenos">273</span></a>        <span class="n">conflict_weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-274"><a href="#WiWTriTraining.__init__-274"><span class="linenos">274</span></a>        <span class="n">conflict_over</span><span class="o">=</span><span class="s2">&quot;labeled&quot;</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-275"><a href="#WiWTriTraining.__init__-275"><span class="linenos">275</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="WiWTriTraining.__init__-276"><a href="#WiWTriTraining.__init__-276"><span class="linenos">276</span></a>    <span class="p">):</span>
</span><span id="WiWTriTraining.__init__-277"><a href="#WiWTriTraining.__init__-277"><span class="linenos">277</span></a>        <span class="sd">&quot;&quot;&quot;TriTraining with restriction Who-is-Who.</span>
</span><span id="WiWTriTraining.__init__-278"><a href="#WiWTriTraining.__init__-278"><span class="linenos">278</span></a>
</span><span id="WiWTriTraining.__init__-279"><a href="#WiWTriTraining.__init__-279"><span class="linenos">279</span></a><span class="sd">        Parameters</span>
</span><span id="WiWTriTraining.__init__-280"><a href="#WiWTriTraining.__init__-280"><span class="linenos">280</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining.__init__-281"><a href="#WiWTriTraining.__init__-281"><span class="linenos">281</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="WiWTriTraining.__init__-282"><a href="#WiWTriTraining.__init__-282"><span class="linenos">282</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="WiWTriTraining.__init__-283"><a href="#WiWTriTraining.__init__-283"><span class="linenos">283</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="WiWTriTraining.__init__-284"><a href="#WiWTriTraining.__init__-284"><span class="linenos">284</span></a><span class="sd">            Number of samples to generate.</span>
</span><span id="WiWTriTraining.__init__-285"><a href="#WiWTriTraining.__init__-285"><span class="linenos">285</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="WiWTriTraining.__init__-286"><a href="#WiWTriTraining.__init__-286"><span class="linenos">286</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="WiWTriTraining.__init__-287"><a href="#WiWTriTraining.__init__-287"><span class="linenos">287</span></a><span class="sd">           Number of jobs to run in parallel. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors., by default None</span>
</span><span id="WiWTriTraining.__init__-288"><a href="#WiWTriTraining.__init__-288"><span class="linenos">288</span></a><span class="sd">        method : str, optional</span>
</span><span id="WiWTriTraining.__init__-289"><a href="#WiWTriTraining.__init__-289"><span class="linenos">289</span></a><span class="sd">            The method to use to assing class, it can be `greedy` to first-look or `hungarian` to use the Hungarian algorithm, by default &quot;hungarian&quot;</span>
</span><span id="WiWTriTraining.__init__-290"><a href="#WiWTriTraining.__init__-290"><span class="linenos">290</span></a><span class="sd">        conflict_weighted : bool, default=True</span>
</span><span id="WiWTriTraining.__init__-291"><a href="#WiWTriTraining.__init__-291"><span class="linenos">291</span></a><span class="sd">            Whether to weighted the confusion rate by the number of instances with the same group.</span>
</span><span id="WiWTriTraining.__init__-292"><a href="#WiWTriTraining.__init__-292"><span class="linenos">292</span></a><span class="sd">        conflict_over : str, optional</span>
</span><span id="WiWTriTraining.__init__-293"><a href="#WiWTriTraining.__init__-293"><span class="linenos">293</span></a><span class="sd">            The conflict rate penalizes the &quot;measure error&quot; of basic TriTraining, it can be calculated over differentes subsamples of X, can be:</span>
</span><span id="WiWTriTraining.__init__-294"><a href="#WiWTriTraining.__init__-294"><span class="linenos">294</span></a><span class="sd">            * &quot;labeled&quot; over complete L,</span>
</span><span id="WiWTriTraining.__init__-295"><a href="#WiWTriTraining.__init__-295"><span class="linenos">295</span></a><span class="sd">            * &quot;labeled_plus&quot; over complete L union L&#39;,</span>
</span><span id="WiWTriTraining.__init__-296"><a href="#WiWTriTraining.__init__-296"><span class="linenos">296</span></a><span class="sd">            * &quot;unlabeled¨: over complete U,</span>
</span><span id="WiWTriTraining.__init__-297"><a href="#WiWTriTraining.__init__-297"><span class="linenos">297</span></a><span class="sd">            * &quot;all&quot;: over complete X (LuU) and</span>
</span><span id="WiWTriTraining.__init__-298"><a href="#WiWTriTraining.__init__-298"><span class="linenos">298</span></a><span class="sd">            * &quot;none&quot;: don&#39;t penalize the &quot;meause error&quot;, by default &quot;labeled&quot;</span>
</span><span id="WiWTriTraining.__init__-299"><a href="#WiWTriTraining.__init__-299"><span class="linenos">299</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="WiWTriTraining.__init__-300"><a href="#WiWTriTraining.__init__-300"><span class="linenos">300</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="WiWTriTraining.__init__-301"><a href="#WiWTriTraining.__init__-301"><span class="linenos">301</span></a>
</span><span id="WiWTriTraining.__init__-302"><a href="#WiWTriTraining.__init__-302"><span class="linenos">302</span></a><span class="sd">        References</span>
</span><span id="WiWTriTraining.__init__-303"><a href="#WiWTriTraining.__init__-303"><span class="linenos">303</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining.__init__-304"><a href="#WiWTriTraining.__init__-304"><span class="linenos">304</span></a><span class="sd">        Ludmila I. Kuncheva, Juan J. Rodríguez, Aaron S. Jackson,</span>
</span><span id="WiWTriTraining.__init__-305"><a href="#WiWTriTraining.__init__-305"><span class="linenos">305</span></a><span class="sd">        Restricted set classification: Who is there?,</span>
</span><span id="WiWTriTraining.__init__-306"><a href="#WiWTriTraining.__init__-306"><span class="linenos">306</span></a><span class="sd">        Pattern Recognition, 63, 158-170, </span>
</span><span id="WiWTriTraining.__init__-307"><a href="#WiWTriTraining.__init__-307"><span class="linenos">307</span></a><span class="sd">        10.1016/j.patcog.2016.08.028</span>
</span><span id="WiWTriTraining.__init__-308"><a href="#WiWTriTraining.__init__-308"><span class="linenos">308</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WiWTriTraining.__init__-309"><a href="#WiWTriTraining.__init__-309"><span class="linenos">309</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">)</span>
</span><span id="WiWTriTraining.__init__-310"><a href="#WiWTriTraining.__init__-310"><span class="linenos">310</span></a>        <span class="n">conflict_over_choices</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;labeled&quot;</span><span class="p">,</span> <span class="s2">&quot;labeled_plus&quot;</span><span class="p">,</span> <span class="s2">&quot;unlabeled&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>
</span><span id="WiWTriTraining.__init__-311"><a href="#WiWTriTraining.__init__-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="n">conflict_over</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">conflict_over_choices</span><span class="p">:</span>
</span><span id="WiWTriTraining.__init__-312"><a href="#WiWTriTraining.__init__-312"><span class="linenos">312</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WiWTriTraining.__init__-313"><a href="#WiWTriTraining.__init__-313"><span class="linenos">313</span></a>                <span class="sa">f</span><span class="s2">&quot;conflict_over must be one of </span><span class="si">{</span><span class="n">conflict_over_choices</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">conflict_over</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="WiWTriTraining.__init__-314"><a href="#WiWTriTraining.__init__-314"><span class="linenos">314</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining.__init__-315"><a href="#WiWTriTraining.__init__-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conflict_over</span> <span class="o">=</span> <span class="n">conflict_over</span>
</span><span id="WiWTriTraining.__init__-316"><a href="#WiWTriTraining.__init__-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="WiWTriTraining.__init__-317"><a href="#WiWTriTraining.__init__-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conflict_weighted</span> <span class="o">=</span> <span class="n">conflict_weighted</span>
</span></pre></div>


            <div class="docstring"><p>TriTraining with restriction Who-is-Who.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_samples</strong> (int, optional):
Number of samples to generate.
If left to None this is automatically set to the first dimension of the arrays., by default None</li>
<li><strong>n_jobs</strong> (int, optional):
Number of jobs to run in parallel. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors., by default None</li>
<li><strong>method</strong> (str, optional):
The method to use to assing class, it can be <code>greedy</code> to first-look or <code>hungarian</code> to use the Hungarian algorithm, by default "hungarian"</li>
<li><strong>conflict_weighted</strong> (bool, default=True):
Whether to weighted the confusion rate by the number of instances with the same group.</li>
<li><strong>conflict_over</strong> (str, optional):
The conflict rate penalizes the "measure error" of basic TriTraining, it can be calculated over differentes subsamples of X, can be:
<ul>
<li>"labeled" over complete L,</li>
<li>"labeled_plus" over complete L union L',</li>
<li>"unlabeled¨: over complete U,</li>
<li>"all": over complete X (LuU) and</li>
<li>"none": don't penalize the "meause error", by default "labeled"</li>
</ul></li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Ludmila I. Kuncheva, Juan J. Rodríguez, Aaron S. Jackson,
Restricted set classification: Who is there?,
Pattern Recognition, 63, 158-170, 
10.1016/j.patcog.2016.08.028</p>
</div>


                            </div>
                            <div id="WiWTriTraining.fit" class="classattr">
                                        <input id="WiWTriTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">instance_group</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WiWTriTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WiWTriTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WiWTriTraining.fit-319"><a href="#WiWTriTraining.fit-319"><span class="linenos">319</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="WiWTriTraining.fit-320"><a href="#WiWTriTraining.fit-320"><span class="linenos">320</span></a>        <span class="sd">&quot;&quot;&quot;Build a TriTraining classifier from the training set (X, y).</span>
</span><span id="WiWTriTraining.fit-321"><a href="#WiWTriTraining.fit-321"><span class="linenos">321</span></a><span class="sd">        Parameters</span>
</span><span id="WiWTriTraining.fit-322"><a href="#WiWTriTraining.fit-322"><span class="linenos">322</span></a><span class="sd">        ----------</span>
</span><span id="WiWTriTraining.fit-323"><a href="#WiWTriTraining.fit-323"><span class="linenos">323</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="WiWTriTraining.fit-324"><a href="#WiWTriTraining.fit-324"><span class="linenos">324</span></a><span class="sd">            The training input samples.</span>
</span><span id="WiWTriTraining.fit-325"><a href="#WiWTriTraining.fit-325"><span class="linenos">325</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="WiWTriTraining.fit-326"><a href="#WiWTriTraining.fit-326"><span class="linenos">326</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="WiWTriTraining.fit-327"><a href="#WiWTriTraining.fit-327"><span class="linenos">327</span></a><span class="sd">        instance_group : array-like of shape (n_samples)</span>
</span><span id="WiWTriTraining.fit-328"><a href="#WiWTriTraining.fit-328"><span class="linenos">328</span></a><span class="sd">            The group. Two instances with the same label are not allowed to be in the same group.</span>
</span><span id="WiWTriTraining.fit-329"><a href="#WiWTriTraining.fit-329"><span class="linenos">329</span></a><span class="sd">        Returns</span>
</span><span id="WiWTriTraining.fit-330"><a href="#WiWTriTraining.fit-330"><span class="linenos">330</span></a><span class="sd">        -------</span>
</span><span id="WiWTriTraining.fit-331"><a href="#WiWTriTraining.fit-331"><span class="linenos">331</span></a><span class="sd">        self : TriTraining</span>
</span><span id="WiWTriTraining.fit-332"><a href="#WiWTriTraining.fit-332"><span class="linenos">332</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="WiWTriTraining.fit-333"><a href="#WiWTriTraining.fit-333"><span class="linenos">333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="WiWTriTraining.fit-334"><a href="#WiWTriTraining.fit-334"><span class="linenos">334</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-335"><a href="#WiWTriTraining.fit-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-336"><a href="#WiWTriTraining.fit-336"><span class="linenos">336</span></a>
</span><span id="WiWTriTraining.fit-337"><a href="#WiWTriTraining.fit-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="n">instance_group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-338"><a href="#WiWTriTraining.fit-338"><span class="linenos">338</span></a>            <span class="n">warn</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-339"><a href="#WiWTriTraining.fit-339"><span class="linenos">339</span></a>                <span class="s2">&quot;Instance group is not provided. Each instance will belong their own group. Consider using `TriTraining`.&quot;</span>
</span><span id="WiWTriTraining.fit-340"><a href="#WiWTriTraining.fit-340"><span class="linenos">340</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining.fit-341"><a href="#WiWTriTraining.fit-341"><span class="linenos">341</span></a>            <span class="n">instance_group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="WiWTriTraining.fit-342"><a href="#WiWTriTraining.fit-342"><span class="linenos">342</span></a>
</span><span id="WiWTriTraining.fit-343"><a href="#WiWTriTraining.fit-343"><span class="linenos">343</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-344"><a href="#WiWTriTraining.fit-344"><span class="linenos">344</span></a>
</span><span id="WiWTriTraining.fit-345"><a href="#WiWTriTraining.fit-345"><span class="linenos">345</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-346"><a href="#WiWTriTraining.fit-346"><span class="linenos">346</span></a>
</span><span id="WiWTriTraining.fit-347"><a href="#WiWTriTraining.fit-347"><span class="linenos">347</span></a>        <span class="n">group_label</span> <span class="o">=</span> <span class="n">instance_group</span><span class="p">[</span><span class="n">y</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="WiWTriTraining.fit-348"><a href="#WiWTriTraining.fit-348"><span class="linenos">348</span></a>        <span class="n">group_unlabel</span> <span class="o">=</span> <span class="n">instance_group</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="WiWTriTraining.fit-349"><a href="#WiWTriTraining.fit-349"><span class="linenos">349</span></a>
</span><span id="WiWTriTraining.fit-350"><a href="#WiWTriTraining.fit-350"><span class="linenos">350</span></a>        <span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WiWTriTraining.fit-351"><a href="#WiWTriTraining.fit-351"><span class="linenos">351</span></a>        <span class="n">e_</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-352"><a href="#WiWTriTraining.fit-352"><span class="linenos">352</span></a>        <span class="n">l_</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-353"><a href="#WiWTriTraining.fit-353"><span class="linenos">353</span></a>
</span><span id="WiWTriTraining.fit-354"><a href="#WiWTriTraining.fit-354"><span class="linenos">354</span></a>        <span class="c1"># Get a random instance for each class to keep class index</span>
</span><span id="WiWTriTraining.fit-355"><a href="#WiWTriTraining.fit-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-356"><a href="#WiWTriTraining.fit-356"><span class="linenos">356</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-357"><a href="#WiWTriTraining.fit-357"><span class="linenos">357</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining.fit-358"><a href="#WiWTriTraining.fit-358"><span class="linenos">358</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining.fit-359"><a href="#WiWTriTraining.fit-359"><span class="linenos">359</span></a>        <span class="n">groups</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="WiWTriTraining.fit-360"><a href="#WiWTriTraining.fit-360"><span class="linenos">360</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">group_label</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-361"><a href="#WiWTriTraining.fit-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-362"><a href="#WiWTriTraining.fit-362"><span class="linenos">362</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">group_label</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-363"><a href="#WiWTriTraining.fit-363"><span class="linenos">363</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">g_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-364"><a href="#WiWTriTraining.fit-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-365"><a href="#WiWTriTraining.fit-365"><span class="linenos">365</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-366"><a href="#WiWTriTraining.fit-366"><span class="linenos">366</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-367"><a href="#WiWTriTraining.fit-367"><span class="linenos">367</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-368"><a href="#WiWTriTraining.fit-368"><span class="linenos">368</span></a>                <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g_</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-369"><a href="#WiWTriTraining.fit-369"><span class="linenos">369</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-370"><a href="#WiWTriTraining.fit-370"><span class="linenos">370</span></a>                <span class="k">break</span>
</span><span id="WiWTriTraining.fit-371"><a href="#WiWTriTraining.fit-371"><span class="linenos">371</span></a>
</span><span id="WiWTriTraining.fit-372"><a href="#WiWTriTraining.fit-372"><span class="linenos">372</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining.fit-373"><a href="#WiWTriTraining.fit-373"><span class="linenos">373</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="n">group_sample</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-374"><a href="#WiWTriTraining.fit-374"><span class="linenos">374</span></a>                <span class="n">X_label</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-375"><a href="#WiWTriTraining.fit-375"><span class="linenos">375</span></a>                <span class="n">y_label</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-376"><a href="#WiWTriTraining.fit-376"><span class="linenos">376</span></a>                <span class="n">group_label</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-377"><a href="#WiWTriTraining.fit-377"><span class="linenos">377</span></a>                <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># It must be False to keep the group restriction</span>
</span><span id="WiWTriTraining.fit-378"><a href="#WiWTriTraining.fit-378"><span class="linenos">378</span></a>                <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-379"><a href="#WiWTriTraining.fit-379"><span class="linenos">379</span></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-380"><a href="#WiWTriTraining.fit-380"><span class="linenos">380</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining.fit-381"><a href="#WiWTriTraining.fit-381"><span class="linenos">381</span></a>
</span><span id="WiWTriTraining.fit-382"><a href="#WiWTriTraining.fit-382"><span class="linenos">382</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-383"><a href="#WiWTriTraining.fit-383"><span class="linenos">383</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-384"><a href="#WiWTriTraining.fit-384"><span class="linenos">384</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">])</span>
</span><span id="WiWTriTraining.fit-385"><a href="#WiWTriTraining.fit-385"><span class="linenos">385</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-386"><a href="#WiWTriTraining.fit-386"><span class="linenos">386</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-387"><a href="#WiWTriTraining.fit-387"><span class="linenos">387</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-388"><a href="#WiWTriTraining.fit-388"><span class="linenos">388</span></a>            <span class="n">group_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">groups</span><span class="p">),</span> <span class="n">group_sample</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-389"><a href="#WiWTriTraining.fit-389"><span class="linenos">389</span></a>
</span><span id="WiWTriTraining.fit-390"><a href="#WiWTriTraining.fit-390"><span class="linenos">390</span></a>            <span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-391"><a href="#WiWTriTraining.fit-391"><span class="linenos">391</span></a>                <span class="n">WhoIsWhoClassifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="n">conflict_weighted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">conflict_weighted</span><span class="p">)</span><span class="o">.</span>
</span><span id="WiWTriTraining.fit-392"><a href="#WiWTriTraining.fit-392"><span class="linenos">392</span></a>                <span class="n">fit</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_sample</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-393"><a href="#WiWTriTraining.fit-393"><span class="linenos">393</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining.fit-394"><a href="#WiWTriTraining.fit-394"><span class="linenos">394</span></a>
</span><span id="WiWTriTraining.fit-395"><a href="#WiWTriTraining.fit-395"><span class="linenos">395</span></a>        <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="WiWTriTraining.fit-396"><a href="#WiWTriTraining.fit-396"><span class="linenos">396</span></a>
</span><span id="WiWTriTraining.fit-397"><a href="#WiWTriTraining.fit-397"><span class="linenos">397</span></a>        <span class="k">while</span> <span class="n">something_has_changed</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-398"><a href="#WiWTriTraining.fit-398"><span class="linenos">398</span></a>            <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="WiWTriTraining.fit-399"><a href="#WiWTriTraining.fit-399"><span class="linenos">399</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-400"><a href="#WiWTriTraining.fit-400"><span class="linenos">400</span></a>            <span class="n">Ly</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-401"><a href="#WiWTriTraining.fit-401"><span class="linenos">401</span></a>            <span class="n">G</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-402"><a href="#WiWTriTraining.fit-402"><span class="linenos">402</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WiWTriTraining.fit-403"><a href="#WiWTriTraining.fit-403"><span class="linenos">403</span></a>            <span class="n">updates</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</span><span id="WiWTriTraining.fit-404"><a href="#WiWTriTraining.fit-404"><span class="linenos">404</span></a>
</span><span id="WiWTriTraining.fit-405"><a href="#WiWTriTraining.fit-405"><span class="linenos">405</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining.fit-406"><a href="#WiWTriTraining.fit-406"><span class="linenos">406</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-407"><a href="#WiWTriTraining.fit-407"><span class="linenos">407</span></a>                <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-408"><a href="#WiWTriTraining.fit-408"><span class="linenos">408</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_measure_error</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">LU</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">GL</span><span class="o">=</span><span class="n">group_label</span><span class="p">,</span> <span class="n">GU</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">,</span> <span class="n">GLU</span><span class="o">=</span><span class="n">instance_group</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-409"><a href="#WiWTriTraining.fit-409"><span class="linenos">409</span></a>                <span class="p">)</span>
</span><span id="WiWTriTraining.fit-410"><a href="#WiWTriTraining.fit-410"><span class="linenos">410</span></a>                <span class="k">if</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining.fit-411"><a href="#WiWTriTraining.fit-411"><span class="linenos">411</span></a>                    <span class="k">continue</span>
</span><span id="WiWTriTraining.fit-412"><a href="#WiWTriTraining.fit-412"><span class="linenos">412</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-413"><a href="#WiWTriTraining.fit-413"><span class="linenos">413</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">instance_group</span><span class="o">=</span><span class="n">group_unlabel</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-414"><a href="#WiWTriTraining.fit-414"><span class="linenos">414</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining.fit-415"><a href="#WiWTriTraining.fit-415"><span class="linenos">415</span></a>                <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining.fit-416"><a href="#WiWTriTraining.fit-416"><span class="linenos">416</span></a>                <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span>
</span><span id="WiWTriTraining.fit-417"><a href="#WiWTriTraining.fit-417"><span class="linenos">417</span></a>
</span><span id="WiWTriTraining.fit-418"><a href="#WiWTriTraining.fit-418"><span class="linenos">418</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-419"><a href="#WiWTriTraining.fit-419"><span class="linenos">419</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-420"><a href="#WiWTriTraining.fit-420"><span class="linenos">420</span></a>                        <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="WiWTriTraining.fit-421"><a href="#WiWTriTraining.fit-421"><span class="linenos">421</span></a>                    <span class="p">)</span>
</span><span id="WiWTriTraining.fit-422"><a href="#WiWTriTraining.fit-422"><span class="linenos">422</span></a>                <span class="k">if</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
</span><span id="WiWTriTraining.fit-423"><a href="#WiWTriTraining.fit-423"><span class="linenos">423</span></a>                    <span class="k">continue</span>
</span><span id="WiWTriTraining.fit-424"><a href="#WiWTriTraining.fit-424"><span class="linenos">424</span></a>                <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining.fit-425"><a href="#WiWTriTraining.fit-425"><span class="linenos">425</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining.fit-426"><a href="#WiWTriTraining.fit-426"><span class="linenos">426</span></a>                <span class="k">elif</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">safe_division</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">):</span>
</span><span id="WiWTriTraining.fit-427"><a href="#WiWTriTraining.fit-427"><span class="linenos">427</span></a>                    <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_subsample</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-428"><a href="#WiWTriTraining.fit-428"><span class="linenos">428</span></a>                        <span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
</span><span id="WiWTriTraining.fit-429"><a href="#WiWTriTraining.fit-429"><span class="linenos">429</span></a>                        <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="WiWTriTraining.fit-430"><a href="#WiWTriTraining.fit-430"><span class="linenos">430</span></a>                            <span class="n">safe_division</span><span class="p">(</span><span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="WiWTriTraining.fit-431"><a href="#WiWTriTraining.fit-431"><span class="linenos">431</span></a>                        <span class="p">),</span>
</span><span id="WiWTriTraining.fit-432"><a href="#WiWTriTraining.fit-432"><span class="linenos">432</span></a>                        <span class="n">random_state</span><span class="p">,</span>
</span><span id="WiWTriTraining.fit-433"><a href="#WiWTriTraining.fit-433"><span class="linenos">433</span></a>                    <span class="p">)</span>
</span><span id="WiWTriTraining.fit-434"><a href="#WiWTriTraining.fit-434"><span class="linenos">434</span></a>                    <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining.fit-435"><a href="#WiWTriTraining.fit-435"><span class="linenos">435</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="WiWTriTraining.fit-436"><a href="#WiWTriTraining.fit-436"><span class="linenos">436</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-437"><a href="#WiWTriTraining.fit-437"><span class="linenos">437</span></a>
</span><span id="WiWTriTraining.fit-438"><a href="#WiWTriTraining.fit-438"><span class="linenos">438</span></a>            <span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="WiWTriTraining.fit-439"><a href="#WiWTriTraining.fit-439"><span class="linenos">439</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span>
</span><span id="WiWTriTraining.fit-440"><a href="#WiWTriTraining.fit-440"><span class="linenos">440</span></a>                    <span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_label</span><span class="o">=</span><span class="n">group_label</span><span class="p">,</span> <span class="n">Lg</span><span class="o">=</span><span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span>
</span><span id="WiWTriTraining.fit-441"><a href="#WiWTriTraining.fit-441"><span class="linenos">441</span></a>                <span class="p">)</span>
</span><span id="WiWTriTraining.fit-442"><a href="#WiWTriTraining.fit-442"><span class="linenos">442</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)</span>
</span><span id="WiWTriTraining.fit-443"><a href="#WiWTriTraining.fit-443"><span class="linenos">443</span></a>            <span class="p">)</span>
</span><span id="WiWTriTraining.fit-444"><a href="#WiWTriTraining.fit-444"><span class="linenos">444</span></a>
</span><span id="WiWTriTraining.fit-445"><a href="#WiWTriTraining.fit-445"><span class="linenos">445</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="WiWTriTraining.fit-446"><a href="#WiWTriTraining.fit-446"><span class="linenos">446</span></a>                <span class="k">if</span> <span class="n">updates</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="WiWTriTraining.fit-447"><a href="#WiWTriTraining.fit-447"><span class="linenos">447</span></a>                    <span class="n">e_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="WiWTriTraining.fit-448"><a href="#WiWTriTraining.fit-448"><span class="linenos">448</span></a>                    <span class="n">l_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="WiWTriTraining.fit-449"><a href="#WiWTriTraining.fit-449"><span class="linenos">449</span></a>                    <span class="n">something_has_changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="WiWTriTraining.fit-450"><a href="#WiWTriTraining.fit-450"><span class="linenos">450</span></a>
</span><span id="WiWTriTraining.fit-451"><a href="#WiWTriTraining.fit-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="n">hypotheses</span>
</span><span id="WiWTriTraining.fit-452"><a href="#WiWTriTraining.fit-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="WiWTriTraining.fit-453"><a href="#WiWTriTraining.fit-453"><span class="linenos">453</span></a>
</span><span id="WiWTriTraining.fit-454"><a href="#WiWTriTraining.fit-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a TriTraining classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
<li><strong>instance_group</strong> (array-like of shape (n_samples)):
The group. Two instances with the same label are not allowed to be in the same group.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (TriTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="WiWTriTraining.predict" class="classattr">
                                        <input id="WiWTriTraining.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">instance_group</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WiWTriTraining.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WiWTriTraining.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WiWTriTraining.predict-510"><a href="#WiWTriTraining.predict-510"><span class="linenos">510</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">):</span>
</span><span id="WiWTriTraining.predict-511"><a href="#WiWTriTraining.predict-511"><span class="linenos">511</span></a>        <span class="n">y_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="WiWTriTraining.predict-512"><a href="#WiWTriTraining.predict-512"><span class="linenos">512</span></a>
</span><span id="WiWTriTraining.predict-513"><a href="#WiWTriTraining.predict-513"><span class="linenos">513</span></a>        <span class="n">y_preds</span> <span class="o">=</span> <span class="n">combine_predictions</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">instance_group</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">)</span>
</span><span id="WiWTriTraining.predict-514"><a href="#WiWTriTraining.predict-514"><span class="linenos">514</span></a>
</span><span id="WiWTriTraining.predict-515"><a href="#WiWTriTraining.predict-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict the classes of X.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples,)):
Array with predicted labels.</li>
</ul>
</div>


                            </div>
                            <div id="WiWTriTraining.set_fit_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fit_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#WiWTriTraining.set_fit_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#WiWTriTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="WiWTriTraining.set_predict_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_predict_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#WiWTriTraining.set_predict_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#WiWTriTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="WiWTriTraining.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#WiWTriTraining.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#WiWTriTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="WiWTriTraining.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="WiWTriTraining.get_params" class="function">get_params</dd>
                <dd id="WiWTriTraining.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="WiWTriTraining.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="WiWTriTraining.score" class="function">score</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoTraining">
                            <input id="CoTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoTraining</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="CoTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining-365"><a href="#CoTraining-365"><span class="linenos">365</span></a><span class="k">class</span> <span class="nc">CoTraining</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="CoTraining-366"><a href="#CoTraining-366"><span class="linenos">366</span></a>
</span><span id="CoTraining-367"><a href="#CoTraining-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTraining-368"><a href="#CoTraining-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTraining-369"><a href="#CoTraining-369"><span class="linenos">369</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="CoTraining-370"><a href="#CoTraining-370"><span class="linenos">370</span></a>        <span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTraining-371"><a href="#CoTraining-371"><span class="linenos">371</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="CoTraining-372"><a href="#CoTraining-372"><span class="linenos">372</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
</span><span id="CoTraining-373"><a href="#CoTraining-373"><span class="linenos">373</span></a>        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="CoTraining-374"><a href="#CoTraining-374"><span class="linenos">374</span></a>        <span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CoTraining-375"><a href="#CoTraining-375"><span class="linenos">375</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CoTraining-376"><a href="#CoTraining-376"><span class="linenos">376</span></a>    <span class="p">):</span>
</span><span id="CoTraining-377"><a href="#CoTraining-377"><span class="linenos">377</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-378"><a href="#CoTraining-378"><span class="linenos">378</span></a><span class="sd">        Create a CoTraining classifier. </span>
</span><span id="CoTraining-379"><a href="#CoTraining-379"><span class="linenos">379</span></a><span class="sd">        Multi-view learning algorithm that uses two classifiers to label instances.</span>
</span><span id="CoTraining-380"><a href="#CoTraining-380"><span class="linenos">380</span></a>
</span><span id="CoTraining-381"><a href="#CoTraining-381"><span class="linenos">381</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-382"><a href="#CoTraining-382"><span class="linenos">382</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-383"><a href="#CoTraining-383"><span class="linenos">383</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining-384"><a href="#CoTraining-384"><span class="linenos">384</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</span>
</span><span id="CoTraining-385"><a href="#CoTraining-385"><span class="linenos">385</span></a><span class="sd">        second_base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining-386"><a href="#CoTraining-386"><span class="linenos">386</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</span>
</span><span id="CoTraining-387"><a href="#CoTraining-387"><span class="linenos">387</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTraining-388"><a href="#CoTraining-388"><span class="linenos">388</span></a><span class="sd">            The number of iterations, by default 30</span>
</span><span id="CoTraining-389"><a href="#CoTraining-389"><span class="linenos">389</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTraining-390"><a href="#CoTraining-390"><span class="linenos">390</span></a><span class="sd">            The size of the pool of unlabeled samples from which the classifier can choose, by default 75</span>
</span><span id="CoTraining-391"><a href="#CoTraining-391"><span class="linenos">391</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoTraining-392"><a href="#CoTraining-392"><span class="linenos">392</span></a><span class="sd">            The threshold for label instances, by default 0.5</span>
</span><span id="CoTraining-393"><a href="#CoTraining-393"><span class="linenos">393</span></a><span class="sd">        force_second_view : bool, optional</span>
</span><span id="CoTraining-394"><a href="#CoTraining-394"><span class="linenos">394</span></a><span class="sd">            The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</span>
</span><span id="CoTraining-395"><a href="#CoTraining-395"><span class="linenos">395</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTraining-396"><a href="#CoTraining-396"><span class="linenos">396</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTraining-397"><a href="#CoTraining-397"><span class="linenos">397</span></a>
</span><span id="CoTraining-398"><a href="#CoTraining-398"><span class="linenos">398</span></a><span class="sd">        References</span>
</span><span id="CoTraining-399"><a href="#CoTraining-399"><span class="linenos">399</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-400"><a href="#CoTraining-400"><span class="linenos">400</span></a><span class="sd">        Avrim Blum and Tom Mitchell. 1998.</span>
</span><span id="CoTraining-401"><a href="#CoTraining-401"><span class="linenos">401</span></a><span class="sd">        Combining labeled and unlabeled data with co-training.</span>
</span><span id="CoTraining-402"><a href="#CoTraining-402"><span class="linenos">402</span></a><span class="sd">        In Proceedings of the eleventh annual conference on Computational learning theory (COLT&#39; 98).</span>
</span><span id="CoTraining-403"><a href="#CoTraining-403"><span class="linenos">403</span></a><span class="sd">        Association for Computing Machinery, New York, NY, USA, 92-100.</span>
</span><span id="CoTraining-404"><a href="#CoTraining-404"><span class="linenos">404</span></a><span class="sd">        DOI:https://doi.org/10.1145/279943.279962</span>
</span><span id="CoTraining-405"><a href="#CoTraining-405"><span class="linenos">405</span></a>
</span><span id="CoTraining-406"><a href="#CoTraining-406"><span class="linenos">406</span></a><span class="sd">        Han, Xian-Hua, Yen-wei Chen, and Xiang Ruan. 2011. </span>
</span><span id="CoTraining-407"><a href="#CoTraining-407"><span class="linenos">407</span></a><span class="sd">        &#39;Multi-Class Co-Training Learning for Object and Scene Recognition&#39;.</span>
</span><span id="CoTraining-408"><a href="#CoTraining-408"><span class="linenos">408</span></a><span class="sd">        Pp. 67-70 in. Nara, Japan.</span>
</span><span id="CoTraining-409"><a href="#CoTraining-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-410"><a href="#CoTraining-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining-411"><a href="#CoTraining-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-412"><a href="#CoTraining-412"><span class="linenos">412</span></a>            <span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">second_base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining-413"><a href="#CoTraining-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">second_base_estimator</span>
</span><span id="CoTraining-414"><a href="#CoTraining-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTraining-415"><a href="#CoTraining-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTraining-416"><a href="#CoTraining-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoTraining-417"><a href="#CoTraining-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span> <span class="o">=</span> <span class="n">force_second_view</span>
</span><span id="CoTraining-418"><a href="#CoTraining-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoTraining-419"><a href="#CoTraining-419"><span class="linenos">419</span></a>
</span><span id="CoTraining-420"><a href="#CoTraining-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-421"><a href="#CoTraining-421"><span class="linenos">421</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-422"><a href="#CoTraining-422"><span class="linenos">422</span></a><span class="sd">        Build a CoTraining classifier from the training set.</span>
</span><span id="CoTraining-423"><a href="#CoTraining-423"><span class="linenos">423</span></a>
</span><span id="CoTraining-424"><a href="#CoTraining-424"><span class="linenos">424</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-425"><a href="#CoTraining-425"><span class="linenos">425</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-426"><a href="#CoTraining-426"><span class="linenos">426</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-427"><a href="#CoTraining-427"><span class="linenos">427</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-428"><a href="#CoTraining-428"><span class="linenos">428</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTraining-429"><a href="#CoTraining-429"><span class="linenos">429</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="CoTraining-430"><a href="#CoTraining-430"><span class="linenos">430</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-431"><a href="#CoTraining-431"><span class="linenos">431</span></a><span class="sd">            Array representing the data from another view, not compatible with `features`, by default None</span>
</span><span id="CoTraining-432"><a href="#CoTraining-432"><span class="linenos">432</span></a><span class="sd">        features : {list, tuple}, optional</span>
</span><span id="CoTraining-433"><a href="#CoTraining-433"><span class="linenos">433</span></a><span class="sd">            list or tuple of two arrays with `feature` index for each subspace view, not compatible with `X2`, by default None</span>
</span><span id="CoTraining-434"><a href="#CoTraining-434"><span class="linenos">434</span></a><span class="sd">        number_per_class : {dict}, optional</span>
</span><span id="CoTraining-435"><a href="#CoTraining-435"><span class="linenos">435</span></a><span class="sd">            dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</span>
</span><span id="CoTraining-436"><a href="#CoTraining-436"><span class="linenos">436</span></a>
</span><span id="CoTraining-437"><a href="#CoTraining-437"><span class="linenos">437</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-438"><a href="#CoTraining-438"><span class="linenos">438</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-439"><a href="#CoTraining-439"><span class="linenos">439</span></a><span class="sd">        self: CoTraining</span>
</span><span id="CoTraining-440"><a href="#CoTraining-440"><span class="linenos">440</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTraining-441"><a href="#CoTraining-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-442"><a href="#CoTraining-442"><span class="linenos">442</span></a>        <span class="n">rs</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTraining-443"><a href="#CoTraining-443"><span class="linenos">443</span></a>
</span><span id="CoTraining-444"><a href="#CoTraining-444"><span class="linenos">444</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining-445"><a href="#CoTraining-445"><span class="linenos">445</span></a>
</span><span id="CoTraining-446"><a href="#CoTraining-446"><span class="linenos">446</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTraining-447"><a href="#CoTraining-447"><span class="linenos">447</span></a>
</span><span id="CoTraining-448"><a href="#CoTraining-448"><span class="linenos">448</span></a>        <span class="k">if</span> <span class="n">X2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-449"><a href="#CoTraining-449"><span class="linenos">449</span></a>            <span class="n">X2_label</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining-450"><a href="#CoTraining-450"><span class="linenos">450</span></a>        <span class="k">elif</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-451"><a href="#CoTraining-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining-452"><a href="#CoTraining-452"><span class="linenos">452</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-453"><a href="#CoTraining-453"><span class="linenos">453</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-454"><a href="#CoTraining-454"><span class="linenos">454</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-455"><a href="#CoTraining-455"><span class="linenos">455</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-456"><a href="#CoTraining-456"><span class="linenos">456</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-457"><a href="#CoTraining-457"><span class="linenos">457</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-458"><a href="#CoTraining-458"><span class="linenos">458</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining-459"><a href="#CoTraining-459"><span class="linenos">459</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-460"><a href="#CoTraining-460"><span class="linenos">460</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining-461"><a href="#CoTraining-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">features</span>
</span><span id="CoTraining-462"><a href="#CoTraining-462"><span class="linenos">462</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span><span class="p">:</span>
</span><span id="CoTraining-463"><a href="#CoTraining-463"><span class="linenos">463</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Either X2 or features must be defined. CoTraining need another view to train the second classifier&quot;</span><span class="p">)</span>
</span><span id="CoTraining-464"><a href="#CoTraining-464"><span class="linenos">464</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-465"><a href="#CoTraining-465"><span class="linenos">465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining-466"><a href="#CoTraining-466"><span class="linenos">466</span></a>            <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-467"><a href="#CoTraining-467"><span class="linenos">467</span></a>            <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-468"><a href="#CoTraining-468"><span class="linenos">468</span></a>
</span><span id="CoTraining-469"><a href="#CoTraining-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="n">is_df</span> <span class="ow">and</span> <span class="n">X2_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="CoTraining-470"><a href="#CoTraining-470"><span class="linenos">470</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;X and X2 must be both pandas DataFrame or numpy arrays&quot;</span><span class="p">)</span>
</span><span id="CoTraining-471"><a href="#CoTraining-471"><span class="linenos">471</span></a>
</span><span id="CoTraining-472"><a href="#CoTraining-472"><span class="linenos">472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CoTraining-473"><a href="#CoTraining-473"><span class="linenos">473</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">),</span>
</span><span id="CoTraining-474"><a href="#CoTraining-474"><span class="linenos">474</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span><span class="p">)</span>
</span><span id="CoTraining-475"><a href="#CoTraining-475"><span class="linenos">475</span></a>        <span class="p">]</span>
</span><span id="CoTraining-476"><a href="#CoTraining-476"><span class="linenos">476</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="CoTraining-477"><a href="#CoTraining-477"><span class="linenos">477</span></a>            <span class="n">X2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="CoTraining-478"><a href="#CoTraining-478"><span class="linenos">478</span></a>        <span class="p">),</span> <span class="s2">&quot;The list of features and X2 cannot be defined at the same time&quot;</span>
</span><span id="CoTraining-479"><a href="#CoTraining-479"><span class="linenos">479</span></a>
</span><span id="CoTraining-480"><a href="#CoTraining-480"><span class="linenos">480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-481"><a href="#CoTraining-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="n">number_per_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining-482"><a href="#CoTraining-482"><span class="linenos">482</span></a>            <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-483"><a href="#CoTraining-483"><span class="linenos">483</span></a>
</span><span id="CoTraining-484"><a href="#CoTraining-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">:</span>
</span><span id="CoTraining-485"><a href="#CoTraining-485"><span class="linenos">485</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Poolsize (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="si">}</span><span class="s2">) is bigger than U (</span><span class="si">{</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="CoTraining-486"><a href="#CoTraining-486"><span class="linenos">486</span></a>
</span><span id="CoTraining-487"><a href="#CoTraining-487"><span class="linenos">487</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTraining-488"><a href="#CoTraining-488"><span class="linenos">488</span></a>
</span><span id="CoTraining-489"><a href="#CoTraining-489"><span class="linenos">489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-490"><a href="#CoTraining-490"><span class="linenos">490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-491"><a href="#CoTraining-491"><span class="linenos">491</span></a>
</span><span id="CoTraining-492"><a href="#CoTraining-492"><span class="linenos">492</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoTraining-493"><a href="#CoTraining-493"><span class="linenos">493</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">permutation</span><span class="p">):</span>
</span><span id="CoTraining-494"><a href="#CoTraining-494"><span class="linenos">494</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CoTraining-495"><a href="#CoTraining-495"><span class="linenos">495</span></a>
</span><span id="CoTraining-496"><a href="#CoTraining-496"><span class="linenos">496</span></a>            <span class="n">get_index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]</span>
</span><span id="CoTraining-497"><a href="#CoTraining-497"><span class="linenos">497</span></a>            <span class="n">y1_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining-498"><a href="#CoTraining-498"><span class="linenos">498</span></a>            <span class="n">y2_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining-499"><a href="#CoTraining-499"><span class="linenos">499</span></a>
</span><span id="CoTraining-500"><a href="#CoTraining-500"><span class="linenos">500</span></a>            <span class="n">predictions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-501"><a href="#CoTraining-501"><span class="linenos">501</span></a>            <span class="n">class_predicted1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-502"><a href="#CoTraining-502"><span class="linenos">502</span></a>
</span><span id="CoTraining-503"><a href="#CoTraining-503"><span class="linenos">503</span></a>            <span class="n">predictions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-504"><a href="#CoTraining-504"><span class="linenos">504</span></a>            <span class="n">class_predicted2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining-505"><a href="#CoTraining-505"><span class="linenos">505</span></a>
</span><span id="CoTraining-506"><a href="#CoTraining-506"><span class="linenos">506</span></a>            <span class="c1"># If two classifier select same instance and bring different predictions then the instance is not labeled</span>
</span><span id="CoTraining-507"><a href="#CoTraining-507"><span class="linenos">507</span></a>            <span class="n">candidates1</span> <span class="o">=</span> <span class="n">predictions1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining-508"><a href="#CoTraining-508"><span class="linenos">508</span></a>            <span class="n">candidates2</span> <span class="o">=</span> <span class="n">predictions2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining-509"><a href="#CoTraining-509"><span class="linenos">509</span></a>            <span class="n">aggreement</span> <span class="o">=</span> <span class="n">class_predicted1</span> <span class="o">==</span> <span class="n">class_predicted2</span>
</span><span id="CoTraining-510"><a href="#CoTraining-510"><span class="linenos">510</span></a>
</span><span id="CoTraining-511"><a href="#CoTraining-511"><span class="linenos">511</span></a>            <span class="n">full_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">^</span> <span class="n">candidates2</span>
</span><span id="CoTraining-512"><a href="#CoTraining-512"><span class="linenos">512</span></a>            <span class="n">medium_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">&amp;</span> <span class="n">candidates2</span> <span class="o">&amp;</span> <span class="n">aggreement</span>
</span><span id="CoTraining-513"><a href="#CoTraining-513"><span class="linenos">513</span></a>            <span class="n">true_candidates1</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates1</span>
</span><span id="CoTraining-514"><a href="#CoTraining-514"><span class="linenos">514</span></a>            <span class="n">true_candidates2</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates2</span>
</span><span id="CoTraining-515"><a href="#CoTraining-515"><span class="linenos">515</span></a>
</span><span id="CoTraining-516"><a href="#CoTraining-516"><span class="linenos">516</span></a>            <span class="c1"># Fill probas and candidate classes.</span>
</span><span id="CoTraining-517"><a href="#CoTraining-517"><span class="linenos">517</span></a>            <span class="n">y_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTraining-518"><a href="#CoTraining-518"><span class="linenos">518</span></a>            <span class="n">y_class</span> <span class="o">=</span> <span class="n">class_predicted1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining-519"><a href="#CoTraining-519"><span class="linenos">519</span></a>
</span><span id="CoTraining-520"><a href="#CoTraining-520"><span class="linenos">520</span></a>            <span class="n">temp_probas1</span> <span class="o">=</span> <span class="n">predictions1</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span>
</span><span id="CoTraining-521"><a href="#CoTraining-521"><span class="linenos">521</span></a>            <span class="n">temp_probas2</span> <span class="o">=</span> <span class="n">predictions2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining-522"><a href="#CoTraining-522"><span class="linenos">522</span></a>            <span class="n">temp_probasB</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions1</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span><span class="o">+</span><span class="n">predictions2</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</span><span id="CoTraining-523"><a href="#CoTraining-523"><span class="linenos">523</span></a>
</span><span id="CoTraining-524"><a href="#CoTraining-524"><span class="linenos">524</span></a>            <span class="n">temp_classes2</span> <span class="o">=</span> <span class="n">class_predicted2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining-525"><a href="#CoTraining-525"><span class="linenos">525</span></a>
</span><span id="CoTraining-526"><a href="#CoTraining-526"><span class="linenos">526</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas1</span>
</span><span id="CoTraining-527"><a href="#CoTraining-527"><span class="linenos">527</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas2</span>
</span><span id="CoTraining-528"><a href="#CoTraining-528"><span class="linenos">528</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probasB</span>
</span><span id="CoTraining-529"><a href="#CoTraining-529"><span class="linenos">529</span></a>            <span class="n">y_class</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_classes2</span>
</span><span id="CoTraining-530"><a href="#CoTraining-530"><span class="linenos">530</span></a>
</span><span id="CoTraining-531"><a href="#CoTraining-531"><span class="linenos">531</span></a>            <span class="c1"># Select the best candidates</span>
</span><span id="CoTraining-532"><a href="#CoTraining-532"><span class="linenos">532</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="CoTraining-533"><a href="#CoTraining-533"><span class="linenos">533</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CoTraining-534"><a href="#CoTraining-534"><span class="linenos">534</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTraining-535"><a href="#CoTraining-535"><span class="linenos">535</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">y_class</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="CoTraining-536"><a href="#CoTraining-536"><span class="linenos">536</span></a>
</span><span id="CoTraining-537"><a href="#CoTraining-537"><span class="linenos">537</span></a>            <span class="c1"># Fill the new labeled instances</span>
</span><span id="CoTraining-538"><a href="#CoTraining-538"><span class="linenos">538</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">y_class</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining-539"><a href="#CoTraining-539"><span class="linenos">539</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTraining-540"><a href="#CoTraining-540"><span class="linenos">540</span></a>
</span><span id="CoTraining-541"><a href="#CoTraining-541"><span class="linenos">541</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining-542"><a href="#CoTraining-542"><span class="linenos">542</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining-543"><a href="#CoTraining-543"><span class="linenos">543</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining-544"><a href="#CoTraining-544"><span class="linenos">544</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining-545"><a href="#CoTraining-545"><span class="linenos">545</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-546"><a href="#CoTraining-546"><span class="linenos">546</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining-547"><a href="#CoTraining-547"><span class="linenos">547</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining-548"><a href="#CoTraining-548"><span class="linenos">548</span></a>
</span><span id="CoTraining-549"><a href="#CoTraining-549"><span class="linenos">549</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTraining-550"><a href="#CoTraining-550"><span class="linenos">550</span></a>
</span><span id="CoTraining-551"><a href="#CoTraining-551"><span class="linenos">551</span></a>            <span class="c1"># Poolsize increments in order double of max instances candidates:</span>
</span><span id="CoTraining-552"><a href="#CoTraining-552"><span class="linenos">552</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">number_per_class</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining-553"><a href="#CoTraining-553"><span class="linenos">553</span></a>
</span><span id="CoTraining-554"><a href="#CoTraining-554"><span class="linenos">554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-555"><a href="#CoTraining-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining-556"><a href="#CoTraining-556"><span class="linenos">556</span></a>
</span><span id="CoTraining-557"><a href="#CoTraining-557"><span class="linenos">557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
</span><span id="CoTraining-558"><a href="#CoTraining-558"><span class="linenos">558</span></a>
</span><span id="CoTraining-559"><a href="#CoTraining-559"><span class="linenos">559</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CoTraining-560"><a href="#CoTraining-560"><span class="linenos">560</span></a>
</span><span id="CoTraining-561"><a href="#CoTraining-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-562"><a href="#CoTraining-562"><span class="linenos">562</span></a>        <span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="CoTraining-563"><a href="#CoTraining-563"><span class="linenos">563</span></a>
</span><span id="CoTraining-564"><a href="#CoTraining-564"><span class="linenos">564</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-565"><a href="#CoTraining-565"><span class="linenos">565</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-566"><a href="#CoTraining-566"><span class="linenos">566</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-567"><a href="#CoTraining-567"><span class="linenos">567</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-568"><a href="#CoTraining-568"><span class="linenos">568</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-569"><a href="#CoTraining-569"><span class="linenos">569</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-570"><a href="#CoTraining-570"><span class="linenos">570</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-571"><a href="#CoTraining-571"><span class="linenos">571</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-572"><a href="#CoTraining-572"><span class="linenos">572</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="CoTraining-573"><a href="#CoTraining-573"><span class="linenos">573</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="CoTraining-574"><a href="#CoTraining-574"><span class="linenos">574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-575"><a href="#CoTraining-575"><span class="linenos">575</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-576"><a href="#CoTraining-576"><span class="linenos">576</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-577"><a href="#CoTraining-577"><span class="linenos">577</span></a>        <span class="k">elif</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-578"><a href="#CoTraining-578"><span class="linenos">578</span></a>            <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoTraining-579"><a href="#CoTraining-579"><span class="linenos">579</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining-580"><a href="#CoTraining-580"><span class="linenos">580</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining-581"><a href="#CoTraining-581"><span class="linenos">581</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="CoTraining-582"><a href="#CoTraining-582"><span class="linenos">582</span></a>            <span class="k">return</span> <span class="n">y</span>
</span><span id="CoTraining-583"><a href="#CoTraining-583"><span class="linenos">583</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-584"><a href="#CoTraining-584"><span class="linenos">584</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span><span id="CoTraining-585"><a href="#CoTraining-585"><span class="linenos">585</span></a>
</span><span id="CoTraining-586"><a href="#CoTraining-586"><span class="linenos">586</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-587"><a href="#CoTraining-587"><span class="linenos">587</span></a>        <span class="sd">&quot;&quot;&quot;Predict the classes of X.</span>
</span><span id="CoTraining-588"><a href="#CoTraining-588"><span class="linenos">588</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-589"><a href="#CoTraining-589"><span class="linenos">589</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-590"><a href="#CoTraining-590"><span class="linenos">590</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining-591"><a href="#CoTraining-591"><span class="linenos">591</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining-592"><a href="#CoTraining-592"><span class="linenos">592</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-593"><a href="#CoTraining-593"><span class="linenos">593</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-594"><a href="#CoTraining-594"><span class="linenos">594</span></a>
</span><span id="CoTraining-595"><a href="#CoTraining-595"><span class="linenos">595</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-596"><a href="#CoTraining-596"><span class="linenos">596</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-597"><a href="#CoTraining-597"><span class="linenos">597</span></a><span class="sd">        y : ndarray of shape (n_samples,)</span>
</span><span id="CoTraining-598"><a href="#CoTraining-598"><span class="linenos">598</span></a><span class="sd">            Array with predicted labels.</span>
</span><span id="CoTraining-599"><a href="#CoTraining-599"><span class="linenos">599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-600"><a href="#CoTraining-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining-601"><a href="#CoTraining-601"><span class="linenos">601</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-602"><a href="#CoTraining-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-603"><a href="#CoTraining-603"><span class="linenos">603</span></a>            <span class="n">predicted_probabilitiy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining-604"><a href="#CoTraining-604"><span class="linenos">604</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span>
</span><span id="CoTraining-605"><a href="#CoTraining-605"><span class="linenos">605</span></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted_probabilitiy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="CoTraining-606"><a href="#CoTraining-606"><span class="linenos">606</span></a>            <span class="p">)</span>
</span><span id="CoTraining-607"><a href="#CoTraining-607"><span class="linenos">607</span></a>        <span class="k">return</span> <span class="n">result</span>
</span><span id="CoTraining-608"><a href="#CoTraining-608"><span class="linenos">608</span></a>
</span><span id="CoTraining-609"><a href="#CoTraining-609"><span class="linenos">609</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining-610"><a href="#CoTraining-610"><span class="linenos">610</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining-611"><a href="#CoTraining-611"><span class="linenos">611</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTraining-612"><a href="#CoTraining-612"><span class="linenos">612</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="CoTraining-613"><a href="#CoTraining-613"><span class="linenos">613</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="CoTraining-614"><a href="#CoTraining-614"><span class="linenos">614</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="CoTraining-615"><a href="#CoTraining-615"><span class="linenos">615</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining-616"><a href="#CoTraining-616"><span class="linenos">616</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining-617"><a href="#CoTraining-617"><span class="linenos">617</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTraining-618"><a href="#CoTraining-618"><span class="linenos">618</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTraining-619"><a href="#CoTraining-619"><span class="linenos">619</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTraining-620"><a href="#CoTraining-620"><span class="linenos">620</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="CoTraining-621"><a href="#CoTraining-621"><span class="linenos">621</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="CoTraining-622"><a href="#CoTraining-622"><span class="linenos">622</span></a><span class="sd">            Sample weights.</span>
</span><span id="CoTraining-623"><a href="#CoTraining-623"><span class="linenos">623</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining-624"><a href="#CoTraining-624"><span class="linenos">624</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining-625"><a href="#CoTraining-625"><span class="linenos">625</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining-626"><a href="#CoTraining-626"><span class="linenos">626</span></a><span class="sd">        -------</span>
</span><span id="CoTraining-627"><a href="#CoTraining-627"><span class="linenos">627</span></a><span class="sd">        score : float</span>
</span><span id="CoTraining-628"><a href="#CoTraining-628"><span class="linenos">628</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` wrt. `y`.</span>
</span><span id="CoTraining-629"><a href="#CoTraining-629"><span class="linenos">629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining-630"><a href="#CoTraining-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="s2">&quot;X2&quot;</span> <span class="ow">in</span> <span class="n">kwards</span><span class="p">:</span>
</span><span id="CoTraining-631"><a href="#CoTraining-631"><span class="linenos">631</span></a>            <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">kwards</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="CoTraining-632"><a href="#CoTraining-632"><span class="linenos">632</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining-633"><a href="#CoTraining-633"><span class="linenos">633</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#CoTraining.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="CoTraining.__init__" class="classattr">
                                        <input id="CoTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span>,</span><span class="param">	<span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="CoTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.__init__-367"><a href="#CoTraining.__init__-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CoTraining.__init__-368"><a href="#CoTraining.__init__-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CoTraining.__init__-369"><a href="#CoTraining.__init__-369"><span class="linenos">369</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="CoTraining.__init__-370"><a href="#CoTraining.__init__-370"><span class="linenos">370</span></a>        <span class="n">second_base_estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CoTraining.__init__-371"><a href="#CoTraining.__init__-371"><span class="linenos">371</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span><span id="CoTraining.__init__-372"><a href="#CoTraining.__init__-372"><span class="linenos">372</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
</span><span id="CoTraining.__init__-373"><a href="#CoTraining.__init__-373"><span class="linenos">373</span></a>        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="CoTraining.__init__-374"><a href="#CoTraining.__init__-374"><span class="linenos">374</span></a>        <span class="n">force_second_view</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CoTraining.__init__-375"><a href="#CoTraining.__init__-375"><span class="linenos">375</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CoTraining.__init__-376"><a href="#CoTraining.__init__-376"><span class="linenos">376</span></a>    <span class="p">):</span>
</span><span id="CoTraining.__init__-377"><a href="#CoTraining.__init__-377"><span class="linenos">377</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.__init__-378"><a href="#CoTraining.__init__-378"><span class="linenos">378</span></a><span class="sd">        Create a CoTraining classifier. </span>
</span><span id="CoTraining.__init__-379"><a href="#CoTraining.__init__-379"><span class="linenos">379</span></a><span class="sd">        Multi-view learning algorithm that uses two classifiers to label instances.</span>
</span><span id="CoTraining.__init__-380"><a href="#CoTraining.__init__-380"><span class="linenos">380</span></a>
</span><span id="CoTraining.__init__-381"><a href="#CoTraining.__init__-381"><span class="linenos">381</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.__init__-382"><a href="#CoTraining.__init__-382"><span class="linenos">382</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.__init__-383"><a href="#CoTraining.__init__-383"><span class="linenos">383</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining.__init__-384"><a href="#CoTraining.__init__-384"><span class="linenos">384</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</span>
</span><span id="CoTraining.__init__-385"><a href="#CoTraining.__init__-385"><span class="linenos">385</span></a><span class="sd">        second_base_estimator : ClassifierMixin, optional</span>
</span><span id="CoTraining.__init__-386"><a href="#CoTraining.__init__-386"><span class="linenos">386</span></a><span class="sd">            The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</span>
</span><span id="CoTraining.__init__-387"><a href="#CoTraining.__init__-387"><span class="linenos">387</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="CoTraining.__init__-388"><a href="#CoTraining.__init__-388"><span class="linenos">388</span></a><span class="sd">            The number of iterations, by default 30</span>
</span><span id="CoTraining.__init__-389"><a href="#CoTraining.__init__-389"><span class="linenos">389</span></a><span class="sd">        poolsize : int, optional</span>
</span><span id="CoTraining.__init__-390"><a href="#CoTraining.__init__-390"><span class="linenos">390</span></a><span class="sd">            The size of the pool of unlabeled samples from which the classifier can choose, by default 75</span>
</span><span id="CoTraining.__init__-391"><a href="#CoTraining.__init__-391"><span class="linenos">391</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoTraining.__init__-392"><a href="#CoTraining.__init__-392"><span class="linenos">392</span></a><span class="sd">            The threshold for label instances, by default 0.5</span>
</span><span id="CoTraining.__init__-393"><a href="#CoTraining.__init__-393"><span class="linenos">393</span></a><span class="sd">        force_second_view : bool, optional</span>
</span><span id="CoTraining.__init__-394"><a href="#CoTraining.__init__-394"><span class="linenos">394</span></a><span class="sd">            The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</span>
</span><span id="CoTraining.__init__-395"><a href="#CoTraining.__init__-395"><span class="linenos">395</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoTraining.__init__-396"><a href="#CoTraining.__init__-396"><span class="linenos">396</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoTraining.__init__-397"><a href="#CoTraining.__init__-397"><span class="linenos">397</span></a>
</span><span id="CoTraining.__init__-398"><a href="#CoTraining.__init__-398"><span class="linenos">398</span></a><span class="sd">        References</span>
</span><span id="CoTraining.__init__-399"><a href="#CoTraining.__init__-399"><span class="linenos">399</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.__init__-400"><a href="#CoTraining.__init__-400"><span class="linenos">400</span></a><span class="sd">        Avrim Blum and Tom Mitchell. 1998.</span>
</span><span id="CoTraining.__init__-401"><a href="#CoTraining.__init__-401"><span class="linenos">401</span></a><span class="sd">        Combining labeled and unlabeled data with co-training.</span>
</span><span id="CoTraining.__init__-402"><a href="#CoTraining.__init__-402"><span class="linenos">402</span></a><span class="sd">        In Proceedings of the eleventh annual conference on Computational learning theory (COLT&#39; 98).</span>
</span><span id="CoTraining.__init__-403"><a href="#CoTraining.__init__-403"><span class="linenos">403</span></a><span class="sd">        Association for Computing Machinery, New York, NY, USA, 92-100.</span>
</span><span id="CoTraining.__init__-404"><a href="#CoTraining.__init__-404"><span class="linenos">404</span></a><span class="sd">        DOI:https://doi.org/10.1145/279943.279962</span>
</span><span id="CoTraining.__init__-405"><a href="#CoTraining.__init__-405"><span class="linenos">405</span></a>
</span><span id="CoTraining.__init__-406"><a href="#CoTraining.__init__-406"><span class="linenos">406</span></a><span class="sd">        Han, Xian-Hua, Yen-wei Chen, and Xiang Ruan. 2011. </span>
</span><span id="CoTraining.__init__-407"><a href="#CoTraining.__init__-407"><span class="linenos">407</span></a><span class="sd">        &#39;Multi-Class Co-Training Learning for Object and Scene Recognition&#39;.</span>
</span><span id="CoTraining.__init__-408"><a href="#CoTraining.__init__-408"><span class="linenos">408</span></a><span class="sd">        Pp. 67-70 in. Nara, Japan.</span>
</span><span id="CoTraining.__init__-409"><a href="#CoTraining.__init__-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.__init__-410"><a href="#CoTraining.__init__-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining.__init__-411"><a href="#CoTraining.__init__-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.__init__-412"><a href="#CoTraining.__init__-412"><span class="linenos">412</span></a>            <span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">second_base_estimator</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="CoTraining.__init__-413"><a href="#CoTraining.__init__-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="o">=</span> <span class="n">second_base_estimator</span>
</span><span id="CoTraining.__init__-414"><a href="#CoTraining.__init__-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="CoTraining.__init__-415"><a href="#CoTraining.__init__-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="CoTraining.__init__-416"><a href="#CoTraining.__init__-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoTraining.__init__-417"><a href="#CoTraining.__init__-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span> <span class="o">=</span> <span class="n">force_second_view</span>
</span><span id="CoTraining.__init__-418"><a href="#CoTraining.__init__-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Create a CoTraining classifier. 
Multi-view learning algorithm that uses two classifiers to label instances.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
The classifier that will be used in the cotraining algorithm on the feature set, by default DecisionTreeClassifier()</li>
<li><strong>second_base_estimator</strong> (ClassifierMixin, optional):
The classifier that will be used in the cotraining algorithm on another feature set, if none are a clone of base_estimator, by default None</li>
<li><strong>max_iterations</strong> (int, optional):
The number of iterations, by default 30</li>
<li><strong>poolsize</strong> (int, optional):
The size of the pool of unlabeled samples from which the classifier can choose, by default 75</li>
<li><strong>threshold</strong> (float, optional):
The threshold for label instances, by default 0.5</li>
<li><strong>force_second_view</strong> (bool, optional):
The second classifier needs a different view of the data. If False then a second view will be same as the first, by default True</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Avrim Blum and Tom Mitchell. 1998.
Combining labeled and unlabeled data with co-training.
In Proceedings of the eleventh annual conference on Computational learning theory (COLT' 98).
Association for Computing Machinery, New York, NY, USA, 92-100.
DOI:<a href="https://doi.org/10.1145/279943.279962">https://doi.org/10.1145/279943.279962</a></p>

<p>Han, Xian-Hua, Yen-wei Chen, and Xiang Ruan. 2011. 
'Multi-Class Co-Training Learning for Object and Scene Recognition'.
Pp. 67-70 in. Nara, Japan.</p>
</div>


                            </div>
                            <div id="CoTraining.fit" class="classattr">
                                        <input id="CoTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">X</span>,</span><span class="param">	<span class="n">y</span>,</span><span class="param">	<span class="n">X2</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.fit-420"><a href="#CoTraining.fit-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number_per_class</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.fit-421"><a href="#CoTraining.fit-421"><span class="linenos">421</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.fit-422"><a href="#CoTraining.fit-422"><span class="linenos">422</span></a><span class="sd">        Build a CoTraining classifier from the training set.</span>
</span><span id="CoTraining.fit-423"><a href="#CoTraining.fit-423"><span class="linenos">423</span></a>
</span><span id="CoTraining.fit-424"><a href="#CoTraining.fit-424"><span class="linenos">424</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.fit-425"><a href="#CoTraining.fit-425"><span class="linenos">425</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.fit-426"><a href="#CoTraining.fit-426"><span class="linenos">426</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.fit-427"><a href="#CoTraining.fit-427"><span class="linenos">427</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.fit-428"><a href="#CoTraining.fit-428"><span class="linenos">428</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoTraining.fit-429"><a href="#CoTraining.fit-429"><span class="linenos">429</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="CoTraining.fit-430"><a href="#CoTraining.fit-430"><span class="linenos">430</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.fit-431"><a href="#CoTraining.fit-431"><span class="linenos">431</span></a><span class="sd">            Array representing the data from another view, not compatible with `features`, by default None</span>
</span><span id="CoTraining.fit-432"><a href="#CoTraining.fit-432"><span class="linenos">432</span></a><span class="sd">        features : {list, tuple}, optional</span>
</span><span id="CoTraining.fit-433"><a href="#CoTraining.fit-433"><span class="linenos">433</span></a><span class="sd">            list or tuple of two arrays with `feature` index for each subspace view, not compatible with `X2`, by default None</span>
</span><span id="CoTraining.fit-434"><a href="#CoTraining.fit-434"><span class="linenos">434</span></a><span class="sd">        number_per_class : {dict}, optional</span>
</span><span id="CoTraining.fit-435"><a href="#CoTraining.fit-435"><span class="linenos">435</span></a><span class="sd">            dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</span>
</span><span id="CoTraining.fit-436"><a href="#CoTraining.fit-436"><span class="linenos">436</span></a>
</span><span id="CoTraining.fit-437"><a href="#CoTraining.fit-437"><span class="linenos">437</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.fit-438"><a href="#CoTraining.fit-438"><span class="linenos">438</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.fit-439"><a href="#CoTraining.fit-439"><span class="linenos">439</span></a><span class="sd">        self: CoTraining</span>
</span><span id="CoTraining.fit-440"><a href="#CoTraining.fit-440"><span class="linenos">440</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoTraining.fit-441"><a href="#CoTraining.fit-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.fit-442"><a href="#CoTraining.fit-442"><span class="linenos">442</span></a>        <span class="n">rs</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoTraining.fit-443"><a href="#CoTraining.fit-443"><span class="linenos">443</span></a>
</span><span id="CoTraining.fit-444"><a href="#CoTraining.fit-444"><span class="linenos">444</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining.fit-445"><a href="#CoTraining.fit-445"><span class="linenos">445</span></a>
</span><span id="CoTraining.fit-446"><a href="#CoTraining.fit-446"><span class="linenos">446</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoTraining.fit-447"><a href="#CoTraining.fit-447"><span class="linenos">447</span></a>
</span><span id="CoTraining.fit-448"><a href="#CoTraining.fit-448"><span class="linenos">448</span></a>        <span class="k">if</span> <span class="n">X2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-449"><a href="#CoTraining.fit-449"><span class="linenos">449</span></a>            <span class="n">X2_label</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoTraining.fit-450"><a href="#CoTraining.fit-450"><span class="linenos">450</span></a>        <span class="k">elif</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-451"><a href="#CoTraining.fit-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining.fit-452"><a href="#CoTraining.fit-452"><span class="linenos">452</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-453"><a href="#CoTraining.fit-453"><span class="linenos">453</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-454"><a href="#CoTraining.fit-454"><span class="linenos">454</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-455"><a href="#CoTraining.fit-455"><span class="linenos">455</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-456"><a href="#CoTraining.fit-456"><span class="linenos">456</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-457"><a href="#CoTraining.fit-457"><span class="linenos">457</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-458"><a href="#CoTraining.fit-458"><span class="linenos">458</span></a>                <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="CoTraining.fit-459"><a href="#CoTraining.fit-459"><span class="linenos">459</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-460"><a href="#CoTraining.fit-460"><span class="linenos">460</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[:,</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="CoTraining.fit-461"><a href="#CoTraining.fit-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="n">features</span>
</span><span id="CoTraining.fit-462"><a href="#CoTraining.fit-462"><span class="linenos">462</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_second_view</span><span class="p">:</span>
</span><span id="CoTraining.fit-463"><a href="#CoTraining.fit-463"><span class="linenos">463</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Either X2 or features must be defined. CoTraining need another view to train the second classifier&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-464"><a href="#CoTraining.fit-464"><span class="linenos">464</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-465"><a href="#CoTraining.fit-465"><span class="linenos">465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining.fit-466"><a href="#CoTraining.fit-466"><span class="linenos">466</span></a>            <span class="n">X2_label</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-467"><a href="#CoTraining.fit-467"><span class="linenos">467</span></a>            <span class="n">X2_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-468"><a href="#CoTraining.fit-468"><span class="linenos">468</span></a>
</span><span id="CoTraining.fit-469"><a href="#CoTraining.fit-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="n">is_df</span> <span class="ow">and</span> <span class="n">X2_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="CoTraining.fit-470"><a href="#CoTraining.fit-470"><span class="linenos">470</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;X and X2 must be both pandas DataFrame or numpy arrays&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-471"><a href="#CoTraining.fit-471"><span class="linenos">471</span></a>
</span><span id="CoTraining.fit-472"><a href="#CoTraining.fit-472"><span class="linenos">472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CoTraining.fit-473"><a href="#CoTraining.fit-473"><span class="linenos">473</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">),</span>
</span><span id="CoTraining.fit-474"><a href="#CoTraining.fit-474"><span class="linenos">474</span></a>            <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second_base_estimator</span><span class="p">)</span>
</span><span id="CoTraining.fit-475"><a href="#CoTraining.fit-475"><span class="linenos">475</span></a>        <span class="p">]</span>
</span><span id="CoTraining.fit-476"><a href="#CoTraining.fit-476"><span class="linenos">476</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="CoTraining.fit-477"><a href="#CoTraining.fit-477"><span class="linenos">477</span></a>            <span class="n">X2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">features</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="CoTraining.fit-478"><a href="#CoTraining.fit-478"><span class="linenos">478</span></a>        <span class="p">),</span> <span class="s2">&quot;The list of features and X2 cannot be defined at the same time&quot;</span>
</span><span id="CoTraining.fit-479"><a href="#CoTraining.fit-479"><span class="linenos">479</span></a>
</span><span id="CoTraining.fit-480"><a href="#CoTraining.fit-480"><span class="linenos">480</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-481"><a href="#CoTraining.fit-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="n">number_per_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoTraining.fit-482"><a href="#CoTraining.fit-482"><span class="linenos">482</span></a>            <span class="n">number_per_class</span> <span class="o">=</span> <span class="n">calc_number_per_class</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-483"><a href="#CoTraining.fit-483"><span class="linenos">483</span></a>
</span><span id="CoTraining.fit-484"><a href="#CoTraining.fit-484"><span class="linenos">484</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">:</span>
</span><span id="CoTraining.fit-485"><a href="#CoTraining.fit-485"><span class="linenos">485</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Poolsize (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="si">}</span><span class="s2">) is bigger than U (</span><span class="si">{</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="CoTraining.fit-486"><a href="#CoTraining.fit-486"><span class="linenos">486</span></a>
</span><span id="CoTraining.fit-487"><a href="#CoTraining.fit-487"><span class="linenos">487</span></a>        <span class="n">permutation</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">))</span>
</span><span id="CoTraining.fit-488"><a href="#CoTraining.fit-488"><span class="linenos">488</span></a>
</span><span id="CoTraining.fit-489"><a href="#CoTraining.fit-489"><span class="linenos">489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-490"><a href="#CoTraining.fit-490"><span class="linenos">490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-491"><a href="#CoTraining.fit-491"><span class="linenos">491</span></a>
</span><span id="CoTraining.fit-492"><a href="#CoTraining.fit-492"><span class="linenos">492</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoTraining.fit-493"><a href="#CoTraining.fit-493"><span class="linenos">493</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">permutation</span><span class="p">):</span>
</span><span id="CoTraining.fit-494"><a href="#CoTraining.fit-494"><span class="linenos">494</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="CoTraining.fit-495"><a href="#CoTraining.fit-495"><span class="linenos">495</span></a>
</span><span id="CoTraining.fit-496"><a href="#CoTraining.fit-496"><span class="linenos">496</span></a>            <span class="n">get_index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">]</span>
</span><span id="CoTraining.fit-497"><a href="#CoTraining.fit-497"><span class="linenos">497</span></a>            <span class="n">y1_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining.fit-498"><a href="#CoTraining.fit-498"><span class="linenos">498</span></a>            <span class="n">y2_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2_unlabel</span><span class="p">[</span><span class="n">get_index</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">get_index</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="CoTraining.fit-499"><a href="#CoTraining.fit-499"><span class="linenos">499</span></a>
</span><span id="CoTraining.fit-500"><a href="#CoTraining.fit-500"><span class="linenos">500</span></a>            <span class="n">predictions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-501"><a href="#CoTraining.fit-501"><span class="linenos">501</span></a>            <span class="n">class_predicted1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y1_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-502"><a href="#CoTraining.fit-502"><span class="linenos">502</span></a>
</span><span id="CoTraining.fit-503"><a href="#CoTraining.fit-503"><span class="linenos">503</span></a>            <span class="n">predictions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-504"><a href="#CoTraining.fit-504"><span class="linenos">504</span></a>            <span class="n">class_predicted2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y2_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoTraining.fit-505"><a href="#CoTraining.fit-505"><span class="linenos">505</span></a>
</span><span id="CoTraining.fit-506"><a href="#CoTraining.fit-506"><span class="linenos">506</span></a>            <span class="c1"># If two classifier select same instance and bring different predictions then the instance is not labeled</span>
</span><span id="CoTraining.fit-507"><a href="#CoTraining.fit-507"><span class="linenos">507</span></a>            <span class="n">candidates1</span> <span class="o">=</span> <span class="n">predictions1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining.fit-508"><a href="#CoTraining.fit-508"><span class="linenos">508</span></a>            <span class="n">candidates2</span> <span class="o">=</span> <span class="n">predictions2</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoTraining.fit-509"><a href="#CoTraining.fit-509"><span class="linenos">509</span></a>            <span class="n">aggreement</span> <span class="o">=</span> <span class="n">class_predicted1</span> <span class="o">==</span> <span class="n">class_predicted2</span>
</span><span id="CoTraining.fit-510"><a href="#CoTraining.fit-510"><span class="linenos">510</span></a>
</span><span id="CoTraining.fit-511"><a href="#CoTraining.fit-511"><span class="linenos">511</span></a>            <span class="n">full_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">^</span> <span class="n">candidates2</span>
</span><span id="CoTraining.fit-512"><a href="#CoTraining.fit-512"><span class="linenos">512</span></a>            <span class="n">medium_candidates</span> <span class="o">=</span> <span class="n">candidates1</span> <span class="o">&amp;</span> <span class="n">candidates2</span> <span class="o">&amp;</span> <span class="n">aggreement</span>
</span><span id="CoTraining.fit-513"><a href="#CoTraining.fit-513"><span class="linenos">513</span></a>            <span class="n">true_candidates1</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates1</span>
</span><span id="CoTraining.fit-514"><a href="#CoTraining.fit-514"><span class="linenos">514</span></a>            <span class="n">true_candidates2</span> <span class="o">=</span> <span class="n">full_candidates</span> <span class="o">&amp;</span> <span class="n">candidates2</span>
</span><span id="CoTraining.fit-515"><a href="#CoTraining.fit-515"><span class="linenos">515</span></a>
</span><span id="CoTraining.fit-516"><a href="#CoTraining.fit-516"><span class="linenos">516</span></a>            <span class="c1"># Fill probas and candidate classes.</span>
</span><span id="CoTraining.fit-517"><a href="#CoTraining.fit-517"><span class="linenos">517</span></a>            <span class="n">y_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">predictions1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions1</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoTraining.fit-518"><a href="#CoTraining.fit-518"><span class="linenos">518</span></a>            <span class="n">y_class</span> <span class="o">=</span> <span class="n">class_predicted1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoTraining.fit-519"><a href="#CoTraining.fit-519"><span class="linenos">519</span></a>
</span><span id="CoTraining.fit-520"><a href="#CoTraining.fit-520"><span class="linenos">520</span></a>            <span class="n">temp_probas1</span> <span class="o">=</span> <span class="n">predictions1</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span>
</span><span id="CoTraining.fit-521"><a href="#CoTraining.fit-521"><span class="linenos">521</span></a>            <span class="n">temp_probas2</span> <span class="o">=</span> <span class="n">predictions2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining.fit-522"><a href="#CoTraining.fit-522"><span class="linenos">522</span></a>            <span class="n">temp_probasB</span> <span class="o">=</span> <span class="p">(</span><span class="n">predictions1</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span><span class="o">+</span><span class="n">predictions2</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</span><span id="CoTraining.fit-523"><a href="#CoTraining.fit-523"><span class="linenos">523</span></a>
</span><span id="CoTraining.fit-524"><a href="#CoTraining.fit-524"><span class="linenos">524</span></a>            <span class="n">temp_classes2</span> <span class="o">=</span> <span class="n">class_predicted2</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span>
</span><span id="CoTraining.fit-525"><a href="#CoTraining.fit-525"><span class="linenos">525</span></a>
</span><span id="CoTraining.fit-526"><a href="#CoTraining.fit-526"><span class="linenos">526</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas1</span>
</span><span id="CoTraining.fit-527"><a href="#CoTraining.fit-527"><span class="linenos">527</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probas2</span>
</span><span id="CoTraining.fit-528"><a href="#CoTraining.fit-528"><span class="linenos">528</span></a>            <span class="n">y_probas</span><span class="p">[</span><span class="n">medium_candidates</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_probasB</span>
</span><span id="CoTraining.fit-529"><a href="#CoTraining.fit-529"><span class="linenos">529</span></a>            <span class="n">y_class</span><span class="p">[</span><span class="n">true_candidates2</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_classes2</span>
</span><span id="CoTraining.fit-530"><a href="#CoTraining.fit-530"><span class="linenos">530</span></a>
</span><span id="CoTraining.fit-531"><a href="#CoTraining.fit-531"><span class="linenos">531</span></a>            <span class="c1"># Select the best candidates</span>
</span><span id="CoTraining.fit-532"><a href="#CoTraining.fit-532"><span class="linenos">532</span></a>            <span class="n">final_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="CoTraining.fit-533"><a href="#CoTraining.fit-533"><span class="linenos">533</span></a>            <span class="n">best_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">y_probas</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="CoTraining.fit-534"><a href="#CoTraining.fit-534"><span class="linenos">534</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">:</span>
</span><span id="CoTraining.fit-535"><a href="#CoTraining.fit-535"><span class="linenos">535</span></a>                <span class="n">final_instances</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">best_candidates</span><span class="p">[</span><span class="n">y_class</span><span class="p">[</span><span class="n">best_candidates</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">])[:</span><span class="n">number_per_class</span><span class="p">[</span><span class="n">c</span><span class="p">]]</span>
</span><span id="CoTraining.fit-536"><a href="#CoTraining.fit-536"><span class="linenos">536</span></a>
</span><span id="CoTraining.fit-537"><a href="#CoTraining.fit-537"><span class="linenos">537</span></a>            <span class="c1"># Fill the new labeled instances</span>
</span><span id="CoTraining.fit-538"><a href="#CoTraining.fit-538"><span class="linenos">538</span></a>            <span class="n">pseudoy</span> <span class="o">=</span> <span class="n">y_class</span><span class="p">[</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining.fit-539"><a href="#CoTraining.fit-539"><span class="linenos">539</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">pseudoy</span><span class="p">)</span>
</span><span id="CoTraining.fit-540"><a href="#CoTraining.fit-540"><span class="linenos">540</span></a>
</span><span id="CoTraining.fit-541"><a href="#CoTraining.fit-541"><span class="linenos">541</span></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">][</span><span class="n">final_instances</span><span class="p">]</span>
</span><span id="CoTraining.fit-542"><a href="#CoTraining.fit-542"><span class="linenos">542</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoTraining.fit-543"><a href="#CoTraining.fit-543"><span class="linenos">543</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining.fit-544"><a href="#CoTraining.fit-544"><span class="linenos">544</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoTraining.fit-545"><a href="#CoTraining.fit-545"><span class="linenos">545</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.fit-546"><a href="#CoTraining.fit-546"><span class="linenos">546</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining.fit-547"><a href="#CoTraining.fit-547"><span class="linenos">547</span></a>                <span class="n">X2_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">X2_unlabel</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoTraining.fit-548"><a href="#CoTraining.fit-548"><span class="linenos">548</span></a>
</span><span id="CoTraining.fit-549"><a href="#CoTraining.fit-549"><span class="linenos">549</span></a>            <span class="n">permutation</span> <span class="o">=</span> <span class="n">permutation</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index</span><span class="p">,</span> <span class="n">permutation</span><span class="p">))]</span>
</span><span id="CoTraining.fit-550"><a href="#CoTraining.fit-550"><span class="linenos">550</span></a>
</span><span id="CoTraining.fit-551"><a href="#CoTraining.fit-551"><span class="linenos">551</span></a>            <span class="c1"># Poolsize increments in order double of max instances candidates:</span>
</span><span id="CoTraining.fit-552"><a href="#CoTraining.fit-552"><span class="linenos">552</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">number_per_class</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="CoTraining.fit-553"><a href="#CoTraining.fit-553"><span class="linenos">553</span></a>
</span><span id="CoTraining.fit-554"><a href="#CoTraining.fit-554"><span class="linenos">554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-555"><a href="#CoTraining.fit-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="CoTraining.fit-556"><a href="#CoTraining.fit-556"><span class="linenos">556</span></a>
</span><span id="CoTraining.fit-557"><a href="#CoTraining.fit-557"><span class="linenos">557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span>
</span><span id="CoTraining.fit-558"><a href="#CoTraining.fit-558"><span class="linenos">558</span></a>
</span><span id="CoTraining.fit-559"><a href="#CoTraining.fit-559"><span class="linenos">559</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoTraining classifier from the training set.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, not compatible with <code>features</code>, by default None</li>
<li><strong>features</strong> ({list, tuple}, optional):
list or tuple of two arrays with <code>feature</code> index for each subspace view, not compatible with <code>X2</code>, by default None</li>
<li><strong>number_per_class</strong> ({dict}, optional):
dict of class name:integer with the max ammount of instances to label in this class in each iteration, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.predict_proba" class="classattr">
                                        <input id="CoTraining.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.predict_proba-561"><a href="#CoTraining.predict_proba-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-562"><a href="#CoTraining.predict_proba-562"><span class="linenos">562</span></a>        <span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="CoTraining.predict_proba-563"><a href="#CoTraining.predict_proba-563"><span class="linenos">563</span></a>
</span><span id="CoTraining.predict_proba-564"><a href="#CoTraining.predict_proba-564"><span class="linenos">564</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.predict_proba-565"><a href="#CoTraining.predict_proba-565"><span class="linenos">565</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.predict_proba-566"><a href="#CoTraining.predict_proba-566"><span class="linenos">566</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.predict_proba-567"><a href="#CoTraining.predict_proba-567"><span class="linenos">567</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.predict_proba-568"><a href="#CoTraining.predict_proba-568"><span class="linenos">568</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.predict_proba-569"><a href="#CoTraining.predict_proba-569"><span class="linenos">569</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.predict_proba-570"><a href="#CoTraining.predict_proba-570"><span class="linenos">570</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.predict_proba-571"><a href="#CoTraining.predict_proba-571"><span class="linenos">571</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.predict_proba-572"><a href="#CoTraining.predict_proba-572"><span class="linenos">572</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="CoTraining.predict_proba-573"><a href="#CoTraining.predict_proba-573"><span class="linenos">573</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="CoTraining.predict_proba-574"><a href="#CoTraining.predict_proba-574"><span class="linenos">574</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.predict_proba-575"><a href="#CoTraining.predict_proba-575"><span class="linenos">575</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-576"><a href="#CoTraining.predict_proba-576"><span class="linenos">576</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict_proba-577"><a href="#CoTraining.predict_proba-577"><span class="linenos">577</span></a>        <span class="k">elif</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict_proba-578"><a href="#CoTraining.predict_proba-578"><span class="linenos">578</span></a>            <span class="n">ys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoTraining.predict_proba-579"><a href="#CoTraining.predict_proba-579"><span class="linenos">579</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining.predict_proba-580"><a href="#CoTraining.predict_proba-580"><span class="linenos">580</span></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">))</span>
</span><span id="CoTraining.predict_proba-581"><a href="#CoTraining.predict_proba-581"><span class="linenos">581</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</span><span id="CoTraining.predict_proba-582"><a href="#CoTraining.predict_proba-582"><span class="linenos">582</span></a>            <span class="k">return</span> <span class="n">y</span>
</span><span id="CoTraining.predict_proba-583"><a href="#CoTraining.predict_proba-583"><span class="linenos">583</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.predict_proba-584"><a href="#CoTraining.predict_proba-584"><span class="linenos">584</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probability for each possible outcome.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>class probabilities</strong> (ndarray of shape (n_samples, n_classes)):
Array with prediction probabilities.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.predict" class="classattr">
                                        <input id="CoTraining.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">X2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.predict-586"><a href="#CoTraining.predict-586"><span class="linenos">586</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.predict-587"><a href="#CoTraining.predict-587"><span class="linenos">587</span></a>        <span class="sd">&quot;&quot;&quot;Predict the classes of X.</span>
</span><span id="CoTraining.predict-588"><a href="#CoTraining.predict-588"><span class="linenos">588</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.predict-589"><a href="#CoTraining.predict-589"><span class="linenos">589</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.predict-590"><a href="#CoTraining.predict-590"><span class="linenos">590</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoTraining.predict-591"><a href="#CoTraining.predict-591"><span class="linenos">591</span></a><span class="sd">            Array representing the data.</span>
</span><span id="CoTraining.predict-592"><a href="#CoTraining.predict-592"><span class="linenos">592</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.predict-593"><a href="#CoTraining.predict-593"><span class="linenos">593</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.predict-594"><a href="#CoTraining.predict-594"><span class="linenos">594</span></a>
</span><span id="CoTraining.predict-595"><a href="#CoTraining.predict-595"><span class="linenos">595</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.predict-596"><a href="#CoTraining.predict-596"><span class="linenos">596</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.predict-597"><a href="#CoTraining.predict-597"><span class="linenos">597</span></a><span class="sd">        y : ndarray of shape (n_samples,)</span>
</span><span id="CoTraining.predict-598"><a href="#CoTraining.predict-598"><span class="linenos">598</span></a><span class="sd">            Array with predicted labels.</span>
</span><span id="CoTraining.predict-599"><a href="#CoTraining.predict-599"><span class="linenos">599</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.predict-600"><a href="#CoTraining.predict-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="s2">&quot;columns_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CoTraining.predict-601"><a href="#CoTraining.predict-601"><span class="linenos">601</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict-602"><a href="#CoTraining.predict-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.predict-603"><a href="#CoTraining.predict-603"><span class="linenos">603</span></a>            <span class="n">predicted_probabilitiy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoTraining.predict-604"><a href="#CoTraining.predict-604"><span class="linenos">604</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span>
</span><span id="CoTraining.predict-605"><a href="#CoTraining.predict-605"><span class="linenos">605</span></a>                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted_probabilitiy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="CoTraining.predict-606"><a href="#CoTraining.predict-606"><span class="linenos">606</span></a>            <span class="p">)</span>
</span><span id="CoTraining.predict-607"><a href="#CoTraining.predict-607"><span class="linenos">607</span></a>        <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Predict the classes of X.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples,)):
Array with predicted labels.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.score" class="classattr">
                                        <input id="CoTraining.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoTraining.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoTraining.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoTraining.score-609"><a href="#CoTraining.score-609"><span class="linenos">609</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoTraining.score-610"><a href="#CoTraining.score-610"><span class="linenos">610</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoTraining.score-611"><a href="#CoTraining.score-611"><span class="linenos">611</span></a><span class="sd">        Return the mean accuracy on the given test data and labels.</span>
</span><span id="CoTraining.score-612"><a href="#CoTraining.score-612"><span class="linenos">612</span></a><span class="sd">        In multi-label classification, this is the subset accuracy</span>
</span><span id="CoTraining.score-613"><a href="#CoTraining.score-613"><span class="linenos">613</span></a><span class="sd">        which is a harsh metric since you require for each sample that</span>
</span><span id="CoTraining.score-614"><a href="#CoTraining.score-614"><span class="linenos">614</span></a><span class="sd">        each label set be correctly predicted.</span>
</span><span id="CoTraining.score-615"><a href="#CoTraining.score-615"><span class="linenos">615</span></a><span class="sd">        Parameters</span>
</span><span id="CoTraining.score-616"><a href="#CoTraining.score-616"><span class="linenos">616</span></a><span class="sd">        ----------</span>
</span><span id="CoTraining.score-617"><a href="#CoTraining.score-617"><span class="linenos">617</span></a><span class="sd">        X : array-like of shape (n_samples, n_features)</span>
</span><span id="CoTraining.score-618"><a href="#CoTraining.score-618"><span class="linenos">618</span></a><span class="sd">            Test samples.</span>
</span><span id="CoTraining.score-619"><a href="#CoTraining.score-619"><span class="linenos">619</span></a><span class="sd">        y : array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</span><span id="CoTraining.score-620"><a href="#CoTraining.score-620"><span class="linenos">620</span></a><span class="sd">            True labels for `X`.</span>
</span><span id="CoTraining.score-621"><a href="#CoTraining.score-621"><span class="linenos">621</span></a><span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>
</span><span id="CoTraining.score-622"><a href="#CoTraining.score-622"><span class="linenos">622</span></a><span class="sd">            Sample weights.</span>
</span><span id="CoTraining.score-623"><a href="#CoTraining.score-623"><span class="linenos">623</span></a><span class="sd">        X2 : {array-like, sparse matrix} of shape (n_samples, n_features), optional</span>
</span><span id="CoTraining.score-624"><a href="#CoTraining.score-624"><span class="linenos">624</span></a><span class="sd">            Array representing the data from another view, by default None</span>
</span><span id="CoTraining.score-625"><a href="#CoTraining.score-625"><span class="linenos">625</span></a><span class="sd">        Returns</span>
</span><span id="CoTraining.score-626"><a href="#CoTraining.score-626"><span class="linenos">626</span></a><span class="sd">        -------</span>
</span><span id="CoTraining.score-627"><a href="#CoTraining.score-627"><span class="linenos">627</span></a><span class="sd">        score : float</span>
</span><span id="CoTraining.score-628"><a href="#CoTraining.score-628"><span class="linenos">628</span></a><span class="sd">            Mean accuracy of ``self.predict(X)`` wrt. `y`.</span>
</span><span id="CoTraining.score-629"><a href="#CoTraining.score-629"><span class="linenos">629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoTraining.score-630"><a href="#CoTraining.score-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="s2">&quot;X2&quot;</span> <span class="ow">in</span> <span class="n">kwards</span><span class="p">:</span>
</span><span id="CoTraining.score-631"><a href="#CoTraining.score-631"><span class="linenos">631</span></a>            <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">kwards</span><span class="p">[</span><span class="s2">&quot;X2&quot;</span><span class="p">]),</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="CoTraining.score-632"><a href="#CoTraining.score-632"><span class="linenos">632</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoTraining.score-633"><a href="#CoTraining.score-633"><span class="linenos">633</span></a>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mean accuracy on the given test data and labels.
In multi-label classification, this is the subset accuracy
which is a harsh metric since you require for each sample that
each label set be correctly predicted.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (array-like of shape (n_samples, n_features)):
Test samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,) or (n_samples, n_outputs)):
True labels for <code>X</code>.</li>
<li><strong>sample_weight</strong> (array-like of shape (n_samples,), default=None):
Sample weights.</li>
<li><strong>X2</strong> ({array-like, sparse matrix} of shape (n_samples, n_features), optional):
Array representing the data from another view, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Mean accuracy of <code>self.predict(X)</code> wrt. <code>y</code>.</li>
</ul>
</div>


                            </div>
                            <div id="CoTraining.set_fit_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fit_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoTraining.set_fit_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#CoTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="CoTraining.set_predict_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_predict_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoTraining.set_predict_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#CoTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="CoTraining.set_predict_proba_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_predict_proba_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoTraining.set_predict_proba_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#CoTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="CoTraining.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoTraining.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#CoTraining.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoTraining.get_params" class="function">get_params</dd>
                <dd id="CoTraining.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="CoTraining.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DeTriTraining">
                            <input id="DeTriTraining-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DeTriTraining</span><wbr>(<span class="base"><a href="#TriTraining">sslearn.wrapper.TriTraining</a></span>):

                <label class="view-source-button" for="DeTriTraining-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining-518"><a href="#DeTriTraining-518"><span class="linenos">518</span></a><span class="k">class</span> <span class="nc">DeTriTraining</span><span class="p">(</span><span class="n">TriTraining</span><span class="p">):</span>
</span><span id="DeTriTraining-519"><a href="#DeTriTraining-519"><span class="linenos">519</span></a>
</span><span id="DeTriTraining-520"><a href="#DeTriTraining-520"><span class="linenos">520</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeTriTraining-521"><a href="#DeTriTraining-521"><span class="linenos">521</span></a>                 <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;seeded&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeTriTraining-522"><a href="#DeTriTraining-522"><span class="linenos">522</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeTriTraining-523"><a href="#DeTriTraining-523"><span class="linenos">523</span></a><span class="sd">        DeTriTraining - TriTraining with Depurated and Clustering.</span>
</span><span id="DeTriTraining-524"><a href="#DeTriTraining-524"><span class="linenos">524</span></a><span class="sd">        Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </span>
</span><span id="DeTriTraining-525"><a href="#DeTriTraining-525"><span class="linenos">525</span></a>
</span><span id="DeTriTraining-526"><a href="#DeTriTraining-526"><span class="linenos">526</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-527"><a href="#DeTriTraining-527"><span class="linenos">527</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-528"><a href="#DeTriTraining-528"><span class="linenos">528</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="DeTriTraining-529"><a href="#DeTriTraining-529"><span class="linenos">529</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="DeTriTraining-530"><a href="#DeTriTraining-530"><span class="linenos">530</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="DeTriTraining-531"><a href="#DeTriTraining-531"><span class="linenos">531</span></a><span class="sd">            Number of samples to generate. </span>
</span><span id="DeTriTraining-532"><a href="#DeTriTraining-532"><span class="linenos">532</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="DeTriTraining-533"><a href="#DeTriTraining-533"><span class="linenos">533</span></a><span class="sd">        k_neighbors : int, optional</span>
</span><span id="DeTriTraining-534"><a href="#DeTriTraining-534"><span class="linenos">534</span></a><span class="sd">            Number of neighbors for depurate classification. </span>
</span><span id="DeTriTraining-535"><a href="#DeTriTraining-535"><span class="linenos">535</span></a><span class="sd">            If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</span>
</span><span id="DeTriTraining-536"><a href="#DeTriTraining-536"><span class="linenos">536</span></a><span class="sd">        mode : string, optional</span>
</span><span id="DeTriTraining-537"><a href="#DeTriTraining-537"><span class="linenos">537</span></a><span class="sd">            How to calculate the cluster each instance belongs to.</span>
</span><span id="DeTriTraining-538"><a href="#DeTriTraining-538"><span class="linenos">538</span></a><span class="sd">            If `seeded` each instance belong to nearest cluster.</span>
</span><span id="DeTriTraining-539"><a href="#DeTriTraining-539"><span class="linenos">539</span></a><span class="sd">            If `constrained` each instance belong to nearest cluster unless the instance is in to enlarged dataset, </span>
</span><span id="DeTriTraining-540"><a href="#DeTriTraining-540"><span class="linenos">540</span></a><span class="sd">            then the instance belongs to the cluster of its class., by default `seeded`</span>
</span><span id="DeTriTraining-541"><a href="#DeTriTraining-541"><span class="linenos">541</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="DeTriTraining-542"><a href="#DeTriTraining-542"><span class="linenos">542</span></a><span class="sd">            Maximum number of iterations, by default 100</span>
</span><span id="DeTriTraining-543"><a href="#DeTriTraining-543"><span class="linenos">543</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="DeTriTraining-544"><a href="#DeTriTraining-544"><span class="linenos">544</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. </span>
</span><span id="DeTriTraining-545"><a href="#DeTriTraining-545"><span class="linenos">545</span></a><span class="sd">            None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. </span>
</span><span id="DeTriTraining-546"><a href="#DeTriTraining-546"><span class="linenos">546</span></a><span class="sd">            Doesn&#39;t affect fit method., by default None</span>
</span><span id="DeTriTraining-547"><a href="#DeTriTraining-547"><span class="linenos">547</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DeTriTraining-548"><a href="#DeTriTraining-548"><span class="linenos">548</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DeTriTraining-549"><a href="#DeTriTraining-549"><span class="linenos">549</span></a>
</span><span id="DeTriTraining-550"><a href="#DeTriTraining-550"><span class="linenos">550</span></a><span class="sd">        References</span>
</span><span id="DeTriTraining-551"><a href="#DeTriTraining-551"><span class="linenos">551</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-552"><a href="#DeTriTraining-552"><span class="linenos">552</span></a><span class="sd">        Deng C., Guo M.Z. (2006)</span>
</span><span id="DeTriTraining-553"><a href="#DeTriTraining-553"><span class="linenos">553</span></a><span class="sd">        Tri-training and Data Editing Based Semi-supervised Clustering Algorithm. </span>
</span><span id="DeTriTraining-554"><a href="#DeTriTraining-554"><span class="linenos">554</span></a><span class="sd">        In: Gelbukh A., Reyes-Garcia C.A. (eds) MICAI 2006: Advances in Artificial Intelligence. MICAI 2006. </span>
</span><span id="DeTriTraining-555"><a href="#DeTriTraining-555"><span class="linenos">555</span></a><span class="sd">        Lecture Notes in Computer Science, vol 4293.</span>
</span><span id="DeTriTraining-556"><a href="#DeTriTraining-556"><span class="linenos">556</span></a><span class="sd">        Springer, Berlin, Heidelberg.</span>
</span><span id="DeTriTraining-557"><a href="#DeTriTraining-557"><span class="linenos">557</span></a><span class="sd">        https://doi.org/10.1007/11925231_61</span>
</span><span id="DeTriTraining-558"><a href="#DeTriTraining-558"><span class="linenos">558</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-559"><a href="#DeTriTraining-559"><span class="linenos">559</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining-560"><a href="#DeTriTraining-560"><span class="linenos">560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">k_neighbors</span>
</span><span id="DeTriTraining-561"><a href="#DeTriTraining-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="DeTriTraining-562"><a href="#DeTriTraining-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="DeTriTraining-563"><a href="#DeTriTraining-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="DeTriTraining-564"><a href="#DeTriTraining-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;seeded&quot;</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-565"><a href="#DeTriTraining-565"><span class="linenos">565</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;`mode` must be </span><span class="se">\&quot;</span><span class="s2">seeded</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">constrained</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="DeTriTraining-566"><a href="#DeTriTraining-566"><span class="linenos">566</span></a>
</span><span id="DeTriTraining-567"><a href="#DeTriTraining-567"><span class="linenos">567</span></a>    <span class="k">def</span> <span class="nf">_depure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">):</span>
</span><span id="DeTriTraining-568"><a href="#DeTriTraining-568"><span class="linenos">568</span></a>        <span class="sd">&quot;&quot;&quot;Depure the S dataset</span>
</span><span id="DeTriTraining-569"><a href="#DeTriTraining-569"><span class="linenos">569</span></a>
</span><span id="DeTriTraining-570"><a href="#DeTriTraining-570"><span class="linenos">570</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-571"><a href="#DeTriTraining-571"><span class="linenos">571</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-572"><a href="#DeTriTraining-572"><span class="linenos">572</span></a><span class="sd">        S : tuple (X, y)</span>
</span><span id="DeTriTraining-573"><a href="#DeTriTraining-573"><span class="linenos">573</span></a><span class="sd">            Enlarged dataset</span>
</span><span id="DeTriTraining-574"><a href="#DeTriTraining-574"><span class="linenos">574</span></a>
</span><span id="DeTriTraining-575"><a href="#DeTriTraining-575"><span class="linenos">575</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-576"><a href="#DeTriTraining-576"><span class="linenos">576</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-577"><a href="#DeTriTraining-577"><span class="linenos">577</span></a><span class="sd">        tuple : (X, y)</span>
</span><span id="DeTriTraining-578"><a href="#DeTriTraining-578"><span class="linenos">578</span></a><span class="sd">            Enlarged dataset with instances where at least k_neighbors/2+1 have the same class.</span>
</span><span id="DeTriTraining-579"><a href="#DeTriTraining-579"><span class="linenos">579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-580"><a href="#DeTriTraining-580"><span class="linenos">580</span></a>        <span class="n">init</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DeTriTraining-581"><a href="#DeTriTraining-581"><span class="linenos">581</span></a>        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="DeTriTraining-582"><a href="#DeTriTraining-582"><span class="linenos">582</span></a>        <span class="n">valid</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DeTriTraining-583"><a href="#DeTriTraining-583"><span class="linenos">583</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Depure time: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">init</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DeTriTraining-584"><a href="#DeTriTraining-584"><span class="linenos">584</span></a>        <span class="k">return</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">valid</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">valid</span><span class="p">]</span>
</span><span id="DeTriTraining-585"><a href="#DeTriTraining-585"><span class="linenos">585</span></a>
</span><span id="DeTriTraining-586"><a href="#DeTriTraining-586"><span class="linenos">586</span></a>    <span class="k">def</span> <span class="nf">_clustering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-587"><a href="#DeTriTraining-587"><span class="linenos">587</span></a>        <span class="sd">&quot;&quot;&quot;Clustering phase of the fitting</span>
</span><span id="DeTriTraining-588"><a href="#DeTriTraining-588"><span class="linenos">588</span></a>
</span><span id="DeTriTraining-589"><a href="#DeTriTraining-589"><span class="linenos">589</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-590"><a href="#DeTriTraining-590"><span class="linenos">590</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-591"><a href="#DeTriTraining-591"><span class="linenos">591</span></a><span class="sd">        S : tuple (X, y)</span>
</span><span id="DeTriTraining-592"><a href="#DeTriTraining-592"><span class="linenos">592</span></a><span class="sd">            Enlarged dataset</span>
</span><span id="DeTriTraining-593"><a href="#DeTriTraining-593"><span class="linenos">593</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining-594"><a href="#DeTriTraining-594"><span class="linenos">594</span></a><span class="sd">            Complete dataset, only features</span>
</span><span id="DeTriTraining-595"><a href="#DeTriTraining-595"><span class="linenos">595</span></a>
</span><span id="DeTriTraining-596"><a href="#DeTriTraining-596"><span class="linenos">596</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-597"><a href="#DeTriTraining-597"><span class="linenos">597</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-598"><a href="#DeTriTraining-598"><span class="linenos">598</span></a><span class="sd">        y: array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining-599"><a href="#DeTriTraining-599"><span class="linenos">599</span></a><span class="sd">            class predicted for each instance</span>
</span><span id="DeTriTraining-600"><a href="#DeTriTraining-600"><span class="linenos">600</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-601"><a href="#DeTriTraining-601"><span class="linenos">601</span></a>        <span class="n">centroids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="DeTriTraining-602"><a href="#DeTriTraining-602"><span class="linenos">602</span></a>        <span class="n">clusters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DeTriTraining-603"><a href="#DeTriTraining-603"><span class="linenos">603</span></a>
</span><span id="DeTriTraining-604"><a href="#DeTriTraining-604"><span class="linenos">604</span></a>        <span class="c1"># uses as numpy</span>
</span><span id="DeTriTraining-605"><a href="#DeTriTraining-605"><span class="linenos">605</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DeTriTraining-606"><a href="#DeTriTraining-606"><span class="linenos">606</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="DeTriTraining-607"><a href="#DeTriTraining-607"><span class="linenos">607</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="DeTriTraining-608"><a href="#DeTriTraining-608"><span class="linenos">608</span></a>            <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="DeTriTraining-609"><a href="#DeTriTraining-609"><span class="linenos">609</span></a>
</span><span id="DeTriTraining-610"><a href="#DeTriTraining-610"><span class="linenos">610</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
</span><span id="DeTriTraining-611"><a href="#DeTriTraining-611"><span class="linenos">611</span></a>            <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-612"><a href="#DeTriTraining-612"><span class="linenos">612</span></a>
</span><span id="DeTriTraining-613"><a href="#DeTriTraining-613"><span class="linenos">613</span></a>        <span class="k">def</span> <span class="nf">seeded</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-614"><a href="#DeTriTraining-614"><span class="linenos">614</span></a>            <span class="c1"># For each instance, calculate the distance to each centroid</span>
</span><span id="DeTriTraining-615"><a href="#DeTriTraining-615"><span class="linenos">615</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DeTriTraining-616"><a href="#DeTriTraining-616"><span class="linenos">616</span></a>            <span class="c1"># Get the index of the nearest centroid</span>
</span><span id="DeTriTraining-617"><a href="#DeTriTraining-617"><span class="linenos">617</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DeTriTraining-618"><a href="#DeTriTraining-618"><span class="linenos">618</span></a>
</span><span id="DeTriTraining-619"><a href="#DeTriTraining-619"><span class="linenos">619</span></a>        <span class="k">def</span> <span class="nf">constrained</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
</span><span id="DeTriTraining-620"><a href="#DeTriTraining-620"><span class="linenos">620</span></a>            <span class="c1"># Calculate the distances to centroids using broadcasting</span>
</span><span id="DeTriTraining-621"><a href="#DeTriTraining-621"><span class="linenos">621</span></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DeTriTraining-622"><a href="#DeTriTraining-622"><span class="linenos">622</span></a>            <span class="c1"># Get the index of the nearest centroid</span>
</span><span id="DeTriTraining-623"><a href="#DeTriTraining-623"><span class="linenos">623</span></a>            <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DeTriTraining-624"><a href="#DeTriTraining-624"><span class="linenos">624</span></a>            <span class="c1"># Create a mask to find instances in X that belong to S[0]</span>
</span><span id="DeTriTraining-625"><a href="#DeTriTraining-625"><span class="linenos">625</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
</span><span id="DeTriTraining-626"><a href="#DeTriTraining-626"><span class="linenos">626</span></a>            <span class="c1"># Find the row and column indices where all elements are True</span>
</span><span id="DeTriTraining-627"><a href="#DeTriTraining-627"><span class="linenos">627</span></a>            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</span><span id="DeTriTraining-628"><a href="#DeTriTraining-628"><span class="linenos">628</span></a>            <span class="c1"># Initialize cluster with -1</span>
</span><span id="DeTriTraining-629"><a href="#DeTriTraining-629"><span class="linenos">629</span></a>            <span class="n">cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DeTriTraining-630"><a href="#DeTriTraining-630"><span class="linenos">630</span></a>            <span class="c1"># Update cluster for the instances found in S[0]</span>
</span><span id="DeTriTraining-631"><a href="#DeTriTraining-631"><span class="linenos">631</span></a>            <span class="n">cluster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
</span><span id="DeTriTraining-632"><a href="#DeTriTraining-632"><span class="linenos">632</span></a>            <span class="c1"># Update cluster for instances not found in S[0]</span>
</span><span id="DeTriTraining-633"><a href="#DeTriTraining-633"><span class="linenos">633</span></a>            <span class="n">cluster</span><span class="p">[</span><span class="n">cluster</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nearest</span><span class="p">[</span><span class="n">cluster</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="DeTriTraining-634"><a href="#DeTriTraining-634"><span class="linenos">634</span></a>
</span><span id="DeTriTraining-635"><a href="#DeTriTraining-635"><span class="linenos">635</span></a>            <span class="k">return</span> <span class="n">cluster</span>
</span><span id="DeTriTraining-636"><a href="#DeTriTraining-636"><span class="linenos">636</span></a>
</span><span id="DeTriTraining-637"><a href="#DeTriTraining-637"><span class="linenos">637</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;seeded&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-638"><a href="#DeTriTraining-638"><span class="linenos">638</span></a>            <span class="n">op</span> <span class="o">=</span> <span class="n">seeded</span>
</span><span id="DeTriTraining-639"><a href="#DeTriTraining-639"><span class="linenos">639</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining-640"><a href="#DeTriTraining-640"><span class="linenos">640</span></a>            <span class="n">op</span> <span class="o">=</span> <span class="n">constrained</span>
</span><span id="DeTriTraining-641"><a href="#DeTriTraining-641"><span class="linenos">641</span></a>
</span><span id="DeTriTraining-642"><a href="#DeTriTraining-642"><span class="linenos">642</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-643"><a href="#DeTriTraining-643"><span class="linenos">643</span></a>        <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DeTriTraining-644"><a href="#DeTriTraining-644"><span class="linenos">644</span></a>        <span class="k">while</span> <span class="n">changes</span> <span class="ow">and</span> <span class="n">iterations</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining-645"><a href="#DeTriTraining-645"><span class="linenos">645</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining-646"><a href="#DeTriTraining-646"><span class="linenos">646</span></a>            <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining-647"><a href="#DeTriTraining-647"><span class="linenos">647</span></a>            <span class="c1"># Need to vectorize</span>
</span><span id="DeTriTraining-648"><a href="#DeTriTraining-648"><span class="linenos">648</span></a>            <span class="n">new_clusters</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining-649"><a href="#DeTriTraining-649"><span class="linenos">649</span></a>            <span class="n">new_centroids</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="DeTriTraining-650"><a href="#DeTriTraining-650"><span class="linenos">650</span></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
</span><span id="DeTriTraining-651"><a href="#DeTriTraining-651"><span class="linenos">651</span></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">new_clusters</span> <span class="o">==</span> <span class="n">k</span><span class="p">):</span>
</span><span id="DeTriTraining-652"><a href="#DeTriTraining-652"><span class="linenos">652</span></a>                    <span class="n">new_centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">new_clusters</span> <span class="o">==</span> <span class="n">k</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-653"><a href="#DeTriTraining-653"><span class="linenos">653</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">new_centroids</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">centroids</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
</span><span id="DeTriTraining-654"><a href="#DeTriTraining-654"><span class="linenos">654</span></a>                        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-655"><a href="#DeTriTraining-655"><span class="linenos">655</span></a>            <span class="n">centroids</span> <span class="o">=</span> <span class="n">new_centroids</span>
</span><span id="DeTriTraining-656"><a href="#DeTriTraining-656"><span class="linenos">656</span></a>
</span><span id="DeTriTraining-657"><a href="#DeTriTraining-657"><span class="linenos">657</span></a>        <span class="k">return</span> <span class="n">new_clusters</span>
</span><span id="DeTriTraining-658"><a href="#DeTriTraining-658"><span class="linenos">658</span></a>
</span><span id="DeTriTraining-659"><a href="#DeTriTraining-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="DeTriTraining-660"><a href="#DeTriTraining-660"><span class="linenos">660</span></a>        <span class="sd">&quot;&quot;&quot;Build a DeTriTraining classifier from the training set (X, y).</span>
</span><span id="DeTriTraining-661"><a href="#DeTriTraining-661"><span class="linenos">661</span></a>
</span><span id="DeTriTraining-662"><a href="#DeTriTraining-662"><span class="linenos">662</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining-663"><a href="#DeTriTraining-663"><span class="linenos">663</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining-664"><a href="#DeTriTraining-664"><span class="linenos">664</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining-665"><a href="#DeTriTraining-665"><span class="linenos">665</span></a><span class="sd">            The training input samples.</span>
</span><span id="DeTriTraining-666"><a href="#DeTriTraining-666"><span class="linenos">666</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining-667"><a href="#DeTriTraining-667"><span class="linenos">667</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DeTriTraining-668"><a href="#DeTriTraining-668"><span class="linenos">668</span></a>
</span><span id="DeTriTraining-669"><a href="#DeTriTraining-669"><span class="linenos">669</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining-670"><a href="#DeTriTraining-670"><span class="linenos">670</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining-671"><a href="#DeTriTraining-671"><span class="linenos">671</span></a><span class="sd">        self: DeTriTraining</span>
</span><span id="DeTriTraining-672"><a href="#DeTriTraining-672"><span class="linenos">672</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="DeTriTraining-673"><a href="#DeTriTraining-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining-674"><a href="#DeTriTraining-674"><span class="linenos">674</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeTriTraining-675"><a href="#DeTriTraining-675"><span class="linenos">675</span></a>
</span><span id="DeTriTraining-676"><a href="#DeTriTraining-676"><span class="linenos">676</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="DeTriTraining-677"><a href="#DeTriTraining-677"><span class="linenos">677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-678"><a href="#DeTriTraining-678"><span class="linenos">678</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-679"><a href="#DeTriTraining-679"><span class="linenos">679</span></a>
</span><span id="DeTriTraining-680"><a href="#DeTriTraining-680"><span class="linenos">680</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DeTriTraining-681"><a href="#DeTriTraining-681"><span class="linenos">681</span></a>
</span><span id="DeTriTraining-682"><a href="#DeTriTraining-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-683"><a href="#DeTriTraining-683"><span class="linenos">683</span></a>
</span><span id="DeTriTraining-684"><a href="#DeTriTraining-684"><span class="linenos">684</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="DeTriTraining-685"><a href="#DeTriTraining-685"><span class="linenos">685</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining-686"><a href="#DeTriTraining-686"><span class="linenos">686</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining-687"><a href="#DeTriTraining-687"><span class="linenos">687</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-688"><a href="#DeTriTraining-688"><span class="linenos">688</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-689"><a href="#DeTriTraining-689"><span class="linenos">689</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining-690"><a href="#DeTriTraining-690"><span class="linenos">690</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="DeTriTraining-691"><a href="#DeTriTraining-691"><span class="linenos">691</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="DeTriTraining-692"><a href="#DeTriTraining-692"><span class="linenos">692</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining-693"><a href="#DeTriTraining-693"><span class="linenos">693</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="DeTriTraining-694"><a href="#DeTriTraining-694"><span class="linenos">694</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining-695"><a href="#DeTriTraining-695"><span class="linenos">695</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining-696"><a href="#DeTriTraining-696"><span class="linenos">696</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining-697"><a href="#DeTriTraining-697"><span class="linenos">697</span></a>
</span><span id="DeTriTraining-698"><a href="#DeTriTraining-698"><span class="linenos">698</span></a>        <span class="n">S_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining-699"><a href="#DeTriTraining-699"><span class="linenos">699</span></a>        <span class="n">hypothesis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining-700"><a href="#DeTriTraining-700"><span class="linenos">700</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-701"><a href="#DeTriTraining-701"><span class="linenos">701</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> \
</span><span id="DeTriTraining-702"><a href="#DeTriTraining-702"><span class="linenos">702</span></a>                <span class="n">resample</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeTriTraining-703"><a href="#DeTriTraining-703"><span class="linenos">703</span></a>                         <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="DeTriTraining-704"><a href="#DeTriTraining-704"><span class="linenos">704</span></a>                         <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining-705"><a href="#DeTriTraining-705"><span class="linenos">705</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-706"><a href="#DeTriTraining-706"><span class="linenos">706</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="DeTriTraining-707"><a href="#DeTriTraining-707"><span class="linenos">707</span></a>            <span class="n">hypothesis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DeTriTraining-708"><a href="#DeTriTraining-708"><span class="linenos">708</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="DeTriTraining-709"><a href="#DeTriTraining-709"><span class="linenos">709</span></a>                    <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining-710"><a href="#DeTriTraining-710"><span class="linenos">710</span></a>            <span class="p">)</span>
</span><span id="DeTriTraining-711"><a href="#DeTriTraining-711"><span class="linenos">711</span></a>
</span><span id="DeTriTraining-712"><a href="#DeTriTraining-712"><span class="linenos">712</span></a>            <span class="c1"># Keep class order</span>
</span><span id="DeTriTraining-713"><a href="#DeTriTraining-713"><span class="linenos">713</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining-714"><a href="#DeTriTraining-714"><span class="linenos">714</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-715"><a href="#DeTriTraining-715"><span class="linenos">715</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining-716"><a href="#DeTriTraining-716"><span class="linenos">716</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-717"><a href="#DeTriTraining-717"><span class="linenos">717</span></a>
</span><span id="DeTriTraining-718"><a href="#DeTriTraining-718"><span class="linenos">718</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining-719"><a href="#DeTriTraining-719"><span class="linenos">719</span></a>
</span><span id="DeTriTraining-720"><a href="#DeTriTraining-720"><span class="linenos">720</span></a>            <span class="n">S_</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">))</span>
</span><span id="DeTriTraining-721"><a href="#DeTriTraining-721"><span class="linenos">721</span></a>
</span><span id="DeTriTraining-722"><a href="#DeTriTraining-722"><span class="linenos">722</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-723"><a href="#DeTriTraining-723"><span class="linenos">723</span></a>        <span class="n">last_addition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining-724"><a href="#DeTriTraining-724"><span class="linenos">724</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span>
</span><span id="DeTriTraining-725"><a href="#DeTriTraining-725"><span class="linenos">725</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining-726"><a href="#DeTriTraining-726"><span class="linenos">726</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining-727"><a href="#DeTriTraining-727"><span class="linenos">727</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining-728"><a href="#DeTriTraining-728"><span class="linenos">728</span></a>
</span><span id="DeTriTraining-729"><a href="#DeTriTraining-729"><span class="linenos">729</span></a>            <span class="c1"># Enlarged</span>
</span><span id="DeTriTraining-730"><a href="#DeTriTraining-730"><span class="linenos">730</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining-731"><a href="#DeTriTraining-731"><span class="linenos">731</span></a>
</span><span id="DeTriTraining-732"><a href="#DeTriTraining-732"><span class="linenos">732</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-733"><a href="#DeTriTraining-733"><span class="linenos">733</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="DeTriTraining-734"><a href="#DeTriTraining-734"><span class="linenos">734</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining-735"><a href="#DeTriTraining-735"><span class="linenos">735</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining-736"><a href="#DeTriTraining-736"><span class="linenos">736</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">validx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">])</span>
</span><span id="DeTriTraining-737"><a href="#DeTriTraining-737"><span class="linenos">737</span></a>
</span><span id="DeTriTraining-738"><a href="#DeTriTraining-738"><span class="linenos">738</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
</span><span id="DeTriTraining-739"><a href="#DeTriTraining-739"><span class="linenos">739</span></a>
</span><span id="DeTriTraining-740"><a href="#DeTriTraining-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining-741"><a href="#DeTriTraining-741"><span class="linenos">741</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="DeTriTraining-742"><a href="#DeTriTraining-742"><span class="linenos">742</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DeTriTraining-743"><a href="#DeTriTraining-743"><span class="linenos">743</span></a>
</span><span id="DeTriTraining-744"><a href="#DeTriTraining-744"><span class="linenos">744</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining-745"><a href="#DeTriTraining-745"><span class="linenos">745</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_label</span><span class="p">):</span>
</span><span id="DeTriTraining-746"><a href="#DeTriTraining-746"><span class="linenos">746</span></a>                    <span class="n">last_addition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="DeTriTraining-747"><a href="#DeTriTraining-747"><span class="linenos">747</span></a>                    <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining-748"><a href="#DeTriTraining-748"><span class="linenos">748</span></a>                    <span class="n">hypothesis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining-749"><a href="#DeTriTraining-749"><span class="linenos">749</span></a>
</span><span id="DeTriTraining-750"><a href="#DeTriTraining-750"><span class="linenos">750</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">changes</span><span class="p">:</span>
</span><span id="DeTriTraining-751"><a href="#DeTriTraining-751"><span class="linenos">751</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining-752"><a href="#DeTriTraining-752"><span class="linenos">752</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining-753"><a href="#DeTriTraining-753"><span class="linenos">753</span></a>            <span class="n">warn</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Maximum number of iterations reached before convergence. Consider increasing max_iter to improve the fit.&quot;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
</span><span id="DeTriTraining-754"><a href="#DeTriTraining-754"><span class="linenos">754</span></a>
</span><span id="DeTriTraining-755"><a href="#DeTriTraining-755"><span class="linenos">755</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span>
</span><span id="DeTriTraining-756"><a href="#DeTriTraining-756"><span class="linenos">756</span></a>        <span class="n">S_0</span><span class="p">,</span> <span class="n">index_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DeTriTraining-757"><a href="#DeTriTraining-757"><span class="linenos">757</span></a>        <span class="n">S_1</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index_</span><span class="p">]</span>
</span><span id="DeTriTraining-758"><a href="#DeTriTraining-758"><span class="linenos">758</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S_0</span><span class="p">,</span> <span class="n">S_1</span>
</span><span id="DeTriTraining-759"><a href="#DeTriTraining-759"><span class="linenos">759</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># Change, is S - L (only new)</span>
</span><span id="DeTriTraining-760"><a href="#DeTriTraining-760"><span class="linenos">760</span></a>
</span><span id="DeTriTraining-761"><a href="#DeTriTraining-761"><span class="linenos">761</span></a>        <span class="n">new_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining-762"><a href="#DeTriTraining-762"><span class="linenos">762</span></a>
</span><span id="DeTriTraining-763"><a href="#DeTriTraining-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)]</span>
</span><span id="DeTriTraining-764"><a href="#DeTriTraining-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
</span><span id="DeTriTraining-765"><a href="#DeTriTraining-765"><span class="linenos">765</span></a>
</span><span id="DeTriTraining-766"><a href="#DeTriTraining-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#DeTriTraining.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="DeTriTraining.__init__" class="classattr">
                                        <input id="DeTriTraining.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DeTriTraining</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">mode</span><span class="o">=</span><span class="s1">&#39;seeded&#39;</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DeTriTraining.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining.__init__-520"><a href="#DeTriTraining.__init__-520"><span class="linenos">520</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeTriTraining.__init__-521"><a href="#DeTriTraining.__init__-521"><span class="linenos">521</span></a>                 <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;seeded&quot;</span><span class="p">,</span> <span class="n">max_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeTriTraining.__init__-522"><a href="#DeTriTraining.__init__-522"><span class="linenos">522</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeTriTraining.__init__-523"><a href="#DeTriTraining.__init__-523"><span class="linenos">523</span></a><span class="sd">        DeTriTraining - TriTraining with Depurated and Clustering.</span>
</span><span id="DeTriTraining.__init__-524"><a href="#DeTriTraining.__init__-524"><span class="linenos">524</span></a><span class="sd">        Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </span>
</span><span id="DeTriTraining.__init__-525"><a href="#DeTriTraining.__init__-525"><span class="linenos">525</span></a>
</span><span id="DeTriTraining.__init__-526"><a href="#DeTriTraining.__init__-526"><span class="linenos">526</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining.__init__-527"><a href="#DeTriTraining.__init__-527"><span class="linenos">527</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining.__init__-528"><a href="#DeTriTraining.__init__-528"><span class="linenos">528</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="DeTriTraining.__init__-529"><a href="#DeTriTraining.__init__-529"><span class="linenos">529</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="DeTriTraining.__init__-530"><a href="#DeTriTraining.__init__-530"><span class="linenos">530</span></a><span class="sd">        n_samples : int, optional</span>
</span><span id="DeTriTraining.__init__-531"><a href="#DeTriTraining.__init__-531"><span class="linenos">531</span></a><span class="sd">            Number of samples to generate. </span>
</span><span id="DeTriTraining.__init__-532"><a href="#DeTriTraining.__init__-532"><span class="linenos">532</span></a><span class="sd">            If left to None this is automatically set to the first dimension of the arrays., by default None</span>
</span><span id="DeTriTraining.__init__-533"><a href="#DeTriTraining.__init__-533"><span class="linenos">533</span></a><span class="sd">        k_neighbors : int, optional</span>
</span><span id="DeTriTraining.__init__-534"><a href="#DeTriTraining.__init__-534"><span class="linenos">534</span></a><span class="sd">            Number of neighbors for depurate classification. </span>
</span><span id="DeTriTraining.__init__-535"><a href="#DeTriTraining.__init__-535"><span class="linenos">535</span></a><span class="sd">            If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</span>
</span><span id="DeTriTraining.__init__-536"><a href="#DeTriTraining.__init__-536"><span class="linenos">536</span></a><span class="sd">        mode : string, optional</span>
</span><span id="DeTriTraining.__init__-537"><a href="#DeTriTraining.__init__-537"><span class="linenos">537</span></a><span class="sd">            How to calculate the cluster each instance belongs to.</span>
</span><span id="DeTriTraining.__init__-538"><a href="#DeTriTraining.__init__-538"><span class="linenos">538</span></a><span class="sd">            If `seeded` each instance belong to nearest cluster.</span>
</span><span id="DeTriTraining.__init__-539"><a href="#DeTriTraining.__init__-539"><span class="linenos">539</span></a><span class="sd">            If `constrained` each instance belong to nearest cluster unless the instance is in to enlarged dataset, </span>
</span><span id="DeTriTraining.__init__-540"><a href="#DeTriTraining.__init__-540"><span class="linenos">540</span></a><span class="sd">            then the instance belongs to the cluster of its class., by default `seeded`</span>
</span><span id="DeTriTraining.__init__-541"><a href="#DeTriTraining.__init__-541"><span class="linenos">541</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="DeTriTraining.__init__-542"><a href="#DeTriTraining.__init__-542"><span class="linenos">542</span></a><span class="sd">            Maximum number of iterations, by default 100</span>
</span><span id="DeTriTraining.__init__-543"><a href="#DeTriTraining.__init__-543"><span class="linenos">543</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="DeTriTraining.__init__-544"><a href="#DeTriTraining.__init__-544"><span class="linenos">544</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. </span>
</span><span id="DeTriTraining.__init__-545"><a href="#DeTriTraining.__init__-545"><span class="linenos">545</span></a><span class="sd">            None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. </span>
</span><span id="DeTriTraining.__init__-546"><a href="#DeTriTraining.__init__-546"><span class="linenos">546</span></a><span class="sd">            Doesn&#39;t affect fit method., by default None</span>
</span><span id="DeTriTraining.__init__-547"><a href="#DeTriTraining.__init__-547"><span class="linenos">547</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DeTriTraining.__init__-548"><a href="#DeTriTraining.__init__-548"><span class="linenos">548</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DeTriTraining.__init__-549"><a href="#DeTriTraining.__init__-549"><span class="linenos">549</span></a>
</span><span id="DeTriTraining.__init__-550"><a href="#DeTriTraining.__init__-550"><span class="linenos">550</span></a><span class="sd">        References</span>
</span><span id="DeTriTraining.__init__-551"><a href="#DeTriTraining.__init__-551"><span class="linenos">551</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining.__init__-552"><a href="#DeTriTraining.__init__-552"><span class="linenos">552</span></a><span class="sd">        Deng C., Guo M.Z. (2006)</span>
</span><span id="DeTriTraining.__init__-553"><a href="#DeTriTraining.__init__-553"><span class="linenos">553</span></a><span class="sd">        Tri-training and Data Editing Based Semi-supervised Clustering Algorithm. </span>
</span><span id="DeTriTraining.__init__-554"><a href="#DeTriTraining.__init__-554"><span class="linenos">554</span></a><span class="sd">        In: Gelbukh A., Reyes-Garcia C.A. (eds) MICAI 2006: Advances in Artificial Intelligence. MICAI 2006. </span>
</span><span id="DeTriTraining.__init__-555"><a href="#DeTriTraining.__init__-555"><span class="linenos">555</span></a><span class="sd">        Lecture Notes in Computer Science, vol 4293.</span>
</span><span id="DeTriTraining.__init__-556"><a href="#DeTriTraining.__init__-556"><span class="linenos">556</span></a><span class="sd">        Springer, Berlin, Heidelberg.</span>
</span><span id="DeTriTraining.__init__-557"><a href="#DeTriTraining.__init__-557"><span class="linenos">557</span></a><span class="sd">        https://doi.org/10.1007/11925231_61</span>
</span><span id="DeTriTraining.__init__-558"><a href="#DeTriTraining.__init__-558"><span class="linenos">558</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining.__init__-559"><a href="#DeTriTraining.__init__-559"><span class="linenos">559</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining.__init__-560"><a href="#DeTriTraining.__init__-560"><span class="linenos">560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">k_neighbors</span> <span class="o">=</span> <span class="n">k_neighbors</span>
</span><span id="DeTriTraining.__init__-561"><a href="#DeTriTraining.__init__-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
</span><span id="DeTriTraining.__init__-562"><a href="#DeTriTraining.__init__-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="DeTriTraining.__init__-563"><a href="#DeTriTraining.__init__-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="DeTriTraining.__init__-564"><a href="#DeTriTraining.__init__-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;seeded&quot;</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;constrained&quot;</span><span class="p">:</span>
</span><span id="DeTriTraining.__init__-565"><a href="#DeTriTraining.__init__-565"><span class="linenos">565</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;`mode` must be </span><span class="se">\&quot;</span><span class="s2">seeded</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">constrained</span><span class="se">\&quot;</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>DeTriTraining - TriTraining with Depurated and Clustering.
Avoid the noise generated by the TriTraining algorithm by depurating the enlarged dataset and clustering the instances.        </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_samples</strong> (int, optional):
Number of samples to generate. 
If left to None this is automatically set to the first dimension of the arrays., by default None</li>
<li><strong>k_neighbors</strong> (int, optional):
Number of neighbors for depurate classification. 
If at least k_neighbors/2+1 have a class other than the one predicted, the class is ignored., by default 3</li>
<li><strong>mode</strong> (string, optional):
How to calculate the cluster each instance belongs to.
If <code>seeded</code> each instance belong to nearest cluster.
If <code>constrained</code> each instance belong to nearest cluster unless the instance is in to enlarged dataset, 
then the instance belongs to the cluster of its class., by default <code>seeded</code></li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations, by default 100</li>
<li><strong>n_jobs</strong> (int, optional):
The number of parallel jobs to run for neighbors search. 
None means 1 unless in a joblib.parallel_backend context. -1 means using all processors. 
Doesn't affect fit method., by default None</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Deng C., Guo M.Z. (2006)
Tri-training and Data Editing Based Semi-supervised Clustering Algorithm. 
In: Gelbukh A., Reyes-Garcia C.A. (eds) MICAI 2006: Advances in Artificial Intelligence. MICAI 2006. 
Lecture Notes in Computer Science, vol 4293.
Springer, Berlin, Heidelberg.
<a href="https://doi.org/10.1007/11925231_61">https://doi.org/10.1007/11925231_61</a></p>
</div>


                            </div>
                            <div id="DeTriTraining.fit" class="classattr">
                                        <input id="DeTriTraining.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeTriTraining.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeTriTraining.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeTriTraining.fit-659"><a href="#DeTriTraining.fit-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-660"><a href="#DeTriTraining.fit-660"><span class="linenos">660</span></a>        <span class="sd">&quot;&quot;&quot;Build a DeTriTraining classifier from the training set (X, y).</span>
</span><span id="DeTriTraining.fit-661"><a href="#DeTriTraining.fit-661"><span class="linenos">661</span></a>
</span><span id="DeTriTraining.fit-662"><a href="#DeTriTraining.fit-662"><span class="linenos">662</span></a><span class="sd">        Parameters</span>
</span><span id="DeTriTraining.fit-663"><a href="#DeTriTraining.fit-663"><span class="linenos">663</span></a><span class="sd">        ----------</span>
</span><span id="DeTriTraining.fit-664"><a href="#DeTriTraining.fit-664"><span class="linenos">664</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DeTriTraining.fit-665"><a href="#DeTriTraining.fit-665"><span class="linenos">665</span></a><span class="sd">            The training input samples.</span>
</span><span id="DeTriTraining.fit-666"><a href="#DeTriTraining.fit-666"><span class="linenos">666</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DeTriTraining.fit-667"><a href="#DeTriTraining.fit-667"><span class="linenos">667</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DeTriTraining.fit-668"><a href="#DeTriTraining.fit-668"><span class="linenos">668</span></a>
</span><span id="DeTriTraining.fit-669"><a href="#DeTriTraining.fit-669"><span class="linenos">669</span></a><span class="sd">        Returns</span>
</span><span id="DeTriTraining.fit-670"><a href="#DeTriTraining.fit-670"><span class="linenos">670</span></a><span class="sd">        -------</span>
</span><span id="DeTriTraining.fit-671"><a href="#DeTriTraining.fit-671"><span class="linenos">671</span></a><span class="sd">        self: DeTriTraining</span>
</span><span id="DeTriTraining.fit-672"><a href="#DeTriTraining.fit-672"><span class="linenos">672</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="DeTriTraining.fit-673"><a href="#DeTriTraining.fit-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeTriTraining.fit-674"><a href="#DeTriTraining.fit-674"><span class="linenos">674</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-675"><a href="#DeTriTraining.fit-675"><span class="linenos">675</span></a>
</span><span id="DeTriTraining.fit-676"><a href="#DeTriTraining.fit-676"><span class="linenos">676</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-677"><a href="#DeTriTraining.fit-677"><span class="linenos">677</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-678"><a href="#DeTriTraining.fit-678"><span class="linenos">678</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_encoder_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-679"><a href="#DeTriTraining.fit-679"><span class="linenos">679</span></a>
</span><span id="DeTriTraining.fit-680"><a href="#DeTriTraining.fit-680"><span class="linenos">680</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-681"><a href="#DeTriTraining.fit-681"><span class="linenos">681</span></a>
</span><span id="DeTriTraining.fit-682"><a href="#DeTriTraining.fit-682"><span class="linenos">682</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-683"><a href="#DeTriTraining.fit-683"><span class="linenos">683</span></a>
</span><span id="DeTriTraining.fit-684"><a href="#DeTriTraining.fit-684"><span class="linenos">684</span></a>        <span class="n">classes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-685"><a href="#DeTriTraining.fit-685"><span class="linenos">685</span></a>        <span class="n">instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-686"><a href="#DeTriTraining.fit-686"><span class="linenos">686</span></a>        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DeTriTraining.fit-687"><a href="#DeTriTraining.fit-687"><span class="linenos">687</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-688"><a href="#DeTriTraining.fit-688"><span class="linenos">688</span></a>        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-689"><a href="#DeTriTraining.fit-689"><span class="linenos">689</span></a>            <span class="n">iteration</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X_label</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-690"><a href="#DeTriTraining.fit-690"><span class="linenos">690</span></a>        <span class="k">for</span> <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">iteration</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-691"><a href="#DeTriTraining.fit-691"><span class="linenos">691</span></a>            <span class="k">if</span> <span class="n">y_</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-692"><a href="#DeTriTraining.fit-692"><span class="linenos">692</span></a>                <span class="n">classes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-693"><a href="#DeTriTraining.fit-693"><span class="linenos">693</span></a>                <span class="n">instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-694"><a href="#DeTriTraining.fit-694"><span class="linenos">694</span></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-695"><a href="#DeTriTraining.fit-695"><span class="linenos">695</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-696"><a href="#DeTriTraining.fit-696"><span class="linenos">696</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining.fit-697"><a href="#DeTriTraining.fit-697"><span class="linenos">697</span></a>
</span><span id="DeTriTraining.fit-698"><a href="#DeTriTraining.fit-698"><span class="linenos">698</span></a>        <span class="n">S_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining.fit-699"><a href="#DeTriTraining.fit-699"><span class="linenos">699</span></a>        <span class="n">hypothesis</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DeTriTraining.fit-700"><a href="#DeTriTraining.fit-700"><span class="linenos">700</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-701"><a href="#DeTriTraining.fit-701"><span class="linenos">701</span></a>            <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span> <span class="o">=</span> \
</span><span id="DeTriTraining.fit-702"><a href="#DeTriTraining.fit-702"><span class="linenos">702</span></a>                <span class="n">resample</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeTriTraining.fit-703"><a href="#DeTriTraining.fit-703"><span class="linenos">703</span></a>                         <span class="n">n_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">,</span>
</span><span id="DeTriTraining.fit-704"><a href="#DeTriTraining.fit-704"><span class="linenos">704</span></a>                         <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-705"><a href="#DeTriTraining.fit-705"><span class="linenos">705</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-706"><a href="#DeTriTraining.fit-706"><span class="linenos">706</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-707"><a href="#DeTriTraining.fit-707"><span class="linenos">707</span></a>            <span class="n">hypothesis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="DeTriTraining.fit-708"><a href="#DeTriTraining.fit-708"><span class="linenos">708</span></a>                <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="DeTriTraining.fit-709"><a href="#DeTriTraining.fit-709"><span class="linenos">709</span></a>                    <span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-710"><a href="#DeTriTraining.fit-710"><span class="linenos">710</span></a>            <span class="p">)</span>
</span><span id="DeTriTraining.fit-711"><a href="#DeTriTraining.fit-711"><span class="linenos">711</span></a>
</span><span id="DeTriTraining.fit-712"><a href="#DeTriTraining.fit-712"><span class="linenos">712</span></a>            <span class="c1"># Keep class order</span>
</span><span id="DeTriTraining.fit-713"><a href="#DeTriTraining.fit-713"><span class="linenos">713</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-714"><a href="#DeTriTraining.fit-714"><span class="linenos">714</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-715"><a href="#DeTriTraining.fit-715"><span class="linenos">715</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-716"><a href="#DeTriTraining.fit-716"><span class="linenos">716</span></a>                <span class="n">X_sampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">X_sampled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-717"><a href="#DeTriTraining.fit-717"><span class="linenos">717</span></a>
</span><span id="DeTriTraining.fit-718"><a href="#DeTriTraining.fit-718"><span class="linenos">718</span></a>            <span class="n">y_sampled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">y_sampled</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-719"><a href="#DeTriTraining.fit-719"><span class="linenos">719</span></a>
</span><span id="DeTriTraining.fit-720"><a href="#DeTriTraining.fit-720"><span class="linenos">720</span></a>            <span class="n">S_</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X_sampled</span><span class="p">,</span> <span class="n">y_sampled</span><span class="p">))</span>
</span><span id="DeTriTraining.fit-721"><a href="#DeTriTraining.fit-721"><span class="linenos">721</span></a>
</span><span id="DeTriTraining.fit-722"><a href="#DeTriTraining.fit-722"><span class="linenos">722</span></a>        <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining.fit-723"><a href="#DeTriTraining.fit-723"><span class="linenos">723</span></a>        <span class="n">last_addition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining.fit-724"><a href="#DeTriTraining.fit-724"><span class="linenos">724</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span>
</span><span id="DeTriTraining.fit-725"><a href="#DeTriTraining.fit-725"><span class="linenos">725</span></a>        <span class="k">while</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-726"><a href="#DeTriTraining.fit-726"><span class="linenos">726</span></a>            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DeTriTraining.fit-727"><a href="#DeTriTraining.fit-727"><span class="linenos">727</span></a>            <span class="n">changes</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DeTriTraining.fit-728"><a href="#DeTriTraining.fit-728"><span class="linenos">728</span></a>
</span><span id="DeTriTraining.fit-729"><a href="#DeTriTraining.fit-729"><span class="linenos">729</span></a>            <span class="c1"># Enlarged</span>
</span><span id="DeTriTraining.fit-730"><a href="#DeTriTraining.fit-730"><span class="linenos">730</span></a>            <span class="n">L</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span>
</span><span id="DeTriTraining.fit-731"><a href="#DeTriTraining.fit-731"><span class="linenos">731</span></a>
</span><span id="DeTriTraining.fit-732"><a href="#DeTriTraining.fit-732"><span class="linenos">732</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-733"><a href="#DeTriTraining.fit-733"><span class="linenos">733</span></a>                <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">TriTraining</span><span class="o">.</span><span class="n">_another_hs</span><span class="p">(</span><span class="n">hypothesis</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-734"><a href="#DeTriTraining.fit-734"><span class="linenos">734</span></a>                <span class="n">y_p</span> <span class="o">=</span> <span class="n">hj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-735"><a href="#DeTriTraining.fit-735"><span class="linenos">735</span></a>                <span class="n">validx</span> <span class="o">=</span> <span class="n">y_p</span> <span class="o">==</span> <span class="n">hk</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-736"><a href="#DeTriTraining.fit-736"><span class="linenos">736</span></a>                <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_unlabel</span><span class="p">[</span><span class="n">validx</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">validx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_p</span><span class="p">[</span><span class="n">validx</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-737"><a href="#DeTriTraining.fit-737"><span class="linenos">737</span></a>
</span><span id="DeTriTraining.fit-738"><a href="#DeTriTraining.fit-738"><span class="linenos">738</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-739"><a href="#DeTriTraining.fit-739"><span class="linenos">739</span></a>
</span><span id="DeTriTraining.fit-740"><a href="#DeTriTraining.fit-740"><span class="linenos">740</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-741"><a href="#DeTriTraining.fit-741"><span class="linenos">741</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="DeTriTraining.fit-742"><a href="#DeTriTraining.fit-742"><span class="linenos">742</span></a>                    <span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-743"><a href="#DeTriTraining.fit-743"><span class="linenos">743</span></a>
</span><span id="DeTriTraining.fit-744"><a href="#DeTriTraining.fit-744"><span class="linenos">744</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-745"><a href="#DeTriTraining.fit-745"><span class="linenos">745</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_label</span><span class="p">):</span>
</span><span id="DeTriTraining.fit-746"><a href="#DeTriTraining.fit-746"><span class="linenos">746</span></a>                    <span class="n">last_addition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-747"><a href="#DeTriTraining.fit-747"><span class="linenos">747</span></a>                    <span class="n">changes</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DeTriTraining.fit-748"><a href="#DeTriTraining.fit-748"><span class="linenos">748</span></a>                    <span class="n">hypothesis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">S_</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-749"><a href="#DeTriTraining.fit-749"><span class="linenos">749</span></a>
</span><span id="DeTriTraining.fit-750"><a href="#DeTriTraining.fit-750"><span class="linenos">750</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">changes</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-751"><a href="#DeTriTraining.fit-751"><span class="linenos">751</span></a>                <span class="k">break</span>
</span><span id="DeTriTraining.fit-752"><a href="#DeTriTraining.fit-752"><span class="linenos">752</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeTriTraining.fit-753"><a href="#DeTriTraining.fit-753"><span class="linenos">753</span></a>            <span class="n">warn</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Maximum number of iterations reached before convergence. Consider increasing max_iter to improve the fit.&quot;</span><span class="p">,</span> <span class="n">ConvergenceWarning</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-754"><a href="#DeTriTraining.fit-754"><span class="linenos">754</span></a>
</span><span id="DeTriTraining.fit-755"><a href="#DeTriTraining.fit-755"><span class="linenos">755</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_df</span> <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">S_</span><span class="p">])</span>
</span><span id="DeTriTraining.fit-756"><a href="#DeTriTraining.fit-756"><span class="linenos">756</span></a>        <span class="n">S_0</span><span class="p">,</span> <span class="n">index_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-757"><a href="#DeTriTraining.fit-757"><span class="linenos">757</span></a>        <span class="n">S_1</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index_</span><span class="p">]</span>
</span><span id="DeTriTraining.fit-758"><a href="#DeTriTraining.fit-758"><span class="linenos">758</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S_0</span><span class="p">,</span> <span class="n">S_1</span>
</span><span id="DeTriTraining.fit-759"><a href="#DeTriTraining.fit-759"><span class="linenos">759</span></a>        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_depure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># Change, is S - L (only new)</span>
</span><span id="DeTriTraining.fit-760"><a href="#DeTriTraining.fit-760"><span class="linenos">760</span></a>
</span><span id="DeTriTraining.fit-761"><a href="#DeTriTraining.fit-761"><span class="linenos">761</span></a>        <span class="n">new_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clustering</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="DeTriTraining.fit-762"><a href="#DeTriTraining.fit-762"><span class="linenos">762</span></a>
</span><span id="DeTriTraining.fit-763"><a href="#DeTriTraining.fit-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_N_LEARNER</span><span class="p">)]</span>
</span><span id="DeTriTraining.fit-764"><a href="#DeTriTraining.fit-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
</span><span id="DeTriTraining.fit-765"><a href="#DeTriTraining.fit-765"><span class="linenos">765</span></a>
</span><span id="DeTriTraining.fit-766"><a href="#DeTriTraining.fit-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a DeTriTraining classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (DeTriTraining):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="DeTriTraining.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#DeTriTraining.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="DeTriTraining.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="DeTriTraining.get_params" class="function">get_params</dd>
                <dd id="DeTriTraining.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="DeTriTraining.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="DeTriTraining.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="DeTriTraining.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DemocraticCoLearning">
                            <input id="DemocraticCoLearning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DemocraticCoLearning</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="DemocraticCoLearning-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning-75"><a href="#DemocraticCoLearning-75"><span class="linenos"> 75</span></a><span class="k">class</span> <span class="nc">DemocraticCoLearning</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-76"><a href="#DemocraticCoLearning-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-77"><a href="#DemocraticCoLearning-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-78"><a href="#DemocraticCoLearning-78"><span class="linenos"> 78</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span>
</span><span id="DemocraticCoLearning-79"><a href="#DemocraticCoLearning-79"><span class="linenos"> 79</span></a>            <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning-80"><a href="#DemocraticCoLearning-80"><span class="linenos"> 80</span></a>            <span class="n">GaussianNB</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning-81"><a href="#DemocraticCoLearning-81"><span class="linenos"> 81</span></a>            <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="DemocraticCoLearning-82"><a href="#DemocraticCoLearning-82"><span class="linenos"> 82</span></a>        <span class="p">],</span>
</span><span id="DemocraticCoLearning-83"><a href="#DemocraticCoLearning-83"><span class="linenos"> 83</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-84"><a href="#DemocraticCoLearning-84"><span class="linenos"> 84</span></a>        <span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-85"><a href="#DemocraticCoLearning-85"><span class="linenos"> 85</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-86"><a href="#DemocraticCoLearning-86"><span class="linenos"> 86</span></a>        <span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-87"><a href="#DemocraticCoLearning-87"><span class="linenos"> 87</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="DemocraticCoLearning-88"><a href="#DemocraticCoLearning-88"><span class="linenos"> 88</span></a>    <span class="p">):</span>
</span><span id="DemocraticCoLearning-89"><a href="#DemocraticCoLearning-89"><span class="linenos"> 89</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-90"><a href="#DemocraticCoLearning-90"><span class="linenos"> 90</span></a><span class="sd">        Democratic Co-learning. Ensemble of classifiers of different types.</span>
</span><span id="DemocraticCoLearning-91"><a href="#DemocraticCoLearning-91"><span class="linenos"> 91</span></a>
</span><span id="DemocraticCoLearning-92"><a href="#DemocraticCoLearning-92"><span class="linenos"> 92</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-93"><a href="#DemocraticCoLearning-93"><span class="linenos"> 93</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-94"><a href="#DemocraticCoLearning-94"><span class="linenos"> 94</span></a><span class="sd">        base_estimator : {ClassifierMixin, list}, optional</span>
</span><span id="DemocraticCoLearning-95"><a href="#DemocraticCoLearning-95"><span class="linenos"> 95</span></a><span class="sd">            An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</span>
</span><span id="DemocraticCoLearning-96"><a href="#DemocraticCoLearning-96"><span class="linenos"> 96</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="DemocraticCoLearning-97"><a href="#DemocraticCoLearning-97"><span class="linenos"> 97</span></a><span class="sd">            number of base_estimators to use. None if base_estimator is a list, by default None</span>
</span><span id="DemocraticCoLearning-98"><a href="#DemocraticCoLearning-98"><span class="linenos"> 98</span></a><span class="sd">        expand_only_mislabeled : bool, optional</span>
</span><span id="DemocraticCoLearning-99"><a href="#DemocraticCoLearning-99"><span class="linenos"> 99</span></a><span class="sd">            expand only mislabeled instances by itself, by default True</span>
</span><span id="DemocraticCoLearning-100"><a href="#DemocraticCoLearning-100"><span class="linenos">100</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="DemocraticCoLearning-101"><a href="#DemocraticCoLearning-101"><span class="linenos">101</span></a><span class="sd">            confidence level, by default 0.95</span>
</span><span id="DemocraticCoLearning-102"><a href="#DemocraticCoLearning-102"><span class="linenos">102</span></a><span class="sd">        q_exp : int, optional</span>
</span><span id="DemocraticCoLearning-103"><a href="#DemocraticCoLearning-103"><span class="linenos">103</span></a><span class="sd">            exponent for the estimation for error rate, by default 2</span>
</span><span id="DemocraticCoLearning-104"><a href="#DemocraticCoLearning-104"><span class="linenos">104</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DemocraticCoLearning-105"><a href="#DemocraticCoLearning-105"><span class="linenos">105</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DemocraticCoLearning-106"><a href="#DemocraticCoLearning-106"><span class="linenos">106</span></a><span class="sd">        Raises</span>
</span><span id="DemocraticCoLearning-107"><a href="#DemocraticCoLearning-107"><span class="linenos">107</span></a><span class="sd">        ------</span>
</span><span id="DemocraticCoLearning-108"><a href="#DemocraticCoLearning-108"><span class="linenos">108</span></a><span class="sd">        AttributeError</span>
</span><span id="DemocraticCoLearning-109"><a href="#DemocraticCoLearning-109"><span class="linenos">109</span></a><span class="sd">            If n_estimators is None and base_estimator is not a list</span>
</span><span id="DemocraticCoLearning-110"><a href="#DemocraticCoLearning-110"><span class="linenos">110</span></a>
</span><span id="DemocraticCoLearning-111"><a href="#DemocraticCoLearning-111"><span class="linenos">111</span></a><span class="sd">        References</span>
</span><span id="DemocraticCoLearning-112"><a href="#DemocraticCoLearning-112"><span class="linenos">112</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-113"><a href="#DemocraticCoLearning-113"><span class="linenos">113</span></a><span class="sd">        Y. Zhou and S. Goldman, &quot;Democratic co-learning,&quot;</span>
</span><span id="DemocraticCoLearning-114"><a href="#DemocraticCoLearning-114"><span class="linenos">114</span></a><span class="sd">        16th IEEE International Conference on Tools with Artificial Intelligence,</span>
</span><span id="DemocraticCoLearning-115"><a href="#DemocraticCoLearning-115"><span class="linenos">115</span></a><span class="sd">        2004, pp. 594-602, doi: 10.1109/ICTAI.2004.48.</span>
</span><span id="DemocraticCoLearning-116"><a href="#DemocraticCoLearning-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-117"><a href="#DemocraticCoLearning-117"><span class="linenos">117</span></a>
</span><span id="DemocraticCoLearning-118"><a href="#DemocraticCoLearning-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_estimators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-119"><a href="#DemocraticCoLearning-119"><span class="linenos">119</span></a>            <span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-120"><a href="#DemocraticCoLearning-120"><span class="linenos">120</span></a>            <span class="n">random_available</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-121"><a href="#DemocraticCoLearning-121"><span class="linenos">121</span></a>            <span class="n">rand</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-122"><a href="#DemocraticCoLearning-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-123"><a href="#DemocraticCoLearning-123"><span class="linenos">123</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-124"><a href="#DemocraticCoLearning-124"><span class="linenos">124</span></a>                    <span class="s2">&quot;The classifier will not be able to converge correctly, there is not enough diversity among the estimators (learners should be different).&quot;</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-125"><a href="#DemocraticCoLearning-125"><span class="linenos">125</span></a>                    <span class="n">ConvergenceWarning</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-126"><a href="#DemocraticCoLearning-126"><span class="linenos">126</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning-127"><a href="#DemocraticCoLearning-127"><span class="linenos">127</span></a>                <span class="n">random_available</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning-128"><a href="#DemocraticCoLearning-128"><span class="linenos">128</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-129"><a href="#DemocraticCoLearning-129"><span class="linenos">129</span></a>                <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-130"><a href="#DemocraticCoLearning-130"><span class="linenos">130</span></a>                <span class="k">if</span> <span class="n">random_available</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-131"><a href="#DemocraticCoLearning-131"><span class="linenos">131</span></a>                    <span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-132"><a href="#DemocraticCoLearning-132"><span class="linenos">132</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="DemocraticCoLearning-133"><a href="#DemocraticCoLearning-133"><span class="linenos">133</span></a>
</span><span id="DemocraticCoLearning-134"><a href="#DemocraticCoLearning-134"><span class="linenos">134</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-135"><a href="#DemocraticCoLearning-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-136"><a href="#DemocraticCoLearning-136"><span class="linenos">136</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-137"><a href="#DemocraticCoLearning-137"><span class="linenos">137</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-138"><a href="#DemocraticCoLearning-138"><span class="linenos">138</span></a>                <span class="s2">&quot;If `n_estimators` is None then `base_estimator` must be a `list`.&quot;</span>
</span><span id="DemocraticCoLearning-139"><a href="#DemocraticCoLearning-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="DemocraticCoLearning-140"><a href="#DemocraticCoLearning-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-141"><a href="#DemocraticCoLearning-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-142"><a href="#DemocraticCoLearning-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-143"><a href="#DemocraticCoLearning-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span> <span class="o">=</span> <span class="n">expand_only_mislabeled</span>
</span><span id="DemocraticCoLearning-144"><a href="#DemocraticCoLearning-144"><span class="linenos">144</span></a>
</span><span id="DemocraticCoLearning-145"><a href="#DemocraticCoLearning-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="DemocraticCoLearning-146"><a href="#DemocraticCoLearning-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span> <span class="o">=</span> <span class="n">q_exp</span>
</span><span id="DemocraticCoLearning-147"><a href="#DemocraticCoLearning-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="DemocraticCoLearning-148"><a href="#DemocraticCoLearning-148"><span class="linenos">148</span></a>
</span><span id="DemocraticCoLearning-149"><a href="#DemocraticCoLearning-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">__weighted_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-150"><a href="#DemocraticCoLearning-150"><span class="linenos">150</span></a>        <span class="n">y_complete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-151"><a href="#DemocraticCoLearning-151"><span class="linenos">151</span></a>            <span class="p">[</span>
</span><span id="DemocraticCoLearning-152"><a href="#DemocraticCoLearning-152"><span class="linenos">152</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">wi</span>
</span><span id="DemocraticCoLearning-153"><a href="#DemocraticCoLearning-153"><span class="linenos">153</span></a>                <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">wi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-154"><a href="#DemocraticCoLearning-154"><span class="linenos">154</span></a>            <span class="p">],</span>
</span><span id="DemocraticCoLearning-155"><a href="#DemocraticCoLearning-155"><span class="linenos">155</span></a>            <span class="mi">0</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-156"><a href="#DemocraticCoLearning-156"><span class="linenos">156</span></a>        <span class="p">)</span>
</span><span id="DemocraticCoLearning-157"><a href="#DemocraticCoLearning-157"><span class="linenos">157</span></a>        <span class="n">y_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">y_complete</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-158"><a href="#DemocraticCoLearning-158"><span class="linenos">158</span></a>        <span class="n">y_zeros</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_complete</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">y_complete</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning-159"><a href="#DemocraticCoLearning-159"><span class="linenos">159</span></a>
</span><span id="DemocraticCoLearning-160"><a href="#DemocraticCoLearning-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_zeros</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-161"><a href="#DemocraticCoLearning-161"><span class="linenos">161</span></a>
</span><span id="DemocraticCoLearning-162"><a href="#DemocraticCoLearning-162"><span class="linenos">162</span></a>    <span class="k">def</span> <span class="nf">__calcule_last_confidences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-163"><a href="#DemocraticCoLearning-163"><span class="linenos">163</span></a>        <span class="sd">&quot;&quot;&quot;Calculate the confidence of each learner</span>
</span><span id="DemocraticCoLearning-164"><a href="#DemocraticCoLearning-164"><span class="linenos">164</span></a>
</span><span id="DemocraticCoLearning-165"><a href="#DemocraticCoLearning-165"><span class="linenos">165</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-166"><a href="#DemocraticCoLearning-166"><span class="linenos">166</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-167"><a href="#DemocraticCoLearning-167"><span class="linenos">167</span></a><span class="sd">        X : array-like</span>
</span><span id="DemocraticCoLearning-168"><a href="#DemocraticCoLearning-168"><span class="linenos">168</span></a><span class="sd">            Set of instances</span>
</span><span id="DemocraticCoLearning-169"><a href="#DemocraticCoLearning-169"><span class="linenos">169</span></a><span class="sd">        y : array-like</span>
</span><span id="DemocraticCoLearning-170"><a href="#DemocraticCoLearning-170"><span class="linenos">170</span></a><span class="sd">            Set of classes for each instance</span>
</span><span id="DemocraticCoLearning-171"><a href="#DemocraticCoLearning-171"><span class="linenos">171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-172"><a href="#DemocraticCoLearning-172"><span class="linenos">172</span></a>        <span class="n">w</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DemocraticCoLearning-173"><a href="#DemocraticCoLearning-173"><span class="linenos">173</span></a>        <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-174"><a href="#DemocraticCoLearning-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="n">w</span>
</span><span id="DemocraticCoLearning-175"><a href="#DemocraticCoLearning-175"><span class="linenos">175</span></a>
</span><span id="DemocraticCoLearning-176"><a href="#DemocraticCoLearning-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-177"><a href="#DemocraticCoLearning-177"><span class="linenos">177</span></a>        <span class="sd">&quot;&quot;&quot;Fit Democratic-Co classifier</span>
</span><span id="DemocraticCoLearning-178"><a href="#DemocraticCoLearning-178"><span class="linenos">178</span></a>
</span><span id="DemocraticCoLearning-179"><a href="#DemocraticCoLearning-179"><span class="linenos">179</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-180"><a href="#DemocraticCoLearning-180"><span class="linenos">180</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-181"><a href="#DemocraticCoLearning-181"><span class="linenos">181</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning-182"><a href="#DemocraticCoLearning-182"><span class="linenos">182</span></a><span class="sd">            The training input samples.</span>
</span><span id="DemocraticCoLearning-183"><a href="#DemocraticCoLearning-183"><span class="linenos">183</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DemocraticCoLearning-184"><a href="#DemocraticCoLearning-184"><span class="linenos">184</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DemocraticCoLearning-185"><a href="#DemocraticCoLearning-185"><span class="linenos">185</span></a><span class="sd">        estimator_kwards : {list, dict}, optional</span>
</span><span id="DemocraticCoLearning-186"><a href="#DemocraticCoLearning-186"><span class="linenos">186</span></a><span class="sd">            list of kwards for each estimator or kwards for all estimators, by default None</span>
</span><span id="DemocraticCoLearning-187"><a href="#DemocraticCoLearning-187"><span class="linenos">187</span></a>
</span><span id="DemocraticCoLearning-188"><a href="#DemocraticCoLearning-188"><span class="linenos">188</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning-189"><a href="#DemocraticCoLearning-189"><span class="linenos">189</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning-190"><a href="#DemocraticCoLearning-190"><span class="linenos">190</span></a><span class="sd">        self : DemocraticCoLearning</span>
</span><span id="DemocraticCoLearning-191"><a href="#DemocraticCoLearning-191"><span class="linenos">191</span></a><span class="sd">            fitted classifier</span>
</span><span id="DemocraticCoLearning-192"><a href="#DemocraticCoLearning-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-193"><a href="#DemocraticCoLearning-193"><span class="linenos">193</span></a>
</span><span id="DemocraticCoLearning-194"><a href="#DemocraticCoLearning-194"><span class="linenos">194</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-195"><a href="#DemocraticCoLearning-195"><span class="linenos">195</span></a>
</span><span id="DemocraticCoLearning-196"><a href="#DemocraticCoLearning-196"><span class="linenos">196</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-197"><a href="#DemocraticCoLearning-197"><span class="linenos">197</span></a>
</span><span id="DemocraticCoLearning-198"><a href="#DemocraticCoLearning-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-199"><a href="#DemocraticCoLearning-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-200"><a href="#DemocraticCoLearning-200"><span class="linenos">200</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-201"><a href="#DemocraticCoLearning-201"><span class="linenos">201</span></a>
</span><span id="DemocraticCoLearning-202"><a href="#DemocraticCoLearning-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-203"><a href="#DemocraticCoLearning-203"><span class="linenos">203</span></a>
</span><span id="DemocraticCoLearning-204"><a href="#DemocraticCoLearning-204"><span class="linenos">204</span></a>        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">X_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-205"><a href="#DemocraticCoLearning-205"><span class="linenos">205</span></a>        <span class="n">Ly</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-206"><a href="#DemocraticCoLearning-206"><span class="linenos">206</span></a>        <span class="c1"># This variable prevents duplicate instances.</span>
</span><span id="DemocraticCoLearning-207"><a href="#DemocraticCoLearning-207"><span class="linenos">207</span></a>        <span class="n">L_added</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-208"><a href="#DemocraticCoLearning-208"><span class="linenos">208</span></a>        <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-209"><a href="#DemocraticCoLearning-209"><span class="linenos">209</span></a>
</span><span id="DemocraticCoLearning-210"><a href="#DemocraticCoLearning-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">estimator_kwards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-211"><a href="#DemocraticCoLearning-211"><span class="linenos">211</span></a>            <span class="n">estimator_kwards</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-212"><a href="#DemocraticCoLearning-212"><span class="linenos">212</span></a>
</span><span id="DemocraticCoLearning-213"><a href="#DemocraticCoLearning-213"><span class="linenos">213</span></a>        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-214"><a href="#DemocraticCoLearning-214"><span class="linenos">214</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DemocraticCoLearning-215"><a href="#DemocraticCoLearning-215"><span class="linenos">215</span></a>        <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-216"><a href="#DemocraticCoLearning-216"><span class="linenos">216</span></a>            <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning-217"><a href="#DemocraticCoLearning-217"><span class="linenos">217</span></a>            <span class="n">iteration_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DemocraticCoLearning-218"><a href="#DemocraticCoLearning-218"><span class="linenos">218</span></a>            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning-219"><a href="#DemocraticCoLearning-219"><span class="linenos">219</span></a>
</span><span id="DemocraticCoLearning-220"><a href="#DemocraticCoLearning-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-221"><a href="#DemocraticCoLearning-221"><span class="linenos">221</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">estimator_kwards</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-222"><a href="#DemocraticCoLearning-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-223"><a href="#DemocraticCoLearning-223"><span class="linenos">223</span></a>                <span class="k">break</span>
</span><span id="DemocraticCoLearning-224"><a href="#DemocraticCoLearning-224"><span class="linenos">224</span></a>            <span class="c1"># Majority Vote</span>
</span><span id="DemocraticCoLearning-225"><a href="#DemocraticCoLearning-225"><span class="linenos">225</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-226"><a href="#DemocraticCoLearning-226"><span class="linenos">226</span></a>            <span class="n">majority_class</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-227"><a href="#DemocraticCoLearning-227"><span class="linenos">227</span></a>            <span class="c1"># majority_class = st.mode(np.array(predictions, dtype=predictions[0].dtype), axis=0, keepdims=True)[</span>
</span><span id="DemocraticCoLearning-228"><a href="#DemocraticCoLearning-228"><span class="linenos">228</span></a>            <span class="c1">#     0</span>
</span><span id="DemocraticCoLearning-229"><a href="#DemocraticCoLearning-229"><span class="linenos">229</span></a>            <span class="c1"># ].flatten()  # K in pseudocode</span>
</span><span id="DemocraticCoLearning-230"><a href="#DemocraticCoLearning-230"><span class="linenos">230</span></a>
</span><span id="DemocraticCoLearning-231"><a href="#DemocraticCoLearning-231"><span class="linenos">231</span></a>            <span class="n">L_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-232"><a href="#DemocraticCoLearning-232"><span class="linenos">232</span></a>            <span class="n">Ly_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-233"><a href="#DemocraticCoLearning-233"><span class="linenos">233</span></a>
</span><span id="DemocraticCoLearning-234"><a href="#DemocraticCoLearning-234"><span class="linenos">234</span></a>            <span class="c1"># Calculate confidence interval</span>
</span><span id="DemocraticCoLearning-235"><a href="#DemocraticCoLearning-235"><span class="linenos">235</span></a>            <span class="n">conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning-236"><a href="#DemocraticCoLearning-236"><span class="linenos">236</span></a>                <span class="n">confidence_interval</span><span class="p">(</span>
</span><span id="DemocraticCoLearning-237"><a href="#DemocraticCoLearning-237"><span class="linenos">237</span></a>                    <span class="n">X_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-238"><a href="#DemocraticCoLearning-238"><span class="linenos">238</span></a>                    <span class="n">H</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-239"><a href="#DemocraticCoLearning-239"><span class="linenos">239</span></a>                    <span class="n">y_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning-240"><a href="#DemocraticCoLearning-240"><span class="linenos">240</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
</span><span id="DemocraticCoLearning-241"><a href="#DemocraticCoLearning-241"><span class="linenos">241</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning-242"><a href="#DemocraticCoLearning-242"><span class="linenos">242</span></a>                <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-243"><a href="#DemocraticCoLearning-243"><span class="linenos">243</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning-244"><a href="#DemocraticCoLearning-244"><span class="linenos">244</span></a>
</span><span id="DemocraticCoLearning-245"><a href="#DemocraticCoLearning-245"><span class="linenos">245</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="n">li</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">conf_interval</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-246"><a href="#DemocraticCoLearning-246"><span class="linenos">246</span></a>            <span class="n">iteration_dict</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DemocraticCoLearning-247"><a href="#DemocraticCoLearning-247"><span class="linenos">247</span></a>                <span class="s2">&quot;cl&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-248"><a href="#DemocraticCoLearning-248"><span class="linenos">248</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">conf_interval</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</span><span id="DemocraticCoLearning-249"><a href="#DemocraticCoLearning-249"><span class="linenos">249</span></a>            <span class="p">}</span>
</span><span id="DemocraticCoLearning-250"><a href="#DemocraticCoLearning-250"><span class="linenos">250</span></a>            <span class="c1"># weighted vote</span>
</span><span id="DemocraticCoLearning-251"><a href="#DemocraticCoLearning-251"><span class="linenos">251</span></a>            <span class="n">weighted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weighted_y</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-252"><a href="#DemocraticCoLearning-252"><span class="linenos">252</span></a>
</span><span id="DemocraticCoLearning-253"><a href="#DemocraticCoLearning-253"><span class="linenos">253</span></a>            <span class="c1"># If `weighted_class` is equal as `majority_class` then</span>
</span><span id="DemocraticCoLearning-254"><a href="#DemocraticCoLearning-254"><span class="linenos">254</span></a>            <span class="c1"># the sum of classifier&#39;s weights of max voted class</span>
</span><span id="DemocraticCoLearning-255"><a href="#DemocraticCoLearning-255"><span class="linenos">255</span></a>            <span class="c1"># is greater than the max of sum of classifier&#39;s weights</span>
</span><span id="DemocraticCoLearning-256"><a href="#DemocraticCoLearning-256"><span class="linenos">256</span></a>            <span class="c1"># from another classes.</span>
</span><span id="DemocraticCoLearning-257"><a href="#DemocraticCoLearning-257"><span class="linenos">257</span></a>
</span><span id="DemocraticCoLearning-258"><a href="#DemocraticCoLearning-258"><span class="linenos">258</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="n">weighted_class</span> <span class="o">==</span> <span class="n">majority_class</span>
</span><span id="DemocraticCoLearning-259"><a href="#DemocraticCoLearning-259"><span class="linenos">259</span></a>            <span class="n">candidates_bool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-260"><a href="#DemocraticCoLearning-260"><span class="linenos">260</span></a>
</span><span id="DemocraticCoLearning-261"><a href="#DemocraticCoLearning-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-262"><a href="#DemocraticCoLearning-262"><span class="linenos">262</span></a>                <span class="n">all_same_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning-263"><a href="#DemocraticCoLearning-263"><span class="linenos">263</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-264"><a href="#DemocraticCoLearning-264"><span class="linenos">264</span></a>                    <span class="n">all_same_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-265"><a href="#DemocraticCoLearning-265"><span class="linenos">265</span></a>                <span class="n">all_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">*</span><span class="n">all_same_list</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-266"><a href="#DemocraticCoLearning-266"><span class="linenos">266</span></a>            <span class="c1"># new_instances = []</span>
</span><span id="DemocraticCoLearning-267"><a href="#DemocraticCoLearning-267"><span class="linenos">267</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-268"><a href="#DemocraticCoLearning-268"><span class="linenos">268</span></a>
</span><span id="DemocraticCoLearning-269"><a href="#DemocraticCoLearning-269"><span class="linenos">269</span></a>                <span class="n">mispredictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">weighted_class</span>
</span><span id="DemocraticCoLearning-270"><a href="#DemocraticCoLearning-270"><span class="linenos">270</span></a>                <span class="c1"># An instance from U are added to Li&#39; only if:</span>
</span><span id="DemocraticCoLearning-271"><a href="#DemocraticCoLearning-271"><span class="linenos">271</span></a>                <span class="c1">#   It is a misprediction for i</span>
</span><span id="DemocraticCoLearning-272"><a href="#DemocraticCoLearning-272"><span class="linenos">272</span></a>                <span class="c1">#   It is a candidate (weighted_class are same majority_class)</span>
</span><span id="DemocraticCoLearning-273"><a href="#DemocraticCoLearning-273"><span class="linenos">273</span></a>                <span class="c1">#   It hasn&#39;t been added yet in Li</span>
</span><span id="DemocraticCoLearning-274"><a href="#DemocraticCoLearning-274"><span class="linenos">274</span></a>
</span><span id="DemocraticCoLearning-275"><a href="#DemocraticCoLearning-275"><span class="linenos">275</span></a>                <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mispredictions</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-276"><a href="#DemocraticCoLearning-276"><span class="linenos">276</span></a>
</span><span id="DemocraticCoLearning-277"><a href="#DemocraticCoLearning-277"><span class="linenos">277</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-278"><a href="#DemocraticCoLearning-278"><span class="linenos">278</span></a>                    <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">candidates_temp</span><span class="p">,</span> <span class="n">all_same</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-279"><a href="#DemocraticCoLearning-279"><span class="linenos">279</span></a>
</span><span id="DemocraticCoLearning-280"><a href="#DemocraticCoLearning-280"><span class="linenos">280</span></a>                <span class="n">to_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">candidates_temp</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-281"><a href="#DemocraticCoLearning-281"><span class="linenos">281</span></a>
</span><span id="DemocraticCoLearning-282"><a href="#DemocraticCoLearning-282"><span class="linenos">282</span></a>                <span class="n">candidates_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_add</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-283"><a href="#DemocraticCoLearning-283"><span class="linenos">283</span></a>                <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-284"><a href="#DemocraticCoLearning-284"><span class="linenos">284</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning-285"><a href="#DemocraticCoLearning-285"><span class="linenos">285</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-286"><a href="#DemocraticCoLearning-286"><span class="linenos">286</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning-287"><a href="#DemocraticCoLearning-287"><span class="linenos">287</span></a>                <span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weighted_class</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-288"><a href="#DemocraticCoLearning-288"><span class="linenos">288</span></a>
</span><span id="DemocraticCoLearning-289"><a href="#DemocraticCoLearning-289"><span class="linenos">289</span></a>            <span class="n">new_conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning-290"><a href="#DemocraticCoLearning-290"><span class="linenos">290</span></a>                <span class="n">confidence_interval</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">H</span><span class="p">,</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-291"><a href="#DemocraticCoLearning-291"><span class="linenos">291</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-292"><a href="#DemocraticCoLearning-292"><span class="linenos">292</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning-293"><a href="#DemocraticCoLearning-293"><span class="linenos">293</span></a>            <span class="n">e_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">l_</span> <span class="k">for</span> <span class="n">l_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">new_conf_interval</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-294"><a href="#DemocraticCoLearning-294"><span class="linenos">294</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-295"><a href="#DemocraticCoLearning-295"><span class="linenos">295</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-296"><a href="#DemocraticCoLearning-296"><span class="linenos">296</span></a>
</span><span id="DemocraticCoLearning-297"><a href="#DemocraticCoLearning-297"><span class="linenos">297</span></a>                    <span class="n">qi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-298"><a href="#DemocraticCoLearning-298"><span class="linenos">298</span></a>                    <span class="n">e_i</span> <span class="o">=</span> <span class="n">e_factor</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-299"><a href="#DemocraticCoLearning-299"><span class="linenos">299</span></a>                    <span class="c1"># |Li|+|L&#39;i| == |Li U L&#39;i| because of to_add</span>
</span><span id="DemocraticCoLearning-300"><a href="#DemocraticCoLearning-300"><span class="linenos">300</span></a>                    <span class="n">q_i</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="DemocraticCoLearning-301"><a href="#DemocraticCoLearning-301"><span class="linenos">301</span></a>                        <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="DemocraticCoLearning-302"><a href="#DemocraticCoLearning-302"><span class="linenos">302</span></a>                    <span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span>
</span><span id="DemocraticCoLearning-303"><a href="#DemocraticCoLearning-303"><span class="linenos">303</span></a>                    <span class="k">if</span> <span class="n">q_i</span> <span class="o">&lt;=</span> <span class="n">qi</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-304"><a href="#DemocraticCoLearning-304"><span class="linenos">304</span></a>                        <span class="k">continue</span>
</span><span id="DemocraticCoLearning-305"><a href="#DemocraticCoLearning-305"><span class="linenos">305</span></a>                    <span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning-306"><a href="#DemocraticCoLearning-306"><span class="linenos">306</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-307"><a href="#DemocraticCoLearning-307"><span class="linenos">307</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="DemocraticCoLearning-308"><a href="#DemocraticCoLearning-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-309"><a href="#DemocraticCoLearning-309"><span class="linenos">309</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning-310"><a href="#DemocraticCoLearning-310"><span class="linenos">310</span></a>                    <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning-311"><a href="#DemocraticCoLearning-311"><span class="linenos">311</span></a>
</span><span id="DemocraticCoLearning-312"><a href="#DemocraticCoLearning-312"><span class="linenos">312</span></a>                    <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span>
</span><span id="DemocraticCoLearning-313"><a href="#DemocraticCoLearning-313"><span class="linenos">313</span></a>                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning-314"><a href="#DemocraticCoLearning-314"><span class="linenos">314</span></a>
</span><span id="DemocraticCoLearning-315"><a href="#DemocraticCoLearning-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning-316"><a href="#DemocraticCoLearning-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__calcule_last_confidences</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-317"><a href="#DemocraticCoLearning-317"><span class="linenos">317</span></a>
</span><span id="DemocraticCoLearning-318"><a href="#DemocraticCoLearning-318"><span class="linenos">318</span></a>        <span class="c1"># Ignore hypothesis</span>
</span><span id="DemocraticCoLearning-319"><a href="#DemocraticCoLearning-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-320"><a href="#DemocraticCoLearning-320"><span class="linenos">320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-321"><a href="#DemocraticCoLearning-321"><span class="linenos">321</span></a>
</span><span id="DemocraticCoLearning-322"><a href="#DemocraticCoLearning-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning-323"><a href="#DemocraticCoLearning-323"><span class="linenos">323</span></a>
</span><span id="DemocraticCoLearning-324"><a href="#DemocraticCoLearning-324"><span class="linenos">324</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="DemocraticCoLearning-325"><a href="#DemocraticCoLearning-325"><span class="linenos">325</span></a>
</span><span id="DemocraticCoLearning-326"><a href="#DemocraticCoLearning-326"><span class="linenos">326</span></a>    <span class="k">def</span> <span class="nf">__combine_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-327"><a href="#DemocraticCoLearning-327"><span class="linenos">327</span></a>
</span><span id="DemocraticCoLearning-328"><a href="#DemocraticCoLearning-328"><span class="linenos">328</span></a>        <span class="n">n_instances</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># uppercase X as it will be an np.array</span>
</span><span id="DemocraticCoLearning-329"><a href="#DemocraticCoLearning-329"><span class="linenos">329</span></a>        <span class="n">sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-330"><a href="#DemocraticCoLearning-330"><span class="linenos">330</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-331"><a href="#DemocraticCoLearning-331"><span class="linenos">331</span></a>        <span class="n">Cavg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_instances</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-332"><a href="#DemocraticCoLearning-332"><span class="linenos">332</span></a>
</span><span id="DemocraticCoLearning-333"><a href="#DemocraticCoLearning-333"><span class="linenos">333</span></a>        <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-334"><a href="#DemocraticCoLearning-334"><span class="linenos">334</span></a>            <span class="n">cj</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-335"><a href="#DemocraticCoLearning-335"><span class="linenos">335</span></a>            <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">cj</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-336"><a href="#DemocraticCoLearning-336"><span class="linenos">336</span></a>            <span class="n">C</span> <span class="o">+=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">factor</span>
</span><span id="DemocraticCoLearning-337"><a href="#DemocraticCoLearning-337"><span class="linenos">337</span></a>            <span class="n">sizes</span> <span class="o">+=</span> <span class="n">factor</span>
</span><span id="DemocraticCoLearning-338"><a href="#DemocraticCoLearning-338"><span class="linenos">338</span></a>
</span><span id="DemocraticCoLearning-339"><a href="#DemocraticCoLearning-339"><span class="linenos">339</span></a>        <span class="n">Cavg</span><span class="p">[</span><span class="n">sizes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># «voting power» of 0.5 for small groups</span>
</span><span id="DemocraticCoLearning-340"><a href="#DemocraticCoLearning-340"><span class="linenos">340</span></a>        <span class="n">ne</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># non empty groups</span>
</span><span id="DemocraticCoLearning-341"><a href="#DemocraticCoLearning-341"><span class="linenos">341</span></a>        <span class="n">Cavg</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span> <span class="o">/</span> <span class="n">sizes</span><span class="p">[</span><span class="n">ne</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-342"><a href="#DemocraticCoLearning-342"><span class="linenos">342</span></a>
</span><span id="DemocraticCoLearning-343"><a href="#DemocraticCoLearning-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">Cavg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-344"><a href="#DemocraticCoLearning-344"><span class="linenos">344</span></a>
</span><span id="DemocraticCoLearning-345"><a href="#DemocraticCoLearning-345"><span class="linenos">345</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-346"><a href="#DemocraticCoLearning-346"><span class="linenos">346</span></a>        <span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="DemocraticCoLearning-347"><a href="#DemocraticCoLearning-347"><span class="linenos">347</span></a>
</span><span id="DemocraticCoLearning-348"><a href="#DemocraticCoLearning-348"><span class="linenos">348</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning-349"><a href="#DemocraticCoLearning-349"><span class="linenos">349</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning-350"><a href="#DemocraticCoLearning-350"><span class="linenos">350</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning-351"><a href="#DemocraticCoLearning-351"><span class="linenos">351</span></a><span class="sd">            Array representing the data.</span>
</span><span id="DemocraticCoLearning-352"><a href="#DemocraticCoLearning-352"><span class="linenos">352</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning-353"><a href="#DemocraticCoLearning-353"><span class="linenos">353</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning-354"><a href="#DemocraticCoLearning-354"><span class="linenos">354</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="DemocraticCoLearning-355"><a href="#DemocraticCoLearning-355"><span class="linenos">355</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="DemocraticCoLearning-356"><a href="#DemocraticCoLearning-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning-357"><a href="#DemocraticCoLearning-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DemocraticCoLearning-358"><a href="#DemocraticCoLearning-358"><span class="linenos">358</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-359"><a href="#DemocraticCoLearning-359"><span class="linenos">359</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
</span><span id="DemocraticCoLearning-360"><a href="#DemocraticCoLearning-360"><span class="linenos">360</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_probabilities</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning-361"><a href="#DemocraticCoLearning-361"><span class="linenos">361</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning-362"><a href="#DemocraticCoLearning-362"><span class="linenos">362</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#DemocraticCoLearning.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="DemocraticCoLearning.__init__" class="classattr">
                                        <input id="DemocraticCoLearning.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DemocraticCoLearning</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span>,</span><span class="param">	<span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DemocraticCoLearning.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.__init__-76"><a href="#DemocraticCoLearning.__init__-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-77"><a href="#DemocraticCoLearning.__init__-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-78"><a href="#DemocraticCoLearning.__init__-78"><span class="linenos"> 78</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="p">[</span>
</span><span id="DemocraticCoLearning.__init__-79"><a href="#DemocraticCoLearning.__init__-79"><span class="linenos"> 79</span></a>            <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning.__init__-80"><a href="#DemocraticCoLearning.__init__-80"><span class="linenos"> 80</span></a>            <span class="n">GaussianNB</span><span class="p">(),</span>
</span><span id="DemocraticCoLearning.__init__-81"><a href="#DemocraticCoLearning.__init__-81"><span class="linenos"> 81</span></a>            <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="DemocraticCoLearning.__init__-82"><a href="#DemocraticCoLearning.__init__-82"><span class="linenos"> 82</span></a>        <span class="p">],</span>
</span><span id="DemocraticCoLearning.__init__-83"><a href="#DemocraticCoLearning.__init__-83"><span class="linenos"> 83</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-84"><a href="#DemocraticCoLearning.__init__-84"><span class="linenos"> 84</span></a>        <span class="n">expand_only_mislabeled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-85"><a href="#DemocraticCoLearning.__init__-85"><span class="linenos"> 85</span></a>        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-86"><a href="#DemocraticCoLearning.__init__-86"><span class="linenos"> 86</span></a>        <span class="n">q_exp</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-87"><a href="#DemocraticCoLearning.__init__-87"><span class="linenos"> 87</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>
</span><span id="DemocraticCoLearning.__init__-88"><a href="#DemocraticCoLearning.__init__-88"><span class="linenos"> 88</span></a>    <span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-89"><a href="#DemocraticCoLearning.__init__-89"><span class="linenos"> 89</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.__init__-90"><a href="#DemocraticCoLearning.__init__-90"><span class="linenos"> 90</span></a><span class="sd">        Democratic Co-learning. Ensemble of classifiers of different types.</span>
</span><span id="DemocraticCoLearning.__init__-91"><a href="#DemocraticCoLearning.__init__-91"><span class="linenos"> 91</span></a>
</span><span id="DemocraticCoLearning.__init__-92"><a href="#DemocraticCoLearning.__init__-92"><span class="linenos"> 92</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.__init__-93"><a href="#DemocraticCoLearning.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.__init__-94"><a href="#DemocraticCoLearning.__init__-94"><span class="linenos"> 94</span></a><span class="sd">        base_estimator : {ClassifierMixin, list}, optional</span>
</span><span id="DemocraticCoLearning.__init__-95"><a href="#DemocraticCoLearning.__init__-95"><span class="linenos"> 95</span></a><span class="sd">            An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</span>
</span><span id="DemocraticCoLearning.__init__-96"><a href="#DemocraticCoLearning.__init__-96"><span class="linenos"> 96</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="DemocraticCoLearning.__init__-97"><a href="#DemocraticCoLearning.__init__-97"><span class="linenos"> 97</span></a><span class="sd">            number of base_estimators to use. None if base_estimator is a list, by default None</span>
</span><span id="DemocraticCoLearning.__init__-98"><a href="#DemocraticCoLearning.__init__-98"><span class="linenos"> 98</span></a><span class="sd">        expand_only_mislabeled : bool, optional</span>
</span><span id="DemocraticCoLearning.__init__-99"><a href="#DemocraticCoLearning.__init__-99"><span class="linenos"> 99</span></a><span class="sd">            expand only mislabeled instances by itself, by default True</span>
</span><span id="DemocraticCoLearning.__init__-100"><a href="#DemocraticCoLearning.__init__-100"><span class="linenos">100</span></a><span class="sd">        alpha : float, optional</span>
</span><span id="DemocraticCoLearning.__init__-101"><a href="#DemocraticCoLearning.__init__-101"><span class="linenos">101</span></a><span class="sd">            confidence level, by default 0.95</span>
</span><span id="DemocraticCoLearning.__init__-102"><a href="#DemocraticCoLearning.__init__-102"><span class="linenos">102</span></a><span class="sd">        q_exp : int, optional</span>
</span><span id="DemocraticCoLearning.__init__-103"><a href="#DemocraticCoLearning.__init__-103"><span class="linenos">103</span></a><span class="sd">            exponent for the estimation for error rate, by default 2</span>
</span><span id="DemocraticCoLearning.__init__-104"><a href="#DemocraticCoLearning.__init__-104"><span class="linenos">104</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="DemocraticCoLearning.__init__-105"><a href="#DemocraticCoLearning.__init__-105"><span class="linenos">105</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="DemocraticCoLearning.__init__-106"><a href="#DemocraticCoLearning.__init__-106"><span class="linenos">106</span></a><span class="sd">        Raises</span>
</span><span id="DemocraticCoLearning.__init__-107"><a href="#DemocraticCoLearning.__init__-107"><span class="linenos">107</span></a><span class="sd">        ------</span>
</span><span id="DemocraticCoLearning.__init__-108"><a href="#DemocraticCoLearning.__init__-108"><span class="linenos">108</span></a><span class="sd">        AttributeError</span>
</span><span id="DemocraticCoLearning.__init__-109"><a href="#DemocraticCoLearning.__init__-109"><span class="linenos">109</span></a><span class="sd">            If n_estimators is None and base_estimator is not a list</span>
</span><span id="DemocraticCoLearning.__init__-110"><a href="#DemocraticCoLearning.__init__-110"><span class="linenos">110</span></a>
</span><span id="DemocraticCoLearning.__init__-111"><a href="#DemocraticCoLearning.__init__-111"><span class="linenos">111</span></a><span class="sd">        References</span>
</span><span id="DemocraticCoLearning.__init__-112"><a href="#DemocraticCoLearning.__init__-112"><span class="linenos">112</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.__init__-113"><a href="#DemocraticCoLearning.__init__-113"><span class="linenos">113</span></a><span class="sd">        Y. Zhou and S. Goldman, &quot;Democratic co-learning,&quot;</span>
</span><span id="DemocraticCoLearning.__init__-114"><a href="#DemocraticCoLearning.__init__-114"><span class="linenos">114</span></a><span class="sd">        16th IEEE International Conference on Tools with Artificial Intelligence,</span>
</span><span id="DemocraticCoLearning.__init__-115"><a href="#DemocraticCoLearning.__init__-115"><span class="linenos">115</span></a><span class="sd">        2004, pp. 594-602, doi: 10.1109/ICTAI.2004.48.</span>
</span><span id="DemocraticCoLearning.__init__-116"><a href="#DemocraticCoLearning.__init__-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.__init__-117"><a href="#DemocraticCoLearning.__init__-117"><span class="linenos">117</span></a>
</span><span id="DemocraticCoLearning.__init__-118"><a href="#DemocraticCoLearning.__init__-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_estimators</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-119"><a href="#DemocraticCoLearning.__init__-119"><span class="linenos">119</span></a>            <span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.__init__-120"><a href="#DemocraticCoLearning.__init__-120"><span class="linenos">120</span></a>            <span class="n">random_available</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.__init__-121"><a href="#DemocraticCoLearning.__init__-121"><span class="linenos">121</span></a>            <span class="n">rand</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-122"><a href="#DemocraticCoLearning.__init__-122"><span class="linenos">122</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-123"><a href="#DemocraticCoLearning.__init__-123"><span class="linenos">123</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-124"><a href="#DemocraticCoLearning.__init__-124"><span class="linenos">124</span></a>                    <span class="s2">&quot;The classifier will not be able to converge correctly, there is not enough diversity among the estimators (learners should be different).&quot;</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-125"><a href="#DemocraticCoLearning.__init__-125"><span class="linenos">125</span></a>                    <span class="n">ConvergenceWarning</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.__init__-126"><a href="#DemocraticCoLearning.__init__-126"><span class="linenos">126</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-127"><a href="#DemocraticCoLearning.__init__-127"><span class="linenos">127</span></a>                <span class="n">random_available</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning.__init__-128"><a href="#DemocraticCoLearning.__init__-128"><span class="linenos">128</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-129"><a href="#DemocraticCoLearning.__init__-129"><span class="linenos">129</span></a>                <span class="n">estimators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.__init__-130"><a href="#DemocraticCoLearning.__init__-130"><span class="linenos">130</span></a>                <span class="k">if</span> <span class="n">random_available</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-131"><a href="#DemocraticCoLearning.__init__-131"><span class="linenos">131</span></a>                    <span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-132"><a href="#DemocraticCoLearning.__init__-132"><span class="linenos">132</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="DemocraticCoLearning.__init__-133"><a href="#DemocraticCoLearning.__init__-133"><span class="linenos">133</span></a>
</span><span id="DemocraticCoLearning.__init__-134"><a href="#DemocraticCoLearning.__init__-134"><span class="linenos">134</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.__init__-135"><a href="#DemocraticCoLearning.__init__-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.__init__-136"><a href="#DemocraticCoLearning.__init__-136"><span class="linenos">136</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.__init__-137"><a href="#DemocraticCoLearning.__init__-137"><span class="linenos">137</span></a>            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.__init__-138"><a href="#DemocraticCoLearning.__init__-138"><span class="linenos">138</span></a>                <span class="s2">&quot;If `n_estimators` is None then `base_estimator` must be a `list`.&quot;</span>
</span><span id="DemocraticCoLearning.__init__-139"><a href="#DemocraticCoLearning.__init__-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-140"><a href="#DemocraticCoLearning.__init__-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-141"><a href="#DemocraticCoLearning.__init__-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-142"><a href="#DemocraticCoLearning.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.__init__-143"><a href="#DemocraticCoLearning.__init__-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span> <span class="o">=</span> <span class="n">expand_only_mislabeled</span>
</span><span id="DemocraticCoLearning.__init__-144"><a href="#DemocraticCoLearning.__init__-144"><span class="linenos">144</span></a>
</span><span id="DemocraticCoLearning.__init__-145"><a href="#DemocraticCoLearning.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
</span><span id="DemocraticCoLearning.__init__-146"><a href="#DemocraticCoLearning.__init__-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span> <span class="o">=</span> <span class="n">q_exp</span>
</span><span id="DemocraticCoLearning.__init__-147"><a href="#DemocraticCoLearning.__init__-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span></pre></div>


            <div class="docstring"><p>Democratic Co-learning. Ensemble of classifiers of different types.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> ({ClassifierMixin, list}, optional):
An estimator object implementing fit and predict_proba or a list of ClassifierMixin, by default DecisionTreeClassifier()</li>
<li><strong>n_estimators</strong> (int, optional):
number of base_estimators to use. None if base_estimator is a list, by default None</li>
<li><strong>expand_only_mislabeled</strong> (bool, optional):
expand only mislabeled instances by itself, by default True</li>
<li><strong>alpha</strong> (float, optional):
confidence level, by default 0.95</li>
<li><strong>q_exp</strong> (int, optional):
exponent for the estimation for error rate, by default 2</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>AttributeError</strong>: If n_estimators is None and base_estimator is not a list</li>
</ul>

<h6 id="references">References</h6>

<p>Y. Zhou and S. Goldman, "Democratic co-learning,"
16th IEEE International Conference on Tools with Artificial Intelligence,
2004, pp. 594-602, doi: 10.1109/ICTAI.2004.48.</p>
</div>


                            </div>
                            <div id="DemocraticCoLearning.fit" class="classattr">
                                        <input id="DemocraticCoLearning.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DemocraticCoLearning.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.fit-176"><a href="#DemocraticCoLearning.fit-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">estimator_kwards</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-177"><a href="#DemocraticCoLearning.fit-177"><span class="linenos">177</span></a>        <span class="sd">&quot;&quot;&quot;Fit Democratic-Co classifier</span>
</span><span id="DemocraticCoLearning.fit-178"><a href="#DemocraticCoLearning.fit-178"><span class="linenos">178</span></a>
</span><span id="DemocraticCoLearning.fit-179"><a href="#DemocraticCoLearning.fit-179"><span class="linenos">179</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.fit-180"><a href="#DemocraticCoLearning.fit-180"><span class="linenos">180</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.fit-181"><a href="#DemocraticCoLearning.fit-181"><span class="linenos">181</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning.fit-182"><a href="#DemocraticCoLearning.fit-182"><span class="linenos">182</span></a><span class="sd">            The training input samples.</span>
</span><span id="DemocraticCoLearning.fit-183"><a href="#DemocraticCoLearning.fit-183"><span class="linenos">183</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="DemocraticCoLearning.fit-184"><a href="#DemocraticCoLearning.fit-184"><span class="linenos">184</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="DemocraticCoLearning.fit-185"><a href="#DemocraticCoLearning.fit-185"><span class="linenos">185</span></a><span class="sd">        estimator_kwards : {list, dict}, optional</span>
</span><span id="DemocraticCoLearning.fit-186"><a href="#DemocraticCoLearning.fit-186"><span class="linenos">186</span></a><span class="sd">            list of kwards for each estimator or kwards for all estimators, by default None</span>
</span><span id="DemocraticCoLearning.fit-187"><a href="#DemocraticCoLearning.fit-187"><span class="linenos">187</span></a>
</span><span id="DemocraticCoLearning.fit-188"><a href="#DemocraticCoLearning.fit-188"><span class="linenos">188</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning.fit-189"><a href="#DemocraticCoLearning.fit-189"><span class="linenos">189</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning.fit-190"><a href="#DemocraticCoLearning.fit-190"><span class="linenos">190</span></a><span class="sd">        self : DemocraticCoLearning</span>
</span><span id="DemocraticCoLearning.fit-191"><a href="#DemocraticCoLearning.fit-191"><span class="linenos">191</span></a><span class="sd">            fitted classifier</span>
</span><span id="DemocraticCoLearning.fit-192"><a href="#DemocraticCoLearning.fit-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.fit-193"><a href="#DemocraticCoLearning.fit-193"><span class="linenos">193</span></a>
</span><span id="DemocraticCoLearning.fit-194"><a href="#DemocraticCoLearning.fit-194"><span class="linenos">194</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-195"><a href="#DemocraticCoLearning.fit-195"><span class="linenos">195</span></a>
</span><span id="DemocraticCoLearning.fit-196"><a href="#DemocraticCoLearning.fit-196"><span class="linenos">196</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-197"><a href="#DemocraticCoLearning.fit-197"><span class="linenos">197</span></a>
</span><span id="DemocraticCoLearning.fit-198"><a href="#DemocraticCoLearning.fit-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-199"><a href="#DemocraticCoLearning.fit-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-200"><a href="#DemocraticCoLearning.fit-200"><span class="linenos">200</span></a>        <span class="n">y_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-201"><a href="#DemocraticCoLearning.fit-201"><span class="linenos">201</span></a>
</span><span id="DemocraticCoLearning.fit-202"><a href="#DemocraticCoLearning.fit-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">one_hot</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_label</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.fit-203"><a href="#DemocraticCoLearning.fit-203"><span class="linenos">203</span></a>
</span><span id="DemocraticCoLearning.fit-204"><a href="#DemocraticCoLearning.fit-204"><span class="linenos">204</span></a>        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">X_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-205"><a href="#DemocraticCoLearning.fit-205"><span class="linenos">205</span></a>        <span class="n">Ly</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_label</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-206"><a href="#DemocraticCoLearning.fit-206"><span class="linenos">206</span></a>        <span class="c1"># This variable prevents duplicate instances.</span>
</span><span id="DemocraticCoLearning.fit-207"><a href="#DemocraticCoLearning.fit-207"><span class="linenos">207</span></a>        <span class="n">L_added</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-208"><a href="#DemocraticCoLearning.fit-208"><span class="linenos">208</span></a>        <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-209"><a href="#DemocraticCoLearning.fit-209"><span class="linenos">209</span></a>
</span><span id="DemocraticCoLearning.fit-210"><a href="#DemocraticCoLearning.fit-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">estimator_kwards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-211"><a href="#DemocraticCoLearning.fit-211"><span class="linenos">211</span></a>            <span class="n">estimator_kwards</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-212"><a href="#DemocraticCoLearning.fit-212"><span class="linenos">212</span></a>
</span><span id="DemocraticCoLearning.fit-213"><a href="#DemocraticCoLearning.fit-213"><span class="linenos">213</span></a>        <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.fit-214"><a href="#DemocraticCoLearning.fit-214"><span class="linenos">214</span></a>        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DemocraticCoLearning.fit-215"><a href="#DemocraticCoLearning.fit-215"><span class="linenos">215</span></a>        <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-216"><a href="#DemocraticCoLearning.fit-216"><span class="linenos">216</span></a>            <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="DemocraticCoLearning.fit-217"><a href="#DemocraticCoLearning.fit-217"><span class="linenos">217</span></a>            <span class="n">iteration_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="DemocraticCoLearning.fit-218"><a href="#DemocraticCoLearning.fit-218"><span class="linenos">218</span></a>            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="DemocraticCoLearning.fit-219"><a href="#DemocraticCoLearning.fit-219"><span class="linenos">219</span></a>
</span><span id="DemocraticCoLearning.fit-220"><a href="#DemocraticCoLearning.fit-220"><span class="linenos">220</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-221"><a href="#DemocraticCoLearning.fit-221"><span class="linenos">221</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">estimator_kwards</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-222"><a href="#DemocraticCoLearning.fit-222"><span class="linenos">222</span></a>            <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-223"><a href="#DemocraticCoLearning.fit-223"><span class="linenos">223</span></a>                <span class="k">break</span>
</span><span id="DemocraticCoLearning.fit-224"><a href="#DemocraticCoLearning.fit-224"><span class="linenos">224</span></a>            <span class="c1"># Majority Vote</span>
</span><span id="DemocraticCoLearning.fit-225"><a href="#DemocraticCoLearning.fit-225"><span class="linenos">225</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-226"><a href="#DemocraticCoLearning.fit-226"><span class="linenos">226</span></a>            <span class="n">majority_class</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-227"><a href="#DemocraticCoLearning.fit-227"><span class="linenos">227</span></a>            <span class="c1"># majority_class = st.mode(np.array(predictions, dtype=predictions[0].dtype), axis=0, keepdims=True)[</span>
</span><span id="DemocraticCoLearning.fit-228"><a href="#DemocraticCoLearning.fit-228"><span class="linenos">228</span></a>            <span class="c1">#     0</span>
</span><span id="DemocraticCoLearning.fit-229"><a href="#DemocraticCoLearning.fit-229"><span class="linenos">229</span></a>            <span class="c1"># ].flatten()  # K in pseudocode</span>
</span><span id="DemocraticCoLearning.fit-230"><a href="#DemocraticCoLearning.fit-230"><span class="linenos">230</span></a>
</span><span id="DemocraticCoLearning.fit-231"><a href="#DemocraticCoLearning.fit-231"><span class="linenos">231</span></a>            <span class="n">L_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-232"><a href="#DemocraticCoLearning.fit-232"><span class="linenos">232</span></a>            <span class="n">Ly_</span> <span class="o">=</span> <span class="p">[[]]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-233"><a href="#DemocraticCoLearning.fit-233"><span class="linenos">233</span></a>
</span><span id="DemocraticCoLearning.fit-234"><a href="#DemocraticCoLearning.fit-234"><span class="linenos">234</span></a>            <span class="c1"># Calculate confidence interval</span>
</span><span id="DemocraticCoLearning.fit-235"><a href="#DemocraticCoLearning.fit-235"><span class="linenos">235</span></a>            <span class="n">conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning.fit-236"><a href="#DemocraticCoLearning.fit-236"><span class="linenos">236</span></a>                <span class="n">confidence_interval</span><span class="p">(</span>
</span><span id="DemocraticCoLearning.fit-237"><a href="#DemocraticCoLearning.fit-237"><span class="linenos">237</span></a>                    <span class="n">X_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-238"><a href="#DemocraticCoLearning.fit-238"><span class="linenos">238</span></a>                    <span class="n">H</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-239"><a href="#DemocraticCoLearning.fit-239"><span class="linenos">239</span></a>                    <span class="n">y_label</span><span class="p">,</span>
</span><span id="DemocraticCoLearning.fit-240"><a href="#DemocraticCoLearning.fit-240"><span class="linenos">240</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
</span><span id="DemocraticCoLearning.fit-241"><a href="#DemocraticCoLearning.fit-241"><span class="linenos">241</span></a>                <span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-242"><a href="#DemocraticCoLearning.fit-242"><span class="linenos">242</span></a>                <span class="k">for</span> <span class="n">H</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.fit-243"><a href="#DemocraticCoLearning.fit-243"><span class="linenos">243</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-244"><a href="#DemocraticCoLearning.fit-244"><span class="linenos">244</span></a>
</span><span id="DemocraticCoLearning.fit-245"><a href="#DemocraticCoLearning.fit-245"><span class="linenos">245</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="p">[(</span><span class="n">li</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="p">(</span><span class="n">li</span><span class="p">,</span> <span class="n">hi</span><span class="p">)</span> <span class="ow">in</span> <span class="n">conf_interval</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-246"><a href="#DemocraticCoLearning.fit-246"><span class="linenos">246</span></a>            <span class="n">iteration_dict</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DemocraticCoLearning.fit-247"><a href="#DemocraticCoLearning.fit-247"><span class="linenos">247</span></a>                <span class="s2">&quot;cl&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-248"><a href="#DemocraticCoLearning.fit-248"><span class="linenos">248</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">w</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">conf_interval</span><span class="p">,</span> <span class="n">weights</span><span class="p">))</span>
</span><span id="DemocraticCoLearning.fit-249"><a href="#DemocraticCoLearning.fit-249"><span class="linenos">249</span></a>            <span class="p">}</span>
</span><span id="DemocraticCoLearning.fit-250"><a href="#DemocraticCoLearning.fit-250"><span class="linenos">250</span></a>            <span class="c1"># weighted vote</span>
</span><span id="DemocraticCoLearning.fit-251"><a href="#DemocraticCoLearning.fit-251"><span class="linenos">251</span></a>            <span class="n">weighted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__weighted_y</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-252"><a href="#DemocraticCoLearning.fit-252"><span class="linenos">252</span></a>
</span><span id="DemocraticCoLearning.fit-253"><a href="#DemocraticCoLearning.fit-253"><span class="linenos">253</span></a>            <span class="c1"># If `weighted_class` is equal as `majority_class` then</span>
</span><span id="DemocraticCoLearning.fit-254"><a href="#DemocraticCoLearning.fit-254"><span class="linenos">254</span></a>            <span class="c1"># the sum of classifier&#39;s weights of max voted class</span>
</span><span id="DemocraticCoLearning.fit-255"><a href="#DemocraticCoLearning.fit-255"><span class="linenos">255</span></a>            <span class="c1"># is greater than the max of sum of classifier&#39;s weights</span>
</span><span id="DemocraticCoLearning.fit-256"><a href="#DemocraticCoLearning.fit-256"><span class="linenos">256</span></a>            <span class="c1"># from another classes.</span>
</span><span id="DemocraticCoLearning.fit-257"><a href="#DemocraticCoLearning.fit-257"><span class="linenos">257</span></a>
</span><span id="DemocraticCoLearning.fit-258"><a href="#DemocraticCoLearning.fit-258"><span class="linenos">258</span></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="n">weighted_class</span> <span class="o">==</span> <span class="n">majority_class</span>
</span><span id="DemocraticCoLearning.fit-259"><a href="#DemocraticCoLearning.fit-259"><span class="linenos">259</span></a>            <span class="n">candidates_bool</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.fit-260"><a href="#DemocraticCoLearning.fit-260"><span class="linenos">260</span></a>
</span><span id="DemocraticCoLearning.fit-261"><a href="#DemocraticCoLearning.fit-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-262"><a href="#DemocraticCoLearning.fit-262"><span class="linenos">262</span></a>                <span class="n">all_same_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="DemocraticCoLearning.fit-263"><a href="#DemocraticCoLearning.fit-263"><span class="linenos">263</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-264"><a href="#DemocraticCoLearning.fit-264"><span class="linenos">264</span></a>                    <span class="n">all_same_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-265"><a href="#DemocraticCoLearning.fit-265"><span class="linenos">265</span></a>                <span class="n">all_same</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">*</span><span class="n">all_same_list</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-266"><a href="#DemocraticCoLearning.fit-266"><span class="linenos">266</span></a>            <span class="c1"># new_instances = []</span>
</span><span id="DemocraticCoLearning.fit-267"><a href="#DemocraticCoLearning.fit-267"><span class="linenos">267</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-268"><a href="#DemocraticCoLearning.fit-268"><span class="linenos">268</span></a>
</span><span id="DemocraticCoLearning.fit-269"><a href="#DemocraticCoLearning.fit-269"><span class="linenos">269</span></a>                <span class="n">mispredictions</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">weighted_class</span>
</span><span id="DemocraticCoLearning.fit-270"><a href="#DemocraticCoLearning.fit-270"><span class="linenos">270</span></a>                <span class="c1"># An instance from U are added to Li&#39; only if:</span>
</span><span id="DemocraticCoLearning.fit-271"><a href="#DemocraticCoLearning.fit-271"><span class="linenos">271</span></a>                <span class="c1">#   It is a misprediction for i</span>
</span><span id="DemocraticCoLearning.fit-272"><a href="#DemocraticCoLearning.fit-272"><span class="linenos">272</span></a>                <span class="c1">#   It is a candidate (weighted_class are same majority_class)</span>
</span><span id="DemocraticCoLearning.fit-273"><a href="#DemocraticCoLearning.fit-273"><span class="linenos">273</span></a>                <span class="c1">#   It hasn&#39;t been added yet in Li</span>
</span><span id="DemocraticCoLearning.fit-274"><a href="#DemocraticCoLearning.fit-274"><span class="linenos">274</span></a>
</span><span id="DemocraticCoLearning.fit-275"><a href="#DemocraticCoLearning.fit-275"><span class="linenos">275</span></a>                <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mispredictions</span><span class="p">,</span> <span class="n">candidates</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-276"><a href="#DemocraticCoLearning.fit-276"><span class="linenos">276</span></a>
</span><span id="DemocraticCoLearning.fit-277"><a href="#DemocraticCoLearning.fit-277"><span class="linenos">277</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">expand_only_mislabeled</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-278"><a href="#DemocraticCoLearning.fit-278"><span class="linenos">278</span></a>                    <span class="n">candidates_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">candidates_temp</span><span class="p">,</span> <span class="n">all_same</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-279"><a href="#DemocraticCoLearning.fit-279"><span class="linenos">279</span></a>
</span><span id="DemocraticCoLearning.fit-280"><a href="#DemocraticCoLearning.fit-280"><span class="linenos">280</span></a>                <span class="n">to_add</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">candidates_temp</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-281"><a href="#DemocraticCoLearning.fit-281"><span class="linenos">281</span></a>
</span><span id="DemocraticCoLearning.fit-282"><a href="#DemocraticCoLearning.fit-282"><span class="linenos">282</span></a>                <span class="n">candidates_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_add</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-283"><a href="#DemocraticCoLearning.fit-283"><span class="linenos">283</span></a>                <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-284"><a href="#DemocraticCoLearning.fit-284"><span class="linenos">284</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning.fit-285"><a href="#DemocraticCoLearning.fit-285"><span class="linenos">285</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-286"><a href="#DemocraticCoLearning.fit-286"><span class="linenos">286</span></a>                    <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="DemocraticCoLearning.fit-287"><a href="#DemocraticCoLearning.fit-287"><span class="linenos">287</span></a>                <span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weighted_class</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-288"><a href="#DemocraticCoLearning.fit-288"><span class="linenos">288</span></a>
</span><span id="DemocraticCoLearning.fit-289"><a href="#DemocraticCoLearning.fit-289"><span class="linenos">289</span></a>            <span class="n">new_conf_interval</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DemocraticCoLearning.fit-290"><a href="#DemocraticCoLearning.fit-290"><span class="linenos">290</span></a>                <span class="n">confidence_interval</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">H</span><span class="p">,</span> <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-291"><a href="#DemocraticCoLearning.fit-291"><span class="linenos">291</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-292"><a href="#DemocraticCoLearning.fit-292"><span class="linenos">292</span></a>            <span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-293"><a href="#DemocraticCoLearning.fit-293"><span class="linenos">293</span></a>            <span class="n">e_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">l_</span> <span class="k">for</span> <span class="n">l_</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">new_conf_interval</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-294"><a href="#DemocraticCoLearning.fit-294"><span class="linenos">294</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.fit-295"><a href="#DemocraticCoLearning.fit-295"><span class="linenos">295</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-296"><a href="#DemocraticCoLearning.fit-296"><span class="linenos">296</span></a>
</span><span id="DemocraticCoLearning.fit-297"><a href="#DemocraticCoLearning.fit-297"><span class="linenos">297</span></a>                    <span class="n">qi</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-298"><a href="#DemocraticCoLearning.fit-298"><span class="linenos">298</span></a>                    <span class="n">e_i</span> <span class="o">=</span> <span class="n">e_factor</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-299"><a href="#DemocraticCoLearning.fit-299"><span class="linenos">299</span></a>                    <span class="c1"># |Li|+|L&#39;i| == |Li U L&#39;i| because of to_add</span>
</span><span id="DemocraticCoLearning.fit-300"><a href="#DemocraticCoLearning.fit-300"><span class="linenos">300</span></a>                    <span class="n">q_i</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="DemocraticCoLearning.fit-301"><a href="#DemocraticCoLearning.fit-301"><span class="linenos">301</span></a>                        <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="DemocraticCoLearning.fit-302"><a href="#DemocraticCoLearning.fit-302"><span class="linenos">302</span></a>                    <span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_exp</span>
</span><span id="DemocraticCoLearning.fit-303"><a href="#DemocraticCoLearning.fit-303"><span class="linenos">303</span></a>                    <span class="k">if</span> <span class="n">q_i</span> <span class="o">&lt;=</span> <span class="n">qi</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-304"><a href="#DemocraticCoLearning.fit-304"><span class="linenos">304</span></a>                        <span class="k">continue</span>
</span><span id="DemocraticCoLearning.fit-305"><a href="#DemocraticCoLearning.fit-305"><span class="linenos">305</span></a>                    <span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">L_added</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">candidates_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="DemocraticCoLearning.fit-306"><a href="#DemocraticCoLearning.fit-306"><span class="linenos">306</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-307"><a href="#DemocraticCoLearning.fit-307"><span class="linenos">307</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span><span id="DemocraticCoLearning.fit-308"><a href="#DemocraticCoLearning.fit-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.fit-309"><a href="#DemocraticCoLearning.fit-309"><span class="linenos">309</span></a>                        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning.fit-310"><a href="#DemocraticCoLearning.fit-310"><span class="linenos">310</span></a>                    <span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">Ly</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ly_</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
</span><span id="DemocraticCoLearning.fit-311"><a href="#DemocraticCoLearning.fit-311"><span class="linenos">311</span></a>
</span><span id="DemocraticCoLearning.fit-312"><a href="#DemocraticCoLearning.fit-312"><span class="linenos">312</span></a>                    <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_i</span>
</span><span id="DemocraticCoLearning.fit-313"><a href="#DemocraticCoLearning.fit-313"><span class="linenos">313</span></a>                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="DemocraticCoLearning.fit-314"><a href="#DemocraticCoLearning.fit-314"><span class="linenos">314</span></a>
</span><span id="DemocraticCoLearning.fit-315"><a href="#DemocraticCoLearning.fit-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="DemocraticCoLearning.fit-316"><a href="#DemocraticCoLearning.fit-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__calcule_last_confidences</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.fit-317"><a href="#DemocraticCoLearning.fit-317"><span class="linenos">317</span></a>
</span><span id="DemocraticCoLearning.fit-318"><a href="#DemocraticCoLearning.fit-318"><span class="linenos">318</span></a>        <span class="c1"># Ignore hypothesis</span>
</span><span id="DemocraticCoLearning.fit-319"><a href="#DemocraticCoLearning.fit-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-320"><a href="#DemocraticCoLearning.fit-320"><span class="linenos">320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidences_</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.fit-321"><a href="#DemocraticCoLearning.fit-321"><span class="linenos">321</span></a>
</span><span id="DemocraticCoLearning.fit-322"><a href="#DemocraticCoLearning.fit-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="DemocraticCoLearning.fit-323"><a href="#DemocraticCoLearning.fit-323"><span class="linenos">323</span></a>
</span><span id="DemocraticCoLearning.fit-324"><a href="#DemocraticCoLearning.fit-324"><span class="linenos">324</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Democratic-Co classifier</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
<li><strong>estimator_kwards</strong> ({list, dict}, optional):
list of kwards for each estimator or kwards for all estimators, by default None</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (DemocraticCoLearning):
fitted classifier</li>
</ul>
</div>


                            </div>
                            <div id="DemocraticCoLearning.predict_proba" class="classattr">
                                        <input id="DemocraticCoLearning.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DemocraticCoLearning.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DemocraticCoLearning.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DemocraticCoLearning.predict_proba-345"><a href="#DemocraticCoLearning.predict_proba-345"><span class="linenos">345</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.predict_proba-346"><a href="#DemocraticCoLearning.predict_proba-346"><span class="linenos">346</span></a>        <span class="sd">&quot;&quot;&quot;Predict probability for each possible outcome.</span>
</span><span id="DemocraticCoLearning.predict_proba-347"><a href="#DemocraticCoLearning.predict_proba-347"><span class="linenos">347</span></a>
</span><span id="DemocraticCoLearning.predict_proba-348"><a href="#DemocraticCoLearning.predict_proba-348"><span class="linenos">348</span></a><span class="sd">        Parameters</span>
</span><span id="DemocraticCoLearning.predict_proba-349"><a href="#DemocraticCoLearning.predict_proba-349"><span class="linenos">349</span></a><span class="sd">        ----------</span>
</span><span id="DemocraticCoLearning.predict_proba-350"><a href="#DemocraticCoLearning.predict_proba-350"><span class="linenos">350</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="DemocraticCoLearning.predict_proba-351"><a href="#DemocraticCoLearning.predict_proba-351"><span class="linenos">351</span></a><span class="sd">            Array representing the data.</span>
</span><span id="DemocraticCoLearning.predict_proba-352"><a href="#DemocraticCoLearning.predict_proba-352"><span class="linenos">352</span></a><span class="sd">        Returns</span>
</span><span id="DemocraticCoLearning.predict_proba-353"><a href="#DemocraticCoLearning.predict_proba-353"><span class="linenos">353</span></a><span class="sd">        -------</span>
</span><span id="DemocraticCoLearning.predict_proba-354"><a href="#DemocraticCoLearning.predict_proba-354"><span class="linenos">354</span></a><span class="sd">        class probabilities: ndarray of shape (n_samples, n_classes)</span>
</span><span id="DemocraticCoLearning.predict_proba-355"><a href="#DemocraticCoLearning.predict_proba-355"><span class="linenos">355</span></a><span class="sd">            Array with prediction probabilities.</span>
</span><span id="DemocraticCoLearning.predict_proba-356"><a href="#DemocraticCoLearning.predict_proba-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DemocraticCoLearning.predict_proba-357"><a href="#DemocraticCoLearning.predict_proba-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="s2">&quot;h_&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DemocraticCoLearning.predict_proba-358"><a href="#DemocraticCoLearning.predict_proba-358"><span class="linenos">358</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.predict_proba-359"><a href="#DemocraticCoLearning.predict_proba-359"><span class="linenos">359</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
</span><span id="DemocraticCoLearning.predict_proba-360"><a href="#DemocraticCoLearning.predict_proba-360"><span class="linenos">360</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__combine_probabilities</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DemocraticCoLearning.predict_proba-361"><a href="#DemocraticCoLearning.predict_proba-361"><span class="linenos">361</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DemocraticCoLearning.predict_proba-362"><a href="#DemocraticCoLearning.predict_proba-362"><span class="linenos">362</span></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span><span class="s2">&quot;Classifier not fitted&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probability for each possible outcome.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
Array representing the data.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>class probabilities</strong> (ndarray of shape (n_samples, n_classes)):
Array with prediction probabilities.</li>
</ul>
</div>


                            </div>
                            <div id="DemocraticCoLearning.set_fit_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_fit_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#DemocraticCoLearning.set_fit_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#DemocraticCoLearning.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div id="DemocraticCoLearning.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#DemocraticCoLearning.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code><a href="#DemocraticCoLearning.set_fit_request">set_fit_request</a></code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="DemocraticCoLearning.get_params" class="function">get_params</dd>
                <dd id="DemocraticCoLearning.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="DemocraticCoLearning.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="DemocraticCoLearning.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="DemocraticCoLearning.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Setred">
                            <input id="Setred-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Setred</span><wbr>(<span class="base">sklearn.base.ClassifierMixin</span>, <span class="base">sklearn.base.BaseEstimator</span>):

                <label class="view-source-button" for="Setred-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred-105"><a href="#Setred-105"><span class="linenos">105</span></a><span class="k">class</span> <span class="nc">Setred</span><span class="p">(</span><span class="n">ClassifierMixin</span><span class="p">,</span> <span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="Setred-106"><a href="#Setred-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Setred-107"><a href="#Setred-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Setred-108"><a href="#Setred-108"><span class="linenos">108</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="Setred-109"><a href="#Setred-109"><span class="linenos">109</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
</span><span id="Setred-110"><a href="#Setred-110"><span class="linenos">110</span></a>        <span class="n">distance</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span>
</span><span id="Setred-111"><a href="#Setred-111"><span class="linenos">111</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="Setred-112"><a href="#Setred-112"><span class="linenos">112</span></a>        <span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="Setred-113"><a href="#Setred-113"><span class="linenos">113</span></a>        <span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Setred-114"><a href="#Setred-114"><span class="linenos">114</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred-115"><a href="#Setred-115"><span class="linenos">115</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred-116"><a href="#Setred-116"><span class="linenos">116</span></a>    <span class="p">):</span>
</span><span id="Setred-117"><a href="#Setred-117"><span class="linenos">117</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred-118"><a href="#Setred-118"><span class="linenos">118</span></a><span class="sd">        Create a SETRED classifier.</span>
</span><span id="Setred-119"><a href="#Setred-119"><span class="linenos">119</span></a><span class="sd">        It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</span>
</span><span id="Setred-120"><a href="#Setred-120"><span class="linenos">120</span></a><span class="sd">        </span>
</span><span id="Setred-121"><a href="#Setred-121"><span class="linenos">121</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-122"><a href="#Setred-122"><span class="linenos">122</span></a><span class="sd">        ----------</span>
</span><span id="Setred-123"><a href="#Setred-123"><span class="linenos">123</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Setred-124"><a href="#Setred-124"><span class="linenos">124</span></a><span class="sd">            An estimator object implementing fit and predict_proba,, by default DecisionTreeClassifier(), by default KNeighborsClassifier(n_neighbors=3)</span>
</span><span id="Setred-125"><a href="#Setred-125"><span class="linenos">125</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Setred-126"><a href="#Setred-126"><span class="linenos">126</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</span>
</span><span id="Setred-127"><a href="#Setred-127"><span class="linenos">127</span></a><span class="sd">        distance : str, optional</span>
</span><span id="Setred-128"><a href="#Setred-128"><span class="linenos">128</span></a><span class="sd">            The distance metric to use for the graph.</span>
</span><span id="Setred-129"><a href="#Setred-129"><span class="linenos">129</span></a><span class="sd">            The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.</span>
</span><span id="Setred-130"><a href="#Setred-130"><span class="linenos">130</span></a><span class="sd">            For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.</span>
</span><span id="Setred-131"><a href="#Setred-131"><span class="linenos">131</span></a><span class="sd">            Note that the “cosine” metric uses cosine_distances., by default &quot;euclidean&quot;</span>
</span><span id="Setred-132"><a href="#Setred-132"><span class="linenos">132</span></a><span class="sd">        poolsize : float, optional</span>
</span><span id="Setred-133"><a href="#Setred-133"><span class="linenos">133</span></a><span class="sd">            Max number of unlabel instances candidates to pseudolabel, by default 0.25</span>
</span><span id="Setred-134"><a href="#Setred-134"><span class="linenos">134</span></a><span class="sd">        rejection_threshold : float, optional</span>
</span><span id="Setred-135"><a href="#Setred-135"><span class="linenos">135</span></a><span class="sd">            significance level, by default 0.1</span>
</span><span id="Setred-136"><a href="#Setred-136"><span class="linenos">136</span></a><span class="sd">        graph_neighbors : int, optional</span>
</span><span id="Setred-137"><a href="#Setred-137"><span class="linenos">137</span></a><span class="sd">            Number of neighbors for each sample., by default 1</span>
</span><span id="Setred-138"><a href="#Setred-138"><span class="linenos">138</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Setred-139"><a href="#Setred-139"><span class="linenos">139</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Setred-140"><a href="#Setred-140"><span class="linenos">140</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="Setred-141"><a href="#Setred-141"><span class="linenos">141</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</span>
</span><span id="Setred-142"><a href="#Setred-142"><span class="linenos">142</span></a><span class="sd">        </span>
</span><span id="Setred-143"><a href="#Setred-143"><span class="linenos">143</span></a><span class="sd">        References</span>
</span><span id="Setred-144"><a href="#Setred-144"><span class="linenos">144</span></a><span class="sd">        ----------</span>
</span><span id="Setred-145"><a href="#Setred-145"><span class="linenos">145</span></a><span class="sd">        Li, Ming, and Zhi-Hua Zhou. &quot;SETRED: Self-training with editing.&quot;</span>
</span><span id="Setred-146"><a href="#Setred-146"><span class="linenos">146</span></a><span class="sd">        Pacific-Asia Conference on Knowledge Discovery and Data Mining.</span>
</span><span id="Setred-147"><a href="#Setred-147"><span class="linenos">147</span></a><span class="sd">        Springer, Berlin, Heidelberg, 2005. doi: 10.1007/11430919_71.</span>
</span><span id="Setred-148"><a href="#Setred-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-149"><a href="#Setred-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">can_be_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Setred-150"><a href="#Setred-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="Setred-151"><a href="#Setred-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="Setred-152"><a href="#Setred-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span>
</span><span id="Setred-153"><a href="#Setred-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span> <span class="o">=</span> <span class="n">rejection_threshold</span>
</span><span id="Setred-154"><a href="#Setred-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span> <span class="o">=</span> <span class="n">graph_neighbors</span>
</span><span id="Setred-155"><a href="#Setred-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Setred-156"><a href="#Setred-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="Setred-157"><a href="#Setred-157"><span class="linenos">157</span></a>
</span><span id="Setred-158"><a href="#Setred-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">__create_neighborhood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="Setred-159"><a href="#Setred-159"><span class="linenos">159</span></a>        <span class="c1"># kneighbors_graph(X, 1, metric=self.distance, n_jobs=self.n_jobs).toarray()</span>
</span><span id="Setred-160"><a href="#Setred-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="n">kneighbors_graph</span><span class="p">(</span>
</span><span id="Setred-161"><a href="#Setred-161"><span class="linenos">161</span></a>            <span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distance</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span>
</span><span id="Setred-162"><a href="#Setred-162"><span class="linenos">162</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</span><span id="Setred-163"><a href="#Setred-163"><span class="linenos">163</span></a>
</span><span id="Setred-164"><a href="#Setred-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">):</span>
</span><span id="Setred-165"><a href="#Setred-165"><span class="linenos">165</span></a>        <span class="sd">&quot;&quot;&quot;Build a Setred classifier from the training set (X, y).</span>
</span><span id="Setred-166"><a href="#Setred-166"><span class="linenos">166</span></a>
</span><span id="Setred-167"><a href="#Setred-167"><span class="linenos">167</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-168"><a href="#Setred-168"><span class="linenos">168</span></a><span class="sd">        ----------</span>
</span><span id="Setred-169"><a href="#Setred-169"><span class="linenos">169</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-170"><a href="#Setred-170"><span class="linenos">170</span></a><span class="sd">            The training input samples.</span>
</span><span id="Setred-171"><a href="#Setred-171"><span class="linenos">171</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred-172"><a href="#Setred-172"><span class="linenos">172</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="Setred-173"><a href="#Setred-173"><span class="linenos">173</span></a>
</span><span id="Setred-174"><a href="#Setred-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="Setred-175"><a href="#Setred-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="Setred-176"><a href="#Setred-176"><span class="linenos">176</span></a><span class="sd">        self: Setred</span>
</span><span id="Setred-177"><a href="#Setred-177"><span class="linenos">177</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Setred-178"><a href="#Setred-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="Setred-179"><a href="#Setred-179"><span class="linenos">179</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Setred-180"><a href="#Setred-180"><span class="linenos">180</span></a>
</span><span id="Setred-181"><a href="#Setred-181"><span class="linenos">181</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Setred-182"><a href="#Setred-182"><span class="linenos">182</span></a>
</span><span id="Setred-183"><a href="#Setred-183"><span class="linenos">183</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Setred-184"><a href="#Setred-184"><span class="linenos">184</span></a>
</span><span id="Setred-185"><a href="#Setred-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Setred-186"><a href="#Setred-186"><span class="linenos">186</span></a>
</span><span id="Setred-187"><a href="#Setred-187"><span class="linenos">187</span></a>        <span class="n">each_iteration_candidates</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Setred-188"><a href="#Setred-188"><span class="linenos">188</span></a>
</span><span id="Setred-189"><a href="#Setred-189"><span class="linenos">189</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">)</span>
</span><span id="Setred-190"><a href="#Setred-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="Setred-191"><a href="#Setred-191"><span class="linenos">191</span></a>
</span><span id="Setred-192"><a href="#Setred-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">)</span>
</span><span id="Setred-193"><a href="#Setred-193"><span class="linenos">193</span></a>
</span><span id="Setred-194"><a href="#Setred-194"><span class="linenos">194</span></a>        <span class="n">y_probabilities</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span>
</span><span id="Setred-195"><a href="#Setred-195"><span class="linenos">195</span></a>            <span class="n">y_label</span>
</span><span id="Setred-196"><a href="#Setred-196"><span class="linenos">196</span></a>        <span class="p">)</span>  <span class="c1"># Should probabilities change every iteration or may it keep with the first L?</span>
</span><span id="Setred-197"><a href="#Setred-197"><span class="linenos">197</span></a>
</span><span id="Setred-198"><a href="#Setred-198"><span class="linenos">198</span></a>        <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Setred-199"><a href="#Setred-199"><span class="linenos">199</span></a>
</span><span id="Setred-200"><a href="#Setred-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Setred-201"><a href="#Setred-201"><span class="linenos">201</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred-202"><a href="#Setred-202"><span class="linenos">202</span></a>
</span><span id="Setred-203"><a href="#Setred-203"><span class="linenos">203</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="Setred-204"><a href="#Setred-204"><span class="linenos">204</span></a>            <span class="n">U_</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="Setred-205"><a href="#Setred-205"><span class="linenos">205</span></a>                <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">pool</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
</span><span id="Setred-206"><a href="#Setred-206"><span class="linenos">206</span></a>            <span class="p">)</span>
</span><span id="Setred-207"><a href="#Setred-207"><span class="linenos">207</span></a>
</span><span id="Setred-208"><a href="#Setred-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-209"><a href="#Setred-209"><span class="linenos">209</span></a>                <span class="n">U_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Setred-210"><a href="#Setred-210"><span class="linenos">210</span></a>
</span><span id="Setred-211"><a href="#Setred-211"><span class="linenos">211</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">U_</span><span class="p">)</span>
</span><span id="Setred-212"><a href="#Setred-212"><span class="linenos">212</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-213"><a href="#Setred-213"><span class="linenos">213</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-214"><a href="#Setred-214"><span class="linenos">214</span></a>            <span class="c1"># Unless a better understanding is given, only the size of L will be used as maximal size of the candidate set.</span>
</span><span id="Setred-215"><a href="#Setred-215"><span class="linenos">215</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="n">each_iteration_candidates</span><span class="p">:]</span>
</span><span id="Setred-216"><a href="#Setred-216"><span class="linenos">216</span></a>
</span><span id="Setred-217"><a href="#Setred-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-218"><a href="#Setred-218"><span class="linenos">218</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred-219"><a href="#Setred-219"><span class="linenos">219</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-220"><a href="#Setred-220"><span class="linenos">220</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred-221"><a href="#Setred-221"><span class="linenos">221</span></a>            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Setred-222"><a href="#Setred-222"><span class="linenos">222</span></a>                <span class="nb">list</span><span class="p">(</span>
</span><span id="Setred-223"><a href="#Setred-223"><span class="linenos">223</span></a>                    <span class="nb">map</span><span class="p">(</span>
</span><span id="Setred-224"><a href="#Setred-224"><span class="linenos">224</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
</span><span id="Setred-225"><a href="#Setred-225"><span class="linenos">225</span></a>                        <span class="n">class_predicted</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span>
</span><span id="Setred-226"><a href="#Setred-226"><span class="linenos">226</span></a>                    <span class="p">)</span>
</span><span id="Setred-227"><a href="#Setred-227"><span class="linenos">227</span></a>                <span class="p">)</span>
</span><span id="Setred-228"><a href="#Setred-228"><span class="linenos">228</span></a>            <span class="p">)</span>
</span><span id="Setred-229"><a href="#Setred-229"><span class="linenos">229</span></a>
</span><span id="Setred-230"><a href="#Setred-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-231"><a href="#Setred-231"><span class="linenos">231</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">])</span>
</span><span id="Setred-232"><a href="#Setred-232"><span class="linenos">232</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-233"><a href="#Setred-233"><span class="linenos">233</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-234"><a href="#Setred-234"><span class="linenos">234</span></a>
</span><span id="Setred-235"><a href="#Setred-235"><span class="linenos">235</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_neighborhood</span><span class="p">(</span><span class="n">pre_L</span><span class="p">)</span>
</span><span id="Setred-236"><a href="#Setred-236"><span class="linenos">236</span></a>            <span class="c1">#  Keep only weights for L_</span>
</span><span id="Setred-237"><a href="#Setred-237"><span class="linenos">237</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">L_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:,</span> <span class="p">:]</span>
</span><span id="Setred-238"><a href="#Setred-238"><span class="linenos">238</span></a>
</span><span id="Setred-239"><a href="#Setred-239"><span class="linenos">239</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">y_</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="n">sort_idx</span><span class="p">)</span>
</span><span id="Setred-240"><a href="#Setred-240"><span class="linenos">240</span></a>            <span class="n">p_wrong</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">values</span><span class="p">())))[</span><span class="n">sort_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Setred-241"><a href="#Setred-241"><span class="linenos">241</span></a>            <span class="c1">#  Must weights be the inverse of distance?</span>
</span><span id="Setred-242"><a href="#Setred-242"><span class="linenos">242</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">weights</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-243"><a href="#Setred-243"><span class="linenos">243</span></a>
</span><span id="Setred-244"><a href="#Setred-244"><span class="linenos">244</span></a>            <span class="n">weights_sum</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-245"><a href="#Setred-245"><span class="linenos">245</span></a>            <span class="n">weights_square_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-246"><a href="#Setred-246"><span class="linenos">246</span></a>
</span><span id="Setred-247"><a href="#Setred-247"><span class="linenos">247</span></a>            <span class="n">iid_random</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span>
</span><span id="Setred-248"><a href="#Setred-248"><span class="linenos">248</span></a>                <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p_wrong</span><span class="p">,</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Setred-249"><a href="#Setred-249"><span class="linenos">249</span></a>            <span class="p">)</span>
</span><span id="Setred-250"><a href="#Setred-250"><span class="linenos">250</span></a>            <span class="n">ji</span> <span class="o">=</span> <span class="p">(</span><span class="n">iid_random</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred-251"><a href="#Setred-251"><span class="linenos">251</span></a>
</span><span id="Setred-252"><a href="#Setred-252"><span class="linenos">252</span></a>            <span class="n">mu_h0</span> <span class="o">=</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_sum</span>
</span><span id="Setred-253"><a href="#Setred-253"><span class="linenos">253</span></a>            <span class="n">sigma_h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_wrong</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_square_sum</span><span class="p">)</span>
</span><span id="Setred-254"><a href="#Setred-254"><span class="linenos">254</span></a>            
</span><span id="Setred-255"><a href="#Setred-255"><span class="linenos">255</span></a>            <span class="n">z_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">((</span><span class="n">ji</span> <span class="o">-</span> <span class="n">mu_h0</span><span class="p">),</span> <span class="n">sigma_h0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sigma_h0</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">sigma_h0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-256"><a href="#Setred-256"><span class="linenos">256</span></a>            <span class="c1"># z_score = (ji - mu_h0) / sigma_h0</span>
</span><span id="Setred-257"><a href="#Setred-257"><span class="linenos">257</span></a>            
</span><span id="Setred-258"><a href="#Setred-258"><span class="linenos">258</span></a>            <span class="n">oi</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">),</span> <span class="n">mu_h0</span><span class="p">,</span> <span class="n">sigma_h0</span><span class="p">)</span>
</span><span id="Setred-259"><a href="#Setred-259"><span class="linenos">259</span></a>            <span class="n">to_add</span> <span class="o">=</span> <span class="p">(</span><span class="n">oi</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="n">mu_h0</span><span class="p">)</span>
</span><span id="Setred-260"><a href="#Setred-260"><span class="linenos">260</span></a>
</span><span id="Setred-261"><a href="#Setred-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-262"><a href="#Setred-262"><span class="linenos">262</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred-263"><a href="#Setred-263"><span class="linenos">263</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-264"><a href="#Setred-264"><span class="linenos">264</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred-265"><a href="#Setred-265"><span class="linenos">265</span></a>            <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred-266"><a href="#Setred-266"><span class="linenos">266</span></a>            
</span><span id="Setred-267"><a href="#Setred-267"><span class="linenos">267</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-268"><a href="#Setred-268"><span class="linenos">268</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">])</span>
</span><span id="Setred-269"><a href="#Setred-269"><span class="linenos">269</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-270"><a href="#Setred-270"><span class="linenos">270</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-271"><a href="#Setred-271"><span class="linenos">271</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-272"><a href="#Setred-272"><span class="linenos">272</span></a>
</span><span id="Setred-273"><a href="#Setred-273"><span class="linenos">273</span></a>            <span class="c1">#  Remove the instances from the unlabeled set.</span>
</span><span id="Setred-274"><a href="#Setred-274"><span class="linenos">274</span></a>            <span class="n">to_delete</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred-275"><a href="#Setred-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred-276"><a href="#Setred-276"><span class="linenos">276</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">to_delete</span><span class="p">])</span>
</span><span id="Setred-277"><a href="#Setred-277"><span class="linenos">277</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred-278"><a href="#Setred-278"><span class="linenos">278</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred-279"><a href="#Setred-279"><span class="linenos">279</span></a>
</span><span id="Setred-280"><a href="#Setred-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred-281"><a href="#Setred-281"><span class="linenos">281</span></a>
</span><span id="Setred-282"><a href="#Setred-282"><span class="linenos">282</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred-283"><a href="#Setred-283"><span class="linenos">283</span></a>        <span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="Setred-284"><a href="#Setred-284"><span class="linenos">284</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="Setred-285"><a href="#Setred-285"><span class="linenos">285</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-286"><a href="#Setred-286"><span class="linenos">286</span></a><span class="sd">        ----------</span>
</span><span id="Setred-287"><a href="#Setred-287"><span class="linenos">287</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-288"><a href="#Setred-288"><span class="linenos">288</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred-289"><a href="#Setred-289"><span class="linenos">289</span></a><span class="sd">        Returns</span>
</span><span id="Setred-290"><a href="#Setred-290"><span class="linenos">290</span></a><span class="sd">        -------</span>
</span><span id="Setred-291"><a href="#Setred-291"><span class="linenos">291</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred-292"><a href="#Setred-292"><span class="linenos">292</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred-293"><a href="#Setred-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-294"><a href="#Setred-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="Setred-295"><a href="#Setred-295"><span class="linenos">295</span></a>
</span><span id="Setred-296"><a href="#Setred-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred-297"><a href="#Setred-297"><span class="linenos">297</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="Setred-298"><a href="#Setred-298"><span class="linenos">298</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="Setred-299"><a href="#Setred-299"><span class="linenos">299</span></a><span class="sd">        Parameters</span>
</span><span id="Setred-300"><a href="#Setred-300"><span class="linenos">300</span></a><span class="sd">        ----------</span>
</span><span id="Setred-301"><a href="#Setred-301"><span class="linenos">301</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred-302"><a href="#Setred-302"><span class="linenos">302</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred-303"><a href="#Setred-303"><span class="linenos">303</span></a><span class="sd">        Returns</span>
</span><span id="Setred-304"><a href="#Setred-304"><span class="linenos">304</span></a><span class="sd">        -------</span>
</span><span id="Setred-305"><a href="#Setred-305"><span class="linenos">305</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="Setred-306"><a href="#Setred-306"><span class="linenos">306</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred-307"><a href="#Setred-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred-308"><a href="#Setred-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Mixin class for all classifiers in scikit-learn.</p>
</div>


                            <div id="Setred.__init__" class="classattr">
                                        <input id="Setred.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Setred</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>,</span><span class="param">	<span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span>,</span><span class="param">	<span class="n">distance</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span>,</span><span class="param">	<span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span>,</span><span class="param">	<span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span>,</span><span class="param">	<span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Setred.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.__init__-106"><a href="#Setred.__init__-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Setred.__init__-107"><a href="#Setred.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Setred.__init__-108"><a href="#Setred.__init__-108"><span class="linenos">108</span></a>        <span class="n">base_estimator</span><span class="o">=</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
</span><span id="Setred.__init__-109"><a href="#Setred.__init__-109"><span class="linenos">109</span></a>        <span class="n">max_iterations</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
</span><span id="Setred.__init__-110"><a href="#Setred.__init__-110"><span class="linenos">110</span></a>        <span class="n">distance</span><span class="o">=</span><span class="s2">&quot;euclidean&quot;</span><span class="p">,</span>
</span><span id="Setred.__init__-111"><a href="#Setred.__init__-111"><span class="linenos">111</span></a>        <span class="n">poolsize</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="Setred.__init__-112"><a href="#Setred.__init__-112"><span class="linenos">112</span></a>        <span class="n">rejection_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="Setred.__init__-113"><a href="#Setred.__init__-113"><span class="linenos">113</span></a>        <span class="n">graph_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Setred.__init__-114"><a href="#Setred.__init__-114"><span class="linenos">114</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred.__init__-115"><a href="#Setred.__init__-115"><span class="linenos">115</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Setred.__init__-116"><a href="#Setred.__init__-116"><span class="linenos">116</span></a>    <span class="p">):</span>
</span><span id="Setred.__init__-117"><a href="#Setred.__init__-117"><span class="linenos">117</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Setred.__init__-118"><a href="#Setred.__init__-118"><span class="linenos">118</span></a><span class="sd">        Create a SETRED classifier.</span>
</span><span id="Setred.__init__-119"><a href="#Setred.__init__-119"><span class="linenos">119</span></a><span class="sd">        It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</span>
</span><span id="Setred.__init__-120"><a href="#Setred.__init__-120"><span class="linenos">120</span></a><span class="sd">        </span>
</span><span id="Setred.__init__-121"><a href="#Setred.__init__-121"><span class="linenos">121</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.__init__-122"><a href="#Setred.__init__-122"><span class="linenos">122</span></a><span class="sd">        ----------</span>
</span><span id="Setred.__init__-123"><a href="#Setred.__init__-123"><span class="linenos">123</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="Setred.__init__-124"><a href="#Setred.__init__-124"><span class="linenos">124</span></a><span class="sd">            An estimator object implementing fit and predict_proba,, by default DecisionTreeClassifier(), by default KNeighborsClassifier(n_neighbors=3)</span>
</span><span id="Setred.__init__-125"><a href="#Setred.__init__-125"><span class="linenos">125</span></a><span class="sd">        max_iterations : int, optional</span>
</span><span id="Setred.__init__-126"><a href="#Setred.__init__-126"><span class="linenos">126</span></a><span class="sd">            Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</span>
</span><span id="Setred.__init__-127"><a href="#Setred.__init__-127"><span class="linenos">127</span></a><span class="sd">        distance : str, optional</span>
</span><span id="Setred.__init__-128"><a href="#Setred.__init__-128"><span class="linenos">128</span></a><span class="sd">            The distance metric to use for the graph.</span>
</span><span id="Setred.__init__-129"><a href="#Setred.__init__-129"><span class="linenos">129</span></a><span class="sd">            The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.</span>
</span><span id="Setred.__init__-130"><a href="#Setred.__init__-130"><span class="linenos">130</span></a><span class="sd">            For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.</span>
</span><span id="Setred.__init__-131"><a href="#Setred.__init__-131"><span class="linenos">131</span></a><span class="sd">            Note that the “cosine” metric uses cosine_distances., by default &quot;euclidean&quot;</span>
</span><span id="Setred.__init__-132"><a href="#Setred.__init__-132"><span class="linenos">132</span></a><span class="sd">        poolsize : float, optional</span>
</span><span id="Setred.__init__-133"><a href="#Setred.__init__-133"><span class="linenos">133</span></a><span class="sd">            Max number of unlabel instances candidates to pseudolabel, by default 0.25</span>
</span><span id="Setred.__init__-134"><a href="#Setred.__init__-134"><span class="linenos">134</span></a><span class="sd">        rejection_threshold : float, optional</span>
</span><span id="Setred.__init__-135"><a href="#Setred.__init__-135"><span class="linenos">135</span></a><span class="sd">            significance level, by default 0.1</span>
</span><span id="Setred.__init__-136"><a href="#Setred.__init__-136"><span class="linenos">136</span></a><span class="sd">        graph_neighbors : int, optional</span>
</span><span id="Setred.__init__-137"><a href="#Setred.__init__-137"><span class="linenos">137</span></a><span class="sd">            Number of neighbors for each sample., by default 1</span>
</span><span id="Setred.__init__-138"><a href="#Setred.__init__-138"><span class="linenos">138</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="Setred.__init__-139"><a href="#Setred.__init__-139"><span class="linenos">139</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="Setred.__init__-140"><a href="#Setred.__init__-140"><span class="linenos">140</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="Setred.__init__-141"><a href="#Setred.__init__-141"><span class="linenos">141</span></a><span class="sd">            The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</span>
</span><span id="Setred.__init__-142"><a href="#Setred.__init__-142"><span class="linenos">142</span></a><span class="sd">        </span>
</span><span id="Setred.__init__-143"><a href="#Setred.__init__-143"><span class="linenos">143</span></a><span class="sd">        References</span>
</span><span id="Setred.__init__-144"><a href="#Setred.__init__-144"><span class="linenos">144</span></a><span class="sd">        ----------</span>
</span><span id="Setred.__init__-145"><a href="#Setred.__init__-145"><span class="linenos">145</span></a><span class="sd">        Li, Ming, and Zhi-Hua Zhou. &quot;SETRED: Self-training with editing.&quot;</span>
</span><span id="Setred.__init__-146"><a href="#Setred.__init__-146"><span class="linenos">146</span></a><span class="sd">        Pacific-Asia Conference on Knowledge Discovery and Data Mining.</span>
</span><span id="Setred.__init__-147"><a href="#Setred.__init__-147"><span class="linenos">147</span></a><span class="sd">        Springer, Berlin, Heidelberg, 2005. doi: 10.1007/11430919_71.</span>
</span><span id="Setred.__init__-148"><a href="#Setred.__init__-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.__init__-149"><a href="#Setred.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">can_be_list</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Setred.__init__-150"><a href="#Setred.__init__-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="n">max_iterations</span>
</span><span id="Setred.__init__-151"><a href="#Setred.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span> <span class="o">=</span> <span class="n">poolsize</span>
</span><span id="Setred.__init__-152"><a href="#Setred.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">distance</span>
</span><span id="Setred.__init__-153"><a href="#Setred.__init__-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span> <span class="o">=</span> <span class="n">rejection_threshold</span>
</span><span id="Setred.__init__-154"><a href="#Setred.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">graph_neighbors</span> <span class="o">=</span> <span class="n">graph_neighbors</span>
</span><span id="Setred.__init__-155"><a href="#Setred.__init__-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="Setred.__init__-156"><a href="#Setred.__init__-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span></pre></div>


            <div class="docstring"><p>Create a SETRED classifier.
It is a self-training algorithm that uses a rejection mechanism to avoid adding noisy samples to the training set.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba,, by default DecisionTreeClassifier(), by default KNeighborsClassifier(n_neighbors=3)</li>
<li><strong>max_iterations</strong> (int, optional):
Maximum number of iterations allowed. Should be greater than or equal to 0., by default 40</li>
<li><strong>distance</strong> (str, optional):
The distance metric to use for the graph.
The default metric is euclidean, and with p=2 is equivalent to the standard Euclidean metric.
For a list of available metrics, see the documentation of DistanceMetric and the metrics listed in sklearn.metrics.pairwise.PAIRWISE_DISTANCE_FUNCTIONS.
Note that the “cosine” metric uses cosine_distances., by default "euclidean"</li>
<li><strong>poolsize</strong> (float, optional):
Max number of unlabel instances candidates to pseudolabel, by default 0.25</li>
<li><strong>rejection_threshold</strong> (float, optional):
significance level, by default 0.1</li>
<li><strong>graph_neighbors</strong> (int, optional):
Number of neighbors for each sample., by default 1</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>n_jobs</strong> (int, optional):
The number of parallel jobs to run for neighbors search. None means 1 unless in a joblib.parallel_backend context. -1 means using all processors, by default None</li>
</ul>

<h6 id="references">References</h6>

<p>Li, Ming, and Zhi-Hua Zhou. "SETRED: Self-training with editing."
Pacific-Asia Conference on Knowledge Discovery and Data Mining.
Springer, Berlin, Heidelberg, 2005. doi: 10.1007/11430919_71.</p>
</div>


                            </div>
                            <div id="Setred.fit" class="classattr">
                                        <input id="Setred.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwars</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.fit-164"><a href="#Setred.fit-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">):</span>
</span><span id="Setred.fit-165"><a href="#Setred.fit-165"><span class="linenos">165</span></a>        <span class="sd">&quot;&quot;&quot;Build a Setred classifier from the training set (X, y).</span>
</span><span id="Setred.fit-166"><a href="#Setred.fit-166"><span class="linenos">166</span></a>
</span><span id="Setred.fit-167"><a href="#Setred.fit-167"><span class="linenos">167</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.fit-168"><a href="#Setred.fit-168"><span class="linenos">168</span></a><span class="sd">        ----------</span>
</span><span id="Setred.fit-169"><a href="#Setred.fit-169"><span class="linenos">169</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.fit-170"><a href="#Setred.fit-170"><span class="linenos">170</span></a><span class="sd">            The training input samples.</span>
</span><span id="Setred.fit-171"><a href="#Setred.fit-171"><span class="linenos">171</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred.fit-172"><a href="#Setred.fit-172"><span class="linenos">172</span></a><span class="sd">            The target values (class labels), -1 if unlabeled.</span>
</span><span id="Setred.fit-173"><a href="#Setred.fit-173"><span class="linenos">173</span></a>
</span><span id="Setred.fit-174"><a href="#Setred.fit-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="Setred.fit-175"><a href="#Setred.fit-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="Setred.fit-176"><a href="#Setred.fit-176"><span class="linenos">176</span></a><span class="sd">        self: Setred</span>
</span><span id="Setred.fit-177"><a href="#Setred.fit-177"><span class="linenos">177</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="Setred.fit-178"><a href="#Setred.fit-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="Setred.fit-179"><a href="#Setred.fit-179"><span class="linenos">179</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="Setred.fit-180"><a href="#Setred.fit-180"><span class="linenos">180</span></a>
</span><span id="Setred.fit-181"><a href="#Setred.fit-181"><span class="linenos">181</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="Setred.fit-182"><a href="#Setred.fit-182"><span class="linenos">182</span></a>
</span><span id="Setred.fit-183"><a href="#Setred.fit-183"><span class="linenos">183</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="Setred.fit-184"><a href="#Setred.fit-184"><span class="linenos">184</span></a>
</span><span id="Setred.fit-185"><a href="#Setred.fit-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="Setred.fit-186"><a href="#Setred.fit-186"><span class="linenos">186</span></a>
</span><span id="Setred.fit-187"><a href="#Setred.fit-187"><span class="linenos">187</span></a>        <span class="n">each_iteration_candidates</span> <span class="o">=</span> <span class="n">X_label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Setred.fit-188"><a href="#Setred.fit-188"><span class="linenos">188</span></a>
</span><span id="Setred.fit-189"><a href="#Setred.fit-189"><span class="linenos">189</span></a>        <span class="n">pool</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">poolsize</span><span class="p">)</span>
</span><span id="Setred.fit-190"><a href="#Setred.fit-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span>
</span><span id="Setred.fit-191"><a href="#Setred.fit-191"><span class="linenos">191</span></a>
</span><span id="Setred.fit-192"><a href="#Setred.fit-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwars</span><span class="p">)</span>
</span><span id="Setred.fit-193"><a href="#Setred.fit-193"><span class="linenos">193</span></a>
</span><span id="Setred.fit-194"><a href="#Setred.fit-194"><span class="linenos">194</span></a>        <span class="n">y_probabilities</span> <span class="o">=</span> <span class="n">calculate_prior_probability</span><span class="p">(</span>
</span><span id="Setred.fit-195"><a href="#Setred.fit-195"><span class="linenos">195</span></a>            <span class="n">y_label</span>
</span><span id="Setred.fit-196"><a href="#Setred.fit-196"><span class="linenos">196</span></a>        <span class="p">)</span>  <span class="c1"># Should probabilities change every iteration or may it keep with the first L?</span>
</span><span id="Setred.fit-197"><a href="#Setred.fit-197"><span class="linenos">197</span></a>
</span><span id="Setred.fit-198"><a href="#Setred.fit-198"><span class="linenos">198</span></a>        <span class="n">sort_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="Setred.fit-199"><a href="#Setred.fit-199"><span class="linenos">199</span></a>
</span><span id="Setred.fit-200"><a href="#Setred.fit-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Setred.fit-201"><a href="#Setred.fit-201"><span class="linenos">201</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Setred.fit-202"><a href="#Setred.fit-202"><span class="linenos">202</span></a>
</span><span id="Setred.fit-203"><a href="#Setred.fit-203"><span class="linenos">203</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">):</span>
</span><span id="Setred.fit-204"><a href="#Setred.fit-204"><span class="linenos">204</span></a>            <span class="n">U_</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span>
</span><span id="Setred.fit-205"><a href="#Setred.fit-205"><span class="linenos">205</span></a>                <span class="n">X_unlabel</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">pool</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
</span><span id="Setred.fit-206"><a href="#Setred.fit-206"><span class="linenos">206</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-207"><a href="#Setred.fit-207"><span class="linenos">207</span></a>
</span><span id="Setred.fit-208"><a href="#Setred.fit-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-209"><a href="#Setred.fit-209"><span class="linenos">209</span></a>                <span class="n">U_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">U_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_label</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="Setred.fit-210"><a href="#Setred.fit-210"><span class="linenos">210</span></a>
</span><span id="Setred.fit-211"><a href="#Setred.fit-211"><span class="linenos">211</span></a>            <span class="n">raw_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">U_</span><span class="p">)</span>
</span><span id="Setred.fit-212"><a href="#Setred.fit-212"><span class="linenos">212</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-213"><a href="#Setred.fit-213"><span class="linenos">213</span></a>            <span class="n">class_predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-214"><a href="#Setred.fit-214"><span class="linenos">214</span></a>            <span class="c1"># Unless a better understanding is given, only the size of L will be used as maximal size of the candidate set.</span>
</span><span id="Setred.fit-215"><a href="#Setred.fit-215"><span class="linenos">215</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="n">each_iteration_candidates</span><span class="p">:]</span>
</span><span id="Setred.fit-216"><a href="#Setred.fit-216"><span class="linenos">216</span></a>
</span><span id="Setred.fit-217"><a href="#Setred.fit-217"><span class="linenos">217</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-218"><a href="#Setred.fit-218"><span class="linenos">218</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred.fit-219"><a href="#Setred.fit-219"><span class="linenos">219</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-220"><a href="#Setred.fit-220"><span class="linenos">220</span></a>                <span class="n">L_</span> <span class="o">=</span> <span class="n">U_</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
</span><span id="Setred.fit-221"><a href="#Setred.fit-221"><span class="linenos">221</span></a>            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="Setred.fit-222"><a href="#Setred.fit-222"><span class="linenos">222</span></a>                <span class="nb">list</span><span class="p">(</span>
</span><span id="Setred.fit-223"><a href="#Setred.fit-223"><span class="linenos">223</span></a>                    <span class="nb">map</span><span class="p">(</span>
</span><span id="Setred.fit-224"><a href="#Setred.fit-224"><span class="linenos">224</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="n">x</span><span class="p">],</span>
</span><span id="Setred.fit-225"><a href="#Setred.fit-225"><span class="linenos">225</span></a>                        <span class="n">class_predicted</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span>
</span><span id="Setred.fit-226"><a href="#Setred.fit-226"><span class="linenos">226</span></a>                    <span class="p">)</span>
</span><span id="Setred.fit-227"><a href="#Setred.fit-227"><span class="linenos">227</span></a>                <span class="p">)</span>
</span><span id="Setred.fit-228"><a href="#Setred.fit-228"><span class="linenos">228</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-229"><a href="#Setred.fit-229"><span class="linenos">229</span></a>
</span><span id="Setred.fit-230"><a href="#Setred.fit-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-231"><a href="#Setred.fit-231"><span class="linenos">231</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">])</span>
</span><span id="Setred.fit-232"><a href="#Setred.fit-232"><span class="linenos">232</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-233"><a href="#Setred.fit-233"><span class="linenos">233</span></a>                <span class="n">pre_L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-234"><a href="#Setred.fit-234"><span class="linenos">234</span></a>
</span><span id="Setred.fit-235"><a href="#Setred.fit-235"><span class="linenos">235</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__create_neighborhood</span><span class="p">(</span><span class="n">pre_L</span><span class="p">)</span>
</span><span id="Setred.fit-236"><a href="#Setred.fit-236"><span class="linenos">236</span></a>            <span class="c1">#  Keep only weights for L_</span>
</span><span id="Setred.fit-237"><a href="#Setred.fit-237"><span class="linenos">237</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="n">L_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:,</span> <span class="p">:]</span>
</span><span id="Setred.fit-238"><a href="#Setred.fit-238"><span class="linenos">238</span></a>
</span><span id="Setred.fit-239"><a href="#Setred.fit-239"><span class="linenos">239</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">y_</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="n">sort_idx</span><span class="p">)</span>
</span><span id="Setred.fit-240"><a href="#Setred.fit-240"><span class="linenos">240</span></a>            <span class="n">p_wrong</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">y_probabilities</span><span class="o">.</span><span class="n">values</span><span class="p">())))[</span><span class="n">sort_idx</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
</span><span id="Setred.fit-241"><a href="#Setred.fit-241"><span class="linenos">241</span></a>            <span class="c1">#  Must weights be the inverse of distance?</span>
</span><span id="Setred.fit-242"><a href="#Setred.fit-242"><span class="linenos">242</span></a>            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">weights</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-243"><a href="#Setred.fit-243"><span class="linenos">243</span></a>
</span><span id="Setred.fit-244"><a href="#Setred.fit-244"><span class="linenos">244</span></a>            <span class="n">weights_sum</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-245"><a href="#Setred.fit-245"><span class="linenos">245</span></a>            <span class="n">weights_square_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-246"><a href="#Setred.fit-246"><span class="linenos">246</span></a>
</span><span id="Setred.fit-247"><a href="#Setred.fit-247"><span class="linenos">247</span></a>            <span class="n">iid_random</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span>
</span><span id="Setred.fit-248"><a href="#Setred.fit-248"><span class="linenos">248</span></a>                <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">p_wrong</span><span class="p">,</span> <span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Setred.fit-249"><a href="#Setred.fit-249"><span class="linenos">249</span></a>            <span class="p">)</span>
</span><span id="Setred.fit-250"><a href="#Setred.fit-250"><span class="linenos">250</span></a>            <span class="n">ji</span> <span class="o">=</span> <span class="p">(</span><span class="n">iid_random</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Setred.fit-251"><a href="#Setred.fit-251"><span class="linenos">251</span></a>
</span><span id="Setred.fit-252"><a href="#Setred.fit-252"><span class="linenos">252</span></a>            <span class="n">mu_h0</span> <span class="o">=</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_sum</span>
</span><span id="Setred.fit-253"><a href="#Setred.fit-253"><span class="linenos">253</span></a>            <span class="n">sigma_h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_wrong</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_wrong</span> <span class="o">*</span> <span class="n">weights_square_sum</span><span class="p">)</span>
</span><span id="Setred.fit-254"><a href="#Setred.fit-254"><span class="linenos">254</span></a>            
</span><span id="Setred.fit-255"><a href="#Setred.fit-255"><span class="linenos">255</span></a>            <span class="n">z_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">((</span><span class="n">ji</span> <span class="o">-</span> <span class="n">mu_h0</span><span class="p">),</span> <span class="n">sigma_h0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sigma_h0</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">sigma_h0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-256"><a href="#Setred.fit-256"><span class="linenos">256</span></a>            <span class="c1"># z_score = (ji - mu_h0) / sigma_h0</span>
</span><span id="Setred.fit-257"><a href="#Setred.fit-257"><span class="linenos">257</span></a>            
</span><span id="Setred.fit-258"><a href="#Setred.fit-258"><span class="linenos">258</span></a>            <span class="n">oi</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">),</span> <span class="n">mu_h0</span><span class="p">,</span> <span class="n">sigma_h0</span><span class="p">)</span>
</span><span id="Setred.fit-259"><a href="#Setred.fit-259"><span class="linenos">259</span></a>            <span class="n">to_add</span> <span class="o">=</span> <span class="p">(</span><span class="n">oi</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejection_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="n">mu_h0</span><span class="p">)</span>
</span><span id="Setred.fit-260"><a href="#Setred.fit-260"><span class="linenos">260</span></a>
</span><span id="Setred.fit-261"><a href="#Setred.fit-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-262"><a href="#Setred.fit-262"><span class="linenos">262</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred.fit-263"><a href="#Setred.fit-263"><span class="linenos">263</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-264"><a href="#Setred.fit-264"><span class="linenos">264</span></a>                <span class="n">L_filtered</span> <span class="o">=</span> <span class="n">L_</span><span class="p">[</span><span class="n">to_add</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Setred.fit-265"><a href="#Setred.fit-265"><span class="linenos">265</span></a>            <span class="n">y_filtered</span> <span class="o">=</span> <span class="n">y_</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred.fit-266"><a href="#Setred.fit-266"><span class="linenos">266</span></a>            
</span><span id="Setred.fit-267"><a href="#Setred.fit-267"><span class="linenos">267</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-268"><a href="#Setred.fit-268"><span class="linenos">268</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">])</span>
</span><span id="Setred.fit-269"><a href="#Setred.fit-269"><span class="linenos">269</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-270"><a href="#Setred.fit-270"><span class="linenos">270</span></a>                <span class="n">X_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">L_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-271"><a href="#Setred.fit-271"><span class="linenos">271</span></a>            <span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-272"><a href="#Setred.fit-272"><span class="linenos">272</span></a>
</span><span id="Setred.fit-273"><a href="#Setred.fit-273"><span class="linenos">273</span></a>            <span class="c1">#  Remove the instances from the unlabeled set.</span>
</span><span id="Setred.fit-274"><a href="#Setred.fit-274"><span class="linenos">274</span></a>            <span class="n">to_delete</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">to_add</span><span class="p">]</span>
</span><span id="Setred.fit-275"><a href="#Setred.fit-275"><span class="linenos">275</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="Setred.fit-276"><a href="#Setred.fit-276"><span class="linenos">276</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">to_delete</span><span class="p">])</span>
</span><span id="Setred.fit-277"><a href="#Setred.fit-277"><span class="linenos">277</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Setred.fit-278"><a href="#Setred.fit-278"><span class="linenos">278</span></a>                <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X_unlabel</span><span class="p">,</span> <span class="n">to_delete</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Setred.fit-279"><a href="#Setred.fit-279"><span class="linenos">279</span></a>
</span><span id="Setred.fit-280"><a href="#Setred.fit-280"><span class="linenos">280</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a Setred classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabeled.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (Setred):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="Setred.predict" class="classattr">
                                        <input id="Setred.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.predict-282"><a href="#Setred.predict-282"><span class="linenos">282</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred.predict-283"><a href="#Setred.predict-283"><span class="linenos">283</span></a>        <span class="sd">&quot;&quot;&quot;Predict class value for X.</span>
</span><span id="Setred.predict-284"><a href="#Setred.predict-284"><span class="linenos">284</span></a><span class="sd">        For a classification model, the predicted class for each sample in X is returned.</span>
</span><span id="Setred.predict-285"><a href="#Setred.predict-285"><span class="linenos">285</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.predict-286"><a href="#Setred.predict-286"><span class="linenos">286</span></a><span class="sd">        ----------</span>
</span><span id="Setred.predict-287"><a href="#Setred.predict-287"><span class="linenos">287</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.predict-288"><a href="#Setred.predict-288"><span class="linenos">288</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred.predict-289"><a href="#Setred.predict-289"><span class="linenos">289</span></a><span class="sd">        Returns</span>
</span><span id="Setred.predict-290"><a href="#Setred.predict-290"><span class="linenos">290</span></a><span class="sd">        -------</span>
</span><span id="Setred.predict-291"><a href="#Setred.predict-291"><span class="linenos">291</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="Setred.predict-292"><a href="#Setred.predict-292"><span class="linenos">292</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred.predict-293"><a href="#Setred.predict-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.predict-294"><a href="#Setred.predict-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class value for X.
For a classification model, the predicted class for each sample in X is returned.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="Setred.predict_proba" class="classattr">
                                        <input id="Setred.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Setred.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Setred.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Setred.predict_proba-296"><a href="#Setred.predict_proba-296"><span class="linenos">296</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="Setred.predict_proba-297"><a href="#Setred.predict_proba-297"><span class="linenos">297</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities of the input samples X.</span>
</span><span id="Setred.predict_proba-298"><a href="#Setred.predict_proba-298"><span class="linenos">298</span></a><span class="sd">        The predicted class probability depends on the ensemble estimator.</span>
</span><span id="Setred.predict_proba-299"><a href="#Setred.predict_proba-299"><span class="linenos">299</span></a><span class="sd">        Parameters</span>
</span><span id="Setred.predict_proba-300"><a href="#Setred.predict_proba-300"><span class="linenos">300</span></a><span class="sd">        ----------</span>
</span><span id="Setred.predict_proba-301"><a href="#Setred.predict_proba-301"><span class="linenos">301</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="Setred.predict_proba-302"><a href="#Setred.predict_proba-302"><span class="linenos">302</span></a><span class="sd">            The input samples.</span>
</span><span id="Setred.predict_proba-303"><a href="#Setred.predict_proba-303"><span class="linenos">303</span></a><span class="sd">        Returns</span>
</span><span id="Setred.predict_proba-304"><a href="#Setred.predict_proba-304"><span class="linenos">304</span></a><span class="sd">        -------</span>
</span><span id="Setred.predict_proba-305"><a href="#Setred.predict_proba-305"><span class="linenos">305</span></a><span class="sd">        y : ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1</span>
</span><span id="Setred.predict_proba-306"><a href="#Setred.predict_proba-306"><span class="linenos">306</span></a><span class="sd">            The predicted classes</span>
</span><span id="Setred.predict_proba-307"><a href="#Setred.predict_proba-307"><span class="linenos">307</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Setred.predict_proba-308"><a href="#Setred.predict_proba-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_base_estimator</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class probabilities of the input samples X.
The predicted class probability depends on the ensemble estimator.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The input samples.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>y</strong> (ndarray of shape (n_samples, n_classes) or list of n_outputs such arrays if n_outputs &gt; 1):
The predicted classes</li>
</ul>
</div>


                            </div>
                            <div id="Setred.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Setred.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="Setred.score" class="function">score</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="Setred.get_params" class="function">get_params</dd>
                <dd id="Setred.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="Setred.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CoForest">
                            <input id="CoForest-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CoForest</span><wbr>(<span class="base">sslearn.wrapper._co.BaseCoTraining</span>):

                <label class="view-source-button" for="CoForest-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest-1040"><a href="#CoForest-1040"><span class="linenos">1040</span></a><span class="k">class</span> <span class="nc">CoForest</span><span class="p">(</span><span class="n">BaseCoTraining</span><span class="p">):</span>
</span><span id="CoForest-1041"><a href="#CoForest-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.3&quot;</span><span class="p">):</span>
</span><span id="CoForest-1042"><a href="#CoForest-1042"><span class="linenos">1042</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoForest-1043"><a href="#CoForest-1043"><span class="linenos">1043</span></a><span class="sd">        Generate a CoForest classifier.</span>
</span><span id="CoForest-1044"><a href="#CoForest-1044"><span class="linenos">1044</span></a><span class="sd">        A SSL Random Forest adaption for CoTraining. </span>
</span><span id="CoForest-1045"><a href="#CoForest-1045"><span class="linenos">1045</span></a>
</span><span id="CoForest-1046"><a href="#CoForest-1046"><span class="linenos">1046</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest-1047"><a href="#CoForest-1047"><span class="linenos">1047</span></a><span class="sd">        ----------</span>
</span><span id="CoForest-1048"><a href="#CoForest-1048"><span class="linenos">1048</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoForest-1049"><a href="#CoForest-1049"><span class="linenos">1049</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="CoForest-1050"><a href="#CoForest-1050"><span class="linenos">1050</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="CoForest-1051"><a href="#CoForest-1051"><span class="linenos">1051</span></a><span class="sd">            The number of base estimators in the ensemble., by default 7</span>
</span><span id="CoForest-1052"><a href="#CoForest-1052"><span class="linenos">1052</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoForest-1053"><a href="#CoForest-1053"><span class="linenos">1053</span></a><span class="sd">            The decision threshold. Should be in [0, 1)., by default 0.5</span>
</span><span id="CoForest-1054"><a href="#CoForest-1054"><span class="linenos">1054</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="CoForest-1055"><a href="#CoForest-1055"><span class="linenos">1055</span></a><span class="sd">            The number of jobs to run in parallel for both fit and predict., by default None</span>
</span><span id="CoForest-1056"><a href="#CoForest-1056"><span class="linenos">1056</span></a><span class="sd">        bootstrap : bool, optional</span>
</span><span id="CoForest-1057"><a href="#CoForest-1057"><span class="linenos">1057</span></a><span class="sd">            Whether bootstrap samples are used when building estimators., by default True</span>
</span><span id="CoForest-1058"><a href="#CoForest-1058"><span class="linenos">1058</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoForest-1059"><a href="#CoForest-1059"><span class="linenos">1059</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoForest-1060"><a href="#CoForest-1060"><span class="linenos">1060</span></a><span class="sd">        **kwards : dict, optional</span>
</span><span id="CoForest-1061"><a href="#CoForest-1061"><span class="linenos">1061</span></a><span class="sd">            Additional parameters to be passed to base_estimator, by default None.</span>
</span><span id="CoForest-1062"><a href="#CoForest-1062"><span class="linenos">1062</span></a>
</span><span id="CoForest-1063"><a href="#CoForest-1063"><span class="linenos">1063</span></a><span class="sd">        References</span>
</span><span id="CoForest-1064"><a href="#CoForest-1064"><span class="linenos">1064</span></a><span class="sd">        ----------</span>
</span><span id="CoForest-1065"><a href="#CoForest-1065"><span class="linenos">1065</span></a><span class="sd">        Li, M., &amp; Zhou, Z.-H. (2007).</span>
</span><span id="CoForest-1066"><a href="#CoForest-1066"><span class="linenos">1066</span></a><span class="sd">        Improve Computer-Aided Diagnosis With Machine Learning Techniques Using Undiagnosed Samples.</span>
</span><span id="CoForest-1067"><a href="#CoForest-1067"><span class="linenos">1067</span></a><span class="sd">        &lt;i&gt;IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans&lt;/i&gt;,</span>
</span><span id="CoForest-1068"><a href="#CoForest-1068"><span class="linenos">1068</span></a><span class="sd">        37(6), 1088-1098. doi:10.1109/tsmca.2007.904745</span>
</span><span id="CoForest-1069"><a href="#CoForest-1069"><span class="linenos">1069</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest-1070"><a href="#CoForest-1070"><span class="linenos">1070</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest-1071"><a href="#CoForest-1071"><span class="linenos">1071</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="CoForest-1072"><a href="#CoForest-1072"><span class="linenos">1072</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoForest-1073"><a href="#CoForest-1073"><span class="linenos">1073</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">bootstrap</span>
</span><span id="CoForest-1074"><a href="#CoForest-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="CoForest-1075"><a href="#CoForest-1075"><span class="linenos">1075</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="CoForest-1076"><a href="#CoForest-1076"><span class="linenos">1076</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoForest-1077"><a href="#CoForest-1077"><span class="linenos">1077</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
</span><span id="CoForest-1078"><a href="#CoForest-1078"><span class="linenos">1078</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest-1079"><a href="#CoForest-1079"><span class="linenos">1079</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The version 1.0.2 is deprecated. Please use the version 1.0.3&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
</span><span id="CoForest-1080"><a href="#CoForest-1080"><span class="linenos">1080</span></a>
</span><span id="CoForest-1081"><a href="#CoForest-1081"><span class="linenos">1081</span></a>    <span class="k">def</span> <span class="nf">__bootstraping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r_state</span><span class="p">):</span>
</span><span id="CoForest-1082"><a href="#CoForest-1082"><span class="linenos">1082</span></a>        <span class="c1"># It is necessary to bootstrap the data</span>
</span><span id="CoForest-1083"><a href="#CoForest-1083"><span class="linenos">1083</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.3&quot;</span><span class="p">:</span>
</span><span id="CoForest-1084"><a href="#CoForest-1084"><span class="linenos">1084</span></a>            <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest-1085"><a href="#CoForest-1085"><span class="linenos">1085</span></a>            <span class="n">columns</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CoForest-1086"><a href="#CoForest-1086"><span class="linenos">1086</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1087"><a href="#CoForest-1087"><span class="linenos">1087</span></a>                <span class="n">columns</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
</span><span id="CoForest-1088"><a href="#CoForest-1088"><span class="linenos">1088</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="CoForest-1089"><a href="#CoForest-1089"><span class="linenos">1089</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="CoForest-1090"><a href="#CoForest-1090"><span class="linenos">1090</span></a>            <span class="c1"># Get a reprentation of each class</span>
</span><span id="CoForest-1091"><a href="#CoForest-1091"><span class="linenos">1091</span></a>            <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CoForest-1092"><a href="#CoForest-1092"><span class="linenos">1092</span></a>            <span class="c1"># Choose at least one sample from each class</span>
</span><span id="CoForest-1093"><a href="#CoForest-1093"><span class="linenos">1093</span></a>            <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="CoForest-1094"><a href="#CoForest-1094"><span class="linenos">1094</span></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">:</span>
</span><span id="CoForest-1095"><a href="#CoForest-1095"><span class="linenos">1095</span></a>                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">c</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CoForest-1096"><a href="#CoForest-1096"><span class="linenos">1096</span></a>                <span class="c1"># Choose one sample from each class</span>
</span><span id="CoForest-1097"><a href="#CoForest-1097"><span class="linenos">1097</span></a>                <span class="n">X_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:])</span>
</span><span id="CoForest-1098"><a href="#CoForest-1098"><span class="linenos">1098</span></a>                <span class="n">y_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="CoForest-1099"><a href="#CoForest-1099"><span class="linenos">1099</span></a>                <span class="c1"># Remove the sample from the original data</span>
</span><span id="CoForest-1100"><a href="#CoForest-1100"><span class="linenos">1100</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1101"><a href="#CoForest-1101"><span class="linenos">1101</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1102"><a href="#CoForest-1102"><span class="linenos">1102</span></a>            <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">r_state</span><span class="p">)</span>
</span><span id="CoForest-1103"><a href="#CoForest-1103"><span class="linenos">1103</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_label</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1104"><a href="#CoForest-1104"><span class="linenos">1104</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_label</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1105"><a href="#CoForest-1105"><span class="linenos">1105</span></a>            <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1106"><a href="#CoForest-1106"><span class="linenos">1106</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</span><span id="CoForest-1107"><a href="#CoForest-1107"><span class="linenos">1107</span></a>        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</span><span id="CoForest-1108"><a href="#CoForest-1108"><span class="linenos">1108</span></a>
</span><span id="CoForest-1109"><a href="#CoForest-1109"><span class="linenos">1109</span></a>    <span class="k">def</span> <span class="nf">__estimate_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hypothesis</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="CoForest-1110"><a href="#CoForest-1110"><span class="linenos">1110</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.3&quot;</span><span class="p">:</span>
</span><span id="CoForest-1111"><a href="#CoForest-1111"><span class="linenos">1111</span></a>            <span class="n">concomitants</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">]</span>
</span><span id="CoForest-1112"><a href="#CoForest-1112"><span class="linenos">1112</span></a>            <span class="n">predicted</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">concomitants</span><span class="p">]</span>
</span><span id="CoForest-1113"><a href="#CoForest-1113"><span class="linenos">1113</span></a>            <span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoForest-1114"><a href="#CoForest-1114"><span class="linenos">1114</span></a>            <span class="c1"># Get the majority vote</span>
</span><span id="CoForest-1115"><a href="#CoForest-1115"><span class="linenos">1115</span></a>            <span class="n">predicted</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1116"><a href="#CoForest-1116"><span class="linenos">1116</span></a>            <span class="c1"># predicted, _ = st.mode(predicted, axis=1)</span>
</span><span id="CoForest-1117"><a href="#CoForest-1117"><span class="linenos">1117</span></a>            <span class="c1"># Get the error rate</span>
</span><span id="CoForest-1118"><a href="#CoForest-1118"><span class="linenos">1118</span></a>            <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1119"><a href="#CoForest-1119"><span class="linenos">1119</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1120"><a href="#CoForest-1120"><span class="linenos">1120</span></a>            <span class="n">probas</span> <span class="o">=</span> <span class="n">hypothesis</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="CoForest-1121"><a href="#CoForest-1121"><span class="linenos">1121</span></a>            <span class="n">ei_t</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="CoForest-1122"><a href="#CoForest-1122"><span class="linenos">1122</span></a>            <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hypothesis</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</span><span id="CoForest-1123"><a href="#CoForest-1123"><span class="linenos">1123</span></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="CoForest-1124"><a href="#CoForest-1124"><span class="linenos">1124</span></a>                <span class="n">true_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
</span><span id="CoForest-1125"><a href="#CoForest-1125"><span class="linenos">1125</span></a>                <span class="n">true_y_index</span> <span class="o">=</span> <span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">true_y</span><span class="p">)</span>
</span><span id="CoForest-1126"><a href="#CoForest-1126"><span class="linenos">1126</span></a>                <span class="n">ei_t</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">probas</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">true_y_index</span><span class="p">]</span>
</span><span id="CoForest-1127"><a href="#CoForest-1127"><span class="linenos">1127</span></a>            <span class="k">if</span> <span class="n">ei_t</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CoForest-1128"><a href="#CoForest-1128"><span class="linenos">1128</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span>
</span><span id="CoForest-1129"><a href="#CoForest-1129"><span class="linenos">1129</span></a>            <span class="k">return</span> <span class="n">ei_t</span>
</span><span id="CoForest-1130"><a href="#CoForest-1130"><span class="linenos">1130</span></a>
</span><span id="CoForest-1131"><a href="#CoForest-1131"><span class="linenos">1131</span></a>    <span class="k">def</span> <span class="nf">__confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h_index</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="CoForest-1132"><a href="#CoForest-1132"><span class="linenos">1132</span></a>        <span class="n">concomitants</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">h_index</span><span class="p">]</span>
</span><span id="CoForest-1133"><a href="#CoForest-1133"><span class="linenos">1133</span></a>
</span><span id="CoForest-1134"><a href="#CoForest-1134"><span class="linenos">1134</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">concomitants</span><span class="p">]</span>
</span><span id="CoForest-1135"><a href="#CoForest-1135"><span class="linenos">1135</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">predicted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="CoForest-1136"><a href="#CoForest-1136"><span class="linenos">1136</span></a>        <span class="c1"># Get the majority vote and the number of votes</span>
</span><span id="CoForest-1137"><a href="#CoForest-1137"><span class="linenos">1137</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">mode</span><span class="p">(</span><span class="n">predicted</span><span class="p">)</span>
</span><span id="CoForest-1138"><a href="#CoForest-1138"><span class="linenos">1138</span></a>        <span class="c1"># _, counts = st.mode(predicted, axis=1)</span>
</span><span id="CoForest-1139"><a href="#CoForest-1139"><span class="linenos">1139</span></a>        <span class="n">confidences</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">concomitants</span><span class="p">)</span>
</span><span id="CoForest-1140"><a href="#CoForest-1140"><span class="linenos">1140</span></a>        <span class="k">return</span> <span class="n">confidences</span>
</span><span id="CoForest-1141"><a href="#CoForest-1141"><span class="linenos">1141</span></a>
</span><span id="CoForest-1142"><a href="#CoForest-1142"><span class="linenos">1142</span></a>    <span class="k">def</span> <span class="nf">_fit_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest-1143"><a href="#CoForest-1143"><span class="linenos">1143</span></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span>
</span><span id="CoForest-1144"><a href="#CoForest-1144"><span class="linenos">1144</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="CoForest-1145"><a href="#CoForest-1145"><span class="linenos">1145</span></a>            <span class="n">estimator</span> <span class="o">=</span> <span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="CoForest-1146"><a href="#CoForest-1146"><span class="linenos">1146</span></a>
</span><span id="CoForest-1147"><a href="#CoForest-1147"><span class="linenos">1147</span></a>        <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">():</span>
</span><span id="CoForest-1148"><a href="#CoForest-1148"><span class="linenos">1148</span></a>            <span class="n">r_state</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="CoForest-1149"><a href="#CoForest-1149"><span class="linenos">1149</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1150"><a href="#CoForest-1150"><span class="linenos">1150</span></a>            <span class="n">r_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="CoForest-1151"><a href="#CoForest-1151"><span class="linenos">1151</span></a>            <span class="k">if</span> <span class="n">r_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CoForest-1152"><a href="#CoForest-1152"><span class="linenos">1152</span></a>                <span class="n">r_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="CoForest-1153"><a href="#CoForest-1153"><span class="linenos">1153</span></a>            <span class="n">r_state</span> <span class="o">+=</span> <span class="n">i</span>
</span><span id="CoForest-1154"><a href="#CoForest-1154"><span class="linenos">1154</span></a>        <span class="c1"># Only in the beginning</span>
</span><span id="CoForest-1155"><a href="#CoForest-1155"><span class="linenos">1155</span></a>        <span class="k">if</span> <span class="n">beginning</span><span class="p">:</span>
</span><span id="CoForest-1156"><a href="#CoForest-1156"><span class="linenos">1156</span></a>            <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__bootstraping</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r_state</span><span class="p">)</span>
</span><span id="CoForest-1157"><a href="#CoForest-1157"><span class="linenos">1157</span></a>
</span><span id="CoForest-1158"><a href="#CoForest-1158"><span class="linenos">1158</span></a>        <span class="k">return</span> <span class="n">skclone</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest-1159"><a href="#CoForest-1159"><span class="linenos">1159</span></a>
</span><span id="CoForest-1160"><a href="#CoForest-1160"><span class="linenos">1160</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest-1161"><a href="#CoForest-1161"><span class="linenos">1161</span></a>        <span class="sd">&quot;&quot;&quot;Build a CoForest classifier from the training set (X, y).</span>
</span><span id="CoForest-1162"><a href="#CoForest-1162"><span class="linenos">1162</span></a>
</span><span id="CoForest-1163"><a href="#CoForest-1163"><span class="linenos">1163</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest-1164"><a href="#CoForest-1164"><span class="linenos">1164</span></a><span class="sd">        ----------</span>
</span><span id="CoForest-1165"><a href="#CoForest-1165"><span class="linenos">1165</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoForest-1166"><a href="#CoForest-1166"><span class="linenos">1166</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoForest-1167"><a href="#CoForest-1167"><span class="linenos">1167</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoForest-1168"><a href="#CoForest-1168"><span class="linenos">1168</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoForest-1169"><a href="#CoForest-1169"><span class="linenos">1169</span></a>
</span><span id="CoForest-1170"><a href="#CoForest-1170"><span class="linenos">1170</span></a><span class="sd">        Returns</span>
</span><span id="CoForest-1171"><a href="#CoForest-1171"><span class="linenos">1171</span></a><span class="sd">        -------</span>
</span><span id="CoForest-1172"><a href="#CoForest-1172"><span class="linenos">1172</span></a><span class="sd">        self: CoForest</span>
</span><span id="CoForest-1173"><a href="#CoForest-1173"><span class="linenos">1173</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoForest-1174"><a href="#CoForest-1174"><span class="linenos">1174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest-1175"><a href="#CoForest-1175"><span class="linenos">1175</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoForest-1176"><a href="#CoForest-1176"><span class="linenos">1176</span></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="CoForest-1177"><a href="#CoForest-1177"><span class="linenos">1177</span></a>
</span><span id="CoForest-1178"><a href="#CoForest-1178"><span class="linenos">1178</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoForest-1179"><a href="#CoForest-1179"><span class="linenos">1179</span></a>
</span><span id="CoForest-1180"><a href="#CoForest-1180"><span class="linenos">1180</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest-1181"><a href="#CoForest-1181"><span class="linenos">1181</span></a>
</span><span id="CoForest-1182"><a href="#CoForest-1182"><span class="linenos">1182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoForest-1183"><a href="#CoForest-1183"><span class="linenos">1183</span></a>
</span><span id="CoForest-1184"><a href="#CoForest-1184"><span class="linenos">1184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1185"><a href="#CoForest-1185"><span class="linenos">1185</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1186"><a href="#CoForest-1186"><span class="linenos">1186</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest-1187"><a href="#CoForest-1187"><span class="linenos">1187</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1188"><a href="#CoForest-1188"><span class="linenos">1188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="CoForest-1189"><a href="#CoForest-1189"><span class="linenos">1189</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="CoForest-1190"><a href="#CoForest-1190"><span class="linenos">1190</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="CoForest-1191"><a href="#CoForest-1191"><span class="linenos">1191</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="CoForest-1192"><a href="#CoForest-1192"><span class="linenos">1192</span></a>
</span><span id="CoForest-1193"><a href="#CoForest-1193"><span class="linenos">1193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="CoForest-1194"><a href="#CoForest-1194"><span class="linenos">1194</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest-1195"><a href="#CoForest-1195"><span class="linenos">1195</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest-1196"><a href="#CoForest-1196"><span class="linenos">1196</span></a>        <span class="p">)</span>
</span><span id="CoForest-1197"><a href="#CoForest-1197"><span class="linenos">1197</span></a>
</span><span id="CoForest-1198"><a href="#CoForest-1198"><span class="linenos">1198</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1199"><a href="#CoForest-1199"><span class="linenos">1199</span></a>            <span class="c1"># The paper stablishes that the weight of each hypothesis is 0,</span>
</span><span id="CoForest-1200"><a href="#CoForest-1200"><span class="linenos">1200</span></a>            <span class="c1"># but it is not possible to do that because it will be impossible increase the training set</span>
</span><span id="CoForest-1201"><a href="#CoForest-1201"><span class="linenos">1201</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest-1202"><a href="#CoForest-1202"><span class="linenos">1202</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_label</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># Version 1.0.2</span>
</span><span id="CoForest-1203"><a href="#CoForest-1203"><span class="linenos">1203</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1204"><a href="#CoForest-1204"><span class="linenos">1204</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__confidence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X_label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="CoForest-1205"><a href="#CoForest-1205"><span class="linenos">1205</span></a>
</span><span id="CoForest-1206"><a href="#CoForest-1206"><span class="linenos">1206</span></a>        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="CoForest-1207"><a href="#CoForest-1207"><span class="linenos">1207</span></a>        <span class="k">while</span> <span class="n">changing</span><span class="p">:</span>
</span><span id="CoForest-1208"><a href="#CoForest-1208"><span class="linenos">1208</span></a>            <span class="n">changing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CoForest-1209"><a href="#CoForest-1209"><span class="linenos">1209</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest-1210"><a href="#CoForest-1210"><span class="linenos">1210</span></a>                <span class="n">hi</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">wi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CoForest-1211"><a href="#CoForest-1211"><span class="linenos">1211</span></a>
</span><span id="CoForest-1212"><a href="#CoForest-1212"><span class="linenos">1212</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__estimate_error</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="CoForest-1213"><a href="#CoForest-1213"><span class="linenos">1213</span></a>
</span><span id="CoForest-1214"><a href="#CoForest-1214"><span class="linenos">1214</span></a>                <span class="k">if</span> <span class="n">ei_t</span> <span class="o">&lt;</span> <span class="n">ei</span><span class="p">:</span>
</span><span id="CoForest-1215"><a href="#CoForest-1215"><span class="linenos">1215</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="CoForest-1216"><a href="#CoForest-1216"><span class="linenos">1216</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span>
</span><span id="CoForest-1217"><a href="#CoForest-1217"><span class="linenos">1217</span></a>                        <span class="n">random_index_subsample</span>
</span><span id="CoForest-1218"><a href="#CoForest-1218"><span class="linenos">1218</span></a>                    <span class="p">)</span>
</span><span id="CoForest-1219"><a href="#CoForest-1219"><span class="linenos">1219</span></a>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">random_index_subsample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">safe_division</span><span class="p">(</span><span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">,</span> <span class="n">ei_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">))]</span>
</span><span id="CoForest-1220"><a href="#CoForest-1220"><span class="linenos">1220</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1221"><a href="#CoForest-1221"><span class="linenos">1221</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest-1222"><a href="#CoForest-1222"><span class="linenos">1222</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1223"><a href="#CoForest-1223"><span class="linenos">1223</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest-1224"><a href="#CoForest-1224"><span class="linenos">1224</span></a>
</span><span id="CoForest-1225"><a href="#CoForest-1225"><span class="linenos">1225</span></a>                    <span class="n">raw_predictions</span> <span class="o">=</span> <span class="n">hi</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Ui_t</span><span class="p">)</span>
</span><span id="CoForest-1226"><a href="#CoForest-1226"><span class="linenos">1226</span></a>                    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoForest-1227"><a href="#CoForest-1227"><span class="linenos">1227</span></a>                    <span class="n">class_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest-1228"><a href="#CoForest-1228"><span class="linenos">1228</span></a>
</span><span id="CoForest-1229"><a href="#CoForest-1229"><span class="linenos">1229</span></a>                    <span class="n">to_label</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoForest-1230"><a href="#CoForest-1230"><span class="linenos">1230</span></a>                    <span class="n">wi_t</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="CoForest-1231"><a href="#CoForest-1231"><span class="linenos">1231</span></a>
</span><span id="CoForest-1232"><a href="#CoForest-1232"><span class="linenos">1232</span></a>                    <span class="k">if</span> <span class="n">ei_t</span> <span class="o">*</span> <span class="n">wi_t</span> <span class="o">&lt;</span> <span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">:</span>
</span><span id="CoForest-1233"><a href="#CoForest-1233"><span class="linenos">1233</span></a>                        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoForest-1234"><a href="#CoForest-1234"><span class="linenos">1234</span></a>                        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest-1235"><a href="#CoForest-1235"><span class="linenos">1235</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_label</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoForest-1236"><a href="#CoForest-1236"><span class="linenos">1236</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest-1237"><a href="#CoForest-1237"><span class="linenos">1237</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest-1238"><a href="#CoForest-1238"><span class="linenos">1238</span></a>                        <span class="n">y_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest-1239"><a href="#CoForest-1239"><span class="linenos">1239</span></a>                        <span class="n">hi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CoForest-1240"><a href="#CoForest-1240"><span class="linenos">1240</span></a>                            <span class="n">x_temp</span><span class="p">,</span>
</span><span id="CoForest-1241"><a href="#CoForest-1241"><span class="linenos">1241</span></a>                            <span class="n">y_temp</span><span class="p">,</span>
</span><span id="CoForest-1242"><a href="#CoForest-1242"><span class="linenos">1242</span></a>                            <span class="o">**</span><span class="n">kwards</span>
</span><span id="CoForest-1243"><a href="#CoForest-1243"><span class="linenos">1243</span></a>                        <span class="p">)</span>
</span><span id="CoForest-1244"><a href="#CoForest-1244"><span class="linenos">1244</span></a>
</span><span id="CoForest-1245"><a href="#CoForest-1245"><span class="linenos">1245</span></a>                    <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ei_t</span>
</span><span id="CoForest-1246"><a href="#CoForest-1246"><span class="linenos">1246</span></a>                    <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_t</span>
</span><span id="CoForest-1247"><a href="#CoForest-1247"><span class="linenos">1247</span></a>
</span><span id="CoForest-1248"><a href="#CoForest-1248"><span class="linenos">1248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span>
</span><span id="CoForest-1249"><a href="#CoForest-1249"><span class="linenos">1249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="CoForest-1250"><a href="#CoForest-1250"><span class="linenos">1250</span></a>
</span><span id="CoForest-1251"><a href="#CoForest-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Base class for all estimators in scikit-learn.</p>

<h6 id="notes">Notes</h6>

<p>All estimators should specify all the parameters that can be set
at the class level in their <code><a href="#CoForest.__init__">__init__</a></code> as explicit keyword
arguments (no <code>*args</code> or <code>**kwargs</code>).</p>
</div>


                            <div id="CoForest.__init__" class="classattr">
                                        <input id="CoForest.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CoForest</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>,</span><span class="param">	<span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span>,</span><span class="param">	<span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span>,</span><span class="param">	<span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0.3&#39;</span></span>)</span>

                <label class="view-source-button" for="CoForest.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest.__init__-1041"><a href="#CoForest.__init__-1041"><span class="linenos">1041</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.3&quot;</span><span class="p">):</span>
</span><span id="CoForest.__init__-1042"><a href="#CoForest.__init__-1042"><span class="linenos">1042</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="CoForest.__init__-1043"><a href="#CoForest.__init__-1043"><span class="linenos">1043</span></a><span class="sd">        Generate a CoForest classifier.</span>
</span><span id="CoForest.__init__-1044"><a href="#CoForest.__init__-1044"><span class="linenos">1044</span></a><span class="sd">        A SSL Random Forest adaption for CoTraining. </span>
</span><span id="CoForest.__init__-1045"><a href="#CoForest.__init__-1045"><span class="linenos">1045</span></a>
</span><span id="CoForest.__init__-1046"><a href="#CoForest.__init__-1046"><span class="linenos">1046</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest.__init__-1047"><a href="#CoForest.__init__-1047"><span class="linenos">1047</span></a><span class="sd">        ----------</span>
</span><span id="CoForest.__init__-1048"><a href="#CoForest.__init__-1048"><span class="linenos">1048</span></a><span class="sd">        base_estimator : ClassifierMixin, optional</span>
</span><span id="CoForest.__init__-1049"><a href="#CoForest.__init__-1049"><span class="linenos">1049</span></a><span class="sd">            An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</span>
</span><span id="CoForest.__init__-1050"><a href="#CoForest.__init__-1050"><span class="linenos">1050</span></a><span class="sd">        n_estimators : int, optional</span>
</span><span id="CoForest.__init__-1051"><a href="#CoForest.__init__-1051"><span class="linenos">1051</span></a><span class="sd">            The number of base estimators in the ensemble., by default 7</span>
</span><span id="CoForest.__init__-1052"><a href="#CoForest.__init__-1052"><span class="linenos">1052</span></a><span class="sd">        threshold : float, optional</span>
</span><span id="CoForest.__init__-1053"><a href="#CoForest.__init__-1053"><span class="linenos">1053</span></a><span class="sd">            The decision threshold. Should be in [0, 1)., by default 0.5</span>
</span><span id="CoForest.__init__-1054"><a href="#CoForest.__init__-1054"><span class="linenos">1054</span></a><span class="sd">        n_jobs : int, optional</span>
</span><span id="CoForest.__init__-1055"><a href="#CoForest.__init__-1055"><span class="linenos">1055</span></a><span class="sd">            The number of jobs to run in parallel for both fit and predict., by default None</span>
</span><span id="CoForest.__init__-1056"><a href="#CoForest.__init__-1056"><span class="linenos">1056</span></a><span class="sd">        bootstrap : bool, optional</span>
</span><span id="CoForest.__init__-1057"><a href="#CoForest.__init__-1057"><span class="linenos">1057</span></a><span class="sd">            Whether bootstrap samples are used when building estimators., by default True</span>
</span><span id="CoForest.__init__-1058"><a href="#CoForest.__init__-1058"><span class="linenos">1058</span></a><span class="sd">        random_state : int, RandomState instance, optional</span>
</span><span id="CoForest.__init__-1059"><a href="#CoForest.__init__-1059"><span class="linenos">1059</span></a><span class="sd">            controls the randomness of the estimator, by default None</span>
</span><span id="CoForest.__init__-1060"><a href="#CoForest.__init__-1060"><span class="linenos">1060</span></a><span class="sd">        **kwards : dict, optional</span>
</span><span id="CoForest.__init__-1061"><a href="#CoForest.__init__-1061"><span class="linenos">1061</span></a><span class="sd">            Additional parameters to be passed to base_estimator, by default None.</span>
</span><span id="CoForest.__init__-1062"><a href="#CoForest.__init__-1062"><span class="linenos">1062</span></a>
</span><span id="CoForest.__init__-1063"><a href="#CoForest.__init__-1063"><span class="linenos">1063</span></a><span class="sd">        References</span>
</span><span id="CoForest.__init__-1064"><a href="#CoForest.__init__-1064"><span class="linenos">1064</span></a><span class="sd">        ----------</span>
</span><span id="CoForest.__init__-1065"><a href="#CoForest.__init__-1065"><span class="linenos">1065</span></a><span class="sd">        Li, M., &amp; Zhou, Z.-H. (2007).</span>
</span><span id="CoForest.__init__-1066"><a href="#CoForest.__init__-1066"><span class="linenos">1066</span></a><span class="sd">        Improve Computer-Aided Diagnosis With Machine Learning Techniques Using Undiagnosed Samples.</span>
</span><span id="CoForest.__init__-1067"><a href="#CoForest.__init__-1067"><span class="linenos">1067</span></a><span class="sd">        &lt;i&gt;IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans&lt;/i&gt;,</span>
</span><span id="CoForest.__init__-1068"><a href="#CoForest.__init__-1068"><span class="linenos">1068</span></a><span class="sd">        37(6), 1088-1098. doi:10.1109/tsmca.2007.904745</span>
</span><span id="CoForest.__init__-1069"><a href="#CoForest.__init__-1069"><span class="linenos">1069</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest.__init__-1070"><a href="#CoForest.__init__-1070"><span class="linenos">1070</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="o">=</span> <span class="n">check_classifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">collection_size</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest.__init__-1071"><a href="#CoForest.__init__-1071"><span class="linenos">1071</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="CoForest.__init__-1072"><a href="#CoForest.__init__-1072"><span class="linenos">1072</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
</span><span id="CoForest.__init__-1073"><a href="#CoForest.__init__-1073"><span class="linenos">1073</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">bootstrap</span>
</span><span id="CoForest.__init__-1074"><a href="#CoForest.__init__-1074"><span class="linenos">1074</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span>
</span><span id="CoForest.__init__-1075"><a href="#CoForest.__init__-1075"><span class="linenos">1075</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="CoForest.__init__-1076"><a href="#CoForest.__init__-1076"><span class="linenos">1076</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="CoForest.__init__-1077"><a href="#CoForest.__init__-1077"><span class="linenos">1077</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
</span><span id="CoForest.__init__-1078"><a href="#CoForest.__init__-1078"><span class="linenos">1078</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest.__init__-1079"><a href="#CoForest.__init__-1079"><span class="linenos">1079</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The version 1.0.2 is deprecated. Please use the version 1.0.3&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a CoForest classifier.
A SSL Random Forest adaption for CoTraining. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>base_estimator</strong> (ClassifierMixin, optional):
An estimator object implementing fit and predict_proba, by default DecisionTreeClassifier()</li>
<li><strong>n_estimators</strong> (int, optional):
The number of base estimators in the ensemble., by default 7</li>
<li><strong>threshold</strong> (float, optional):
The decision threshold. Should be in [0, 1)., by default 0.5</li>
<li><strong>n_jobs</strong> (int, optional):
The number of jobs to run in parallel for both fit and predict., by default None</li>
<li><strong>bootstrap</strong> (bool, optional):
Whether bootstrap samples are used when building estimators., by default True</li>
<li><strong>random_state</strong> (int, RandomState instance, optional):
controls the randomness of the estimator, by default None</li>
<li><strong>**kwards</strong> (dict, optional):
Additional parameters to be passed to base_estimator, by default None.</li>
</ul>

<h6 id="references">References</h6>

<p>Li, M., &amp; Zhou, Z.-H. (2007).
Improve Computer-Aided Diagnosis With Machine Learning Techniques Using Undiagnosed Samples.
<i>IEEE Transactions on Systems, Man, and Cybernetics - Part A: Systems and Humans</i>,
37(6), 1088-1098. doi:10.1109/tsmca.2007.904745</p>
</div>


                            </div>
                            <div id="CoForest.fit" class="classattr">
                                        <input id="CoForest.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwards</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CoForest.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CoForest.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CoForest.fit-1160"><a href="#CoForest.fit-1160"><span class="linenos">1160</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">):</span>
</span><span id="CoForest.fit-1161"><a href="#CoForest.fit-1161"><span class="linenos">1161</span></a>        <span class="sd">&quot;&quot;&quot;Build a CoForest classifier from the training set (X, y).</span>
</span><span id="CoForest.fit-1162"><a href="#CoForest.fit-1162"><span class="linenos">1162</span></a>
</span><span id="CoForest.fit-1163"><a href="#CoForest.fit-1163"><span class="linenos">1163</span></a><span class="sd">        Parameters</span>
</span><span id="CoForest.fit-1164"><a href="#CoForest.fit-1164"><span class="linenos">1164</span></a><span class="sd">        ----------</span>
</span><span id="CoForest.fit-1165"><a href="#CoForest.fit-1165"><span class="linenos">1165</span></a><span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
</span><span id="CoForest.fit-1166"><a href="#CoForest.fit-1166"><span class="linenos">1166</span></a><span class="sd">            The training input samples.</span>
</span><span id="CoForest.fit-1167"><a href="#CoForest.fit-1167"><span class="linenos">1167</span></a><span class="sd">        y : array-like of shape (n_samples,)</span>
</span><span id="CoForest.fit-1168"><a href="#CoForest.fit-1168"><span class="linenos">1168</span></a><span class="sd">            The target values (class labels), -1 if unlabel.</span>
</span><span id="CoForest.fit-1169"><a href="#CoForest.fit-1169"><span class="linenos">1169</span></a>
</span><span id="CoForest.fit-1170"><a href="#CoForest.fit-1170"><span class="linenos">1170</span></a><span class="sd">        Returns</span>
</span><span id="CoForest.fit-1171"><a href="#CoForest.fit-1171"><span class="linenos">1171</span></a><span class="sd">        -------</span>
</span><span id="CoForest.fit-1172"><a href="#CoForest.fit-1172"><span class="linenos">1172</span></a><span class="sd">        self: CoForest</span>
</span><span id="CoForest.fit-1173"><a href="#CoForest.fit-1173"><span class="linenos">1173</span></a><span class="sd">            Fitted estimator.</span>
</span><span id="CoForest.fit-1174"><a href="#CoForest.fit-1174"><span class="linenos">1174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CoForest.fit-1175"><a href="#CoForest.fit-1175"><span class="linenos">1175</span></a>        <span class="n">random_state</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="CoForest.fit-1176"><a href="#CoForest.fit-1176"><span class="linenos">1176</span></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">check_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
</span><span id="CoForest.fit-1177"><a href="#CoForest.fit-1177"><span class="linenos">1177</span></a>
</span><span id="CoForest.fit-1178"><a href="#CoForest.fit-1178"><span class="linenos">1178</span></a>        <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">X_unlabel</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="CoForest.fit-1179"><a href="#CoForest.fit-1179"><span class="linenos">1179</span></a>
</span><span id="CoForest.fit-1180"><a href="#CoForest.fit-1180"><span class="linenos">1180</span></a>        <span class="n">is_df</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="CoForest.fit-1181"><a href="#CoForest.fit-1181"><span class="linenos">1181</span></a>
</span><span id="CoForest.fit-1182"><a href="#CoForest.fit-1182"><span class="linenos">1182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
</span><span id="CoForest.fit-1183"><a href="#CoForest.fit-1183"><span class="linenos">1183</span></a>
</span><span id="CoForest.fit-1184"><a href="#CoForest.fit-1184"><span class="linenos">1184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1185"><a href="#CoForest.fit-1185"><span class="linenos">1185</span></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1186"><a href="#CoForest.fit-1186"><span class="linenos">1186</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CoForest.fit-1187"><a href="#CoForest.fit-1187"><span class="linenos">1187</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1188"><a href="#CoForest.fit-1188"><span class="linenos">1188</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">skclone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_estimator</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="CoForest.fit-1189"><a href="#CoForest.fit-1189"><span class="linenos">1189</span></a>            <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="CoForest.fit-1190"><a href="#CoForest.fit-1190"><span class="linenos">1190</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="CoForest.fit-1191"><a href="#CoForest.fit-1191"><span class="linenos">1191</span></a>            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="CoForest.fit-1192"><a href="#CoForest.fit-1192"><span class="linenos">1192</span></a>
</span><span id="CoForest.fit-1193"><a href="#CoForest.fit-1193"><span class="linenos">1193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">)(</span>
</span><span id="CoForest.fit-1194"><a href="#CoForest.fit-1194"><span class="linenos">1194</span></a>            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fit_estimator</span><span class="p">)(</span><span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">beginning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwards</span><span class="p">)</span>
</span><span id="CoForest.fit-1195"><a href="#CoForest.fit-1195"><span class="linenos">1195</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="CoForest.fit-1196"><a href="#CoForest.fit-1196"><span class="linenos">1196</span></a>        <span class="p">)</span>
</span><span id="CoForest.fit-1197"><a href="#CoForest.fit-1197"><span class="linenos">1197</span></a>
</span><span id="CoForest.fit-1198"><a href="#CoForest.fit-1198"><span class="linenos">1198</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1199"><a href="#CoForest.fit-1199"><span class="linenos">1199</span></a>            <span class="c1"># The paper stablishes that the weight of each hypothesis is 0,</span>
</span><span id="CoForest.fit-1200"><a href="#CoForest.fit-1200"><span class="linenos">1200</span></a>            <span class="c1"># but it is not possible to do that because it will be impossible increase the training set</span>
</span><span id="CoForest.fit-1201"><a href="#CoForest.fit-1201"><span class="linenos">1201</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;1.0.2&quot;</span><span class="p">:</span>
</span><span id="CoForest.fit-1202"><a href="#CoForest.fit-1202"><span class="linenos">1202</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_label</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># Version 1.0.2</span>
</span><span id="CoForest.fit-1203"><a href="#CoForest.fit-1203"><span class="linenos">1203</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1204"><a href="#CoForest.fit-1204"><span class="linenos">1204</span></a>                <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__confidence</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X_label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="CoForest.fit-1205"><a href="#CoForest.fit-1205"><span class="linenos">1205</span></a>
</span><span id="CoForest.fit-1206"><a href="#CoForest.fit-1206"><span class="linenos">1206</span></a>        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
</span><span id="CoForest.fit-1207"><a href="#CoForest.fit-1207"><span class="linenos">1207</span></a>        <span class="k">while</span> <span class="n">changing</span><span class="p">:</span>
</span><span id="CoForest.fit-1208"><a href="#CoForest.fit-1208"><span class="linenos">1208</span></a>            <span class="n">changing</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="CoForest.fit-1209"><a href="#CoForest.fit-1209"><span class="linenos">1209</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="CoForest.fit-1210"><a href="#CoForest.fit-1210"><span class="linenos">1210</span></a>                <span class="n">hi</span><span class="p">,</span> <span class="n">ei</span><span class="p">,</span> <span class="n">wi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="CoForest.fit-1211"><a href="#CoForest.fit-1211"><span class="linenos">1211</span></a>
</span><span id="CoForest.fit-1212"><a href="#CoForest.fit-1212"><span class="linenos">1212</span></a>                <span class="n">ei_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__estimate_error</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">X_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="CoForest.fit-1213"><a href="#CoForest.fit-1213"><span class="linenos">1213</span></a>
</span><span id="CoForest.fit-1214"><a href="#CoForest.fit-1214"><span class="linenos">1214</span></a>                <span class="k">if</span> <span class="n">ei_t</span> <span class="o">&lt;</span> <span class="n">ei</span><span class="p">:</span>
</span><span id="CoForest.fit-1215"><a href="#CoForest.fit-1215"><span class="linenos">1215</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X_unlabel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="CoForest.fit-1216"><a href="#CoForest.fit-1216"><span class="linenos">1216</span></a>                    <span class="n">random_index_subsample</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span>
</span><span id="CoForest.fit-1217"><a href="#CoForest.fit-1217"><span class="linenos">1217</span></a>                        <span class="n">random_index_subsample</span>
</span><span id="CoForest.fit-1218"><a href="#CoForest.fit-1218"><span class="linenos">1218</span></a>                    <span class="p">)</span>
</span><span id="CoForest.fit-1219"><a href="#CoForest.fit-1219"><span class="linenos">1219</span></a>                    <span class="n">cond</span> <span class="o">=</span> <span class="n">random_index_subsample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">safe_division</span><span class="p">(</span><span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">,</span> <span class="n">ei_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilon</span><span class="p">))]</span>
</span><span id="CoForest.fit-1220"><a href="#CoForest.fit-1220"><span class="linenos">1220</span></a>                    <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest.fit-1221"><a href="#CoForest.fit-1221"><span class="linenos">1221</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest.fit-1222"><a href="#CoForest.fit-1222"><span class="linenos">1222</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1223"><a href="#CoForest.fit-1223"><span class="linenos">1223</span></a>                        <span class="n">Ui_t</span> <span class="o">=</span> <span class="n">X_unlabel</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="CoForest.fit-1224"><a href="#CoForest.fit-1224"><span class="linenos">1224</span></a>
</span><span id="CoForest.fit-1225"><a href="#CoForest.fit-1225"><span class="linenos">1225</span></a>                    <span class="n">raw_predictions</span> <span class="o">=</span> <span class="n">hi</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Ui_t</span><span class="p">)</span>
</span><span id="CoForest.fit-1226"><a href="#CoForest.fit-1226"><span class="linenos">1226</span></a>                    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="CoForest.fit-1227"><a href="#CoForest.fit-1227"><span class="linenos">1227</span></a>                    <span class="n">class_predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="CoForest.fit-1228"><a href="#CoForest.fit-1228"><span class="linenos">1228</span></a>
</span><span id="CoForest.fit-1229"><a href="#CoForest.fit-1229"><span class="linenos">1229</span></a>                    <span class="n">to_label</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="CoForest.fit-1230"><a href="#CoForest.fit-1230"><span class="linenos">1230</span></a>                    <span class="n">wi_t</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">to_label</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="CoForest.fit-1231"><a href="#CoForest.fit-1231"><span class="linenos">1231</span></a>
</span><span id="CoForest.fit-1232"><a href="#CoForest.fit-1232"><span class="linenos">1232</span></a>                    <span class="k">if</span> <span class="n">ei_t</span> <span class="o">*</span> <span class="n">wi_t</span> <span class="o">&lt;</span> <span class="n">ei</span> <span class="o">*</span> <span class="n">wi</span><span class="p">:</span>
</span><span id="CoForest.fit-1233"><a href="#CoForest.fit-1233"><span class="linenos">1233</span></a>                        <span class="n">changing</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CoForest.fit-1234"><a href="#CoForest.fit-1234"><span class="linenos">1234</span></a>                        <span class="k">if</span> <span class="n">is_df</span><span class="p">:</span>
</span><span id="CoForest.fit-1235"><a href="#CoForest.fit-1235"><span class="linenos">1235</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">to_label</span><span class="p">,</span> <span class="p">:]])</span>
</span><span id="CoForest.fit-1236"><a href="#CoForest.fit-1236"><span class="linenos">1236</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="CoForest.fit-1237"><a href="#CoForest.fit-1237"><span class="linenos">1237</span></a>                            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X_label</span><span class="p">,</span> <span class="n">Ui_t</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest.fit-1238"><a href="#CoForest.fit-1238"><span class="linenos">1238</span></a>                        <span class="n">y_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_label</span><span class="p">,</span> <span class="n">class_predicted</span><span class="p">[</span><span class="n">to_label</span><span class="p">]))</span>
</span><span id="CoForest.fit-1239"><a href="#CoForest.fit-1239"><span class="linenos">1239</span></a>                        <span class="n">hi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CoForest.fit-1240"><a href="#CoForest.fit-1240"><span class="linenos">1240</span></a>                            <span class="n">x_temp</span><span class="p">,</span>
</span><span id="CoForest.fit-1241"><a href="#CoForest.fit-1241"><span class="linenos">1241</span></a>                            <span class="n">y_temp</span><span class="p">,</span>
</span><span id="CoForest.fit-1242"><a href="#CoForest.fit-1242"><span class="linenos">1242</span></a>                            <span class="o">**</span><span class="n">kwards</span>
</span><span id="CoForest.fit-1243"><a href="#CoForest.fit-1243"><span class="linenos">1243</span></a>                        <span class="p">)</span>
</span><span id="CoForest.fit-1244"><a href="#CoForest.fit-1244"><span class="linenos">1244</span></a>
</span><span id="CoForest.fit-1245"><a href="#CoForest.fit-1245"><span class="linenos">1245</span></a>                    <span class="n">errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ei_t</span>
</span><span id="CoForest.fit-1246"><a href="#CoForest.fit-1246"><span class="linenos">1246</span></a>                    <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_t</span>
</span><span id="CoForest.fit-1247"><a href="#CoForest.fit-1247"><span class="linenos">1247</span></a>
</span><span id="CoForest.fit-1248"><a href="#CoForest.fit-1248"><span class="linenos">1248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">h_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypotheses</span>
</span><span id="CoForest.fit-1249"><a href="#CoForest.fit-1249"><span class="linenos">1249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">columns_</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="CoForest.fit-1250"><a href="#CoForest.fit-1250"><span class="linenos">1250</span></a>
</span><span id="CoForest.fit-1251"><a href="#CoForest.fit-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Build a CoForest classifier from the training set (X, y).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> ({array-like, sparse matrix} of shape (n_samples, n_features)):
The training input samples.</li>
<li><strong>y</strong> (array-like of shape (n_samples,)):
The target values (class labels), -1 if unlabel.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>self</strong> (CoForest):
Fitted estimator.</li>
</ul>
</div>


                            </div>
                            <div id="CoForest.set_score_request" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_score_request</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#CoForest.set_score_request"></a>
    
            <div class="docstring"><p>A descriptor for request methods.</p>

<p><em>New in version 1.3.</em></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>name</strong> (str):
The name of the method for which the request function should be
created, e.g. <code>"fit"</code> would create a <code>set_fit_request</code> function.</li>
<li><strong>keys</strong> (list of str):
A list of strings which are accepted parameters by the created
function, e.g. <code>["sample_weight"]</code> if the corresponding method
accepts it as a metadata.</li>
<li><strong>validate_keys</strong> (bool, default=True):
Whether to check if the requested parameters fit the actual parameters
of the method.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This class is a descriptor <sup class="footnote-ref" id="fnref-1"><a href="#fn-1">1</a></sup> and uses PEP-362 to set the signature of
the returned function <sup class="footnote-ref" id="fnref-2"><a href="#fn-2">2</a></sup>.</p>

<h6 id="references">References</h6>

<div class="footnotes">
<hr />
<ol>
<li id="fn-1">
<p><a href="https://docs.python.org/3/howto/descriptor.html">https://docs.python.org/3/howto/descriptor.html</a>&#160;<a href="#fnref-1" class="footnoteBackLink" title="Jump back to footnote 1 in the text.">&#8617;</a></p>
</li>

<li id="fn-2">
<p><a href="https://www.python.org/dev/peps/pep-0362/">https://www.python.org/dev/peps/pep-0362/</a>&#160;<a href="#fnref-2" class="footnoteBackLink" title="Jump back to footnote 2 in the text.">&#8617;</a></p>
</li>
</ol>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sslearn.wrapper._co.BaseCoTraining</dt>
                                <dd id="CoForest.predict_proba" class="function">predict_proba</dd>

            </div>
            <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="CoForest.get_params" class="function">get_params</dd>
                <dd id="CoForest.set_params" class="function">set_params</dd>

            </div>
            <div><dt>sklearn.utils._metadata_requests._MetadataRequester</dt>
                                <dd id="CoForest.get_metadata_routing" class="function">get_metadata_routing</dd>

            </div>
            <div><dt>sklearn.base.ClassifierMixin</dt>
                                <dd id="CoForest.score" class="function">score</dd>

            </div>
            <div><dt><a href="base.html#BaseEnsemble">sslearn.base.BaseEnsemble</a></dt>
                                <dd id="CoForest.predict" class="function"><a href="base.html#BaseEnsemble.predict">predict</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>